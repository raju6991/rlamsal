(()=>{var a={};a.id=796,a.ids=[796],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},796:(a,b,c)=>{"use strict";a.exports=c(6668).vendored["react-rsc"].ReactJsxRuntime},846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1455:a=>{"use strict";a.exports=require("node:fs/promises")},1722:(a,b,c)=>{"use strict";a.exports=c(4870)},3033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:a=>{"use strict";a.exports=require("path")},4363:(a,b,c)=>{"use strict";c.d(b,{A:()=>f});var d=c(796),e=c(3730);c(7877);let f=(0,e.$W)({storage:{kind:"local"},ui:{brand:{name:"Portfolio CMS"}},collections:{posts:(0,e.rJ)({label:"Posts",slugField:"slug",path:"content/posts/*",format:{contentField:"content"},entryLayout:"content",columns:["title","publishedDate"],previewUrl:"/writing/{slug}",schema:{title:e.OA.text({label:"Title"}),slug:e.OA.text({label:"Slug",description:"The URL slug for this post",validation:{length:{min:1}}}),coverImage:e.OA.image({label:"Cover Image",directory:"public/images/posts",publicPath:"/images/posts",validation:{isRequired:!1}}),excerpt:e.OA.text({label:"Excerpt",multiline:!0}),publishedDate:e.OA.date({label:"Published Date",validation:{isRequired:!0}}),tags:e.OA.array(e.OA.text({label:"Tag"}),{label:"Tags",itemLabel:a=>a.value}),content:e.OA.document({label:"Content",formatting:!0,dividers:!0,links:!0,images:{directory:"public/images/posts",publicPath:"/images/posts"},componentBlocks:{image:(0,e.s9)({label:"Image",preview:a=>(0,d.jsxs)("div",{style:{margin:"1rem 0"},children:[(0,d.jsx)("img",{src:a.fields.src.value,alt:a.fields.alt.value,style:{width:"100%",borderRadius:"4px"}}),(0,d.jsx)("p",{style:{textAlign:"center",fontSize:"12px"},children:a.fields.title.value})]}),schema:{src:e.OA.text({label:"Source URL"}),alt:e.OA.text({label:"Alt text"}),title:e.OA.text({label:"Title (optional)"})}}),playground:(0,e.s9)({label:"Playground Illustration",preview:()=>(0,d.jsx)("div",{style:{padding:"1rem",background:"#ccc",borderRadius:"4px"},children:"Playground Preview"}),schema:{type:e.OA.select({label:"Type",options:[{label:"Flexbox",value:"flex"},{label:"Grid",value:"grid"},{label:"Animation",value:"animation"}],defaultValue:"flex"})}}),sandbox:(0,e.s9)({label:"Sandbox Editor",preview:()=>(0,d.jsx)("div",{style:{padding:"1rem",background:"#333",color:"#fff",borderRadius:"4px"},children:"Sandbox Code Editor"}),schema:{initialCode:e.OA.text({label:"Initial Code",multiline:!0}),language:e.OA.text({label:"Language",defaultValue:"css"})}}),illustration:(0,e.s9)({label:"Interactive Illustration",preview:()=>(0,d.jsx)("div",{style:{padding:"1rem",background:"#e0e0e0",borderRadius:"4px"},children:"Playground + Sandbox"}),schema:{initialCode:e.OA.text({label:"Initial Code",multiline:!0}),type:e.OA.select({label:"Type",options:[{label:"Flexbox",value:"flex"},{label:"Grid",value:"grid"},{label:"Animation",value:"animation"},{label:"Gradient",value:"gradient"}],defaultValue:"flex"})}})}})}}),projects:(0,e.rJ)({label:"Projects",slugField:"slug",path:"content/projects/*/",format:{contentField:"content"},entryLayout:"content",columns:["title","featured"],previewUrl:"/work",schema:{title:e.OA.text({label:"Title",validation:{length:{min:1}}}),slug:e.OA.text({label:"Slug",description:"The URL slug for this project",validation:{length:{min:1}}}),description:e.OA.text({label:"Description",multiline:!0}),technologies:e.OA.array(e.OA.text({label:"Technology"}),{label:"Technologies",itemLabel:a=>a.value}),demoUrl:e.OA.text({label:"Demo URL"}),githubUrl:e.OA.text({label:"GitHub URL"}),featured:e.OA.checkbox({label:"Featured"}),content:e.OA.document({label:"Content",formatting:!0,dividers:!0,links:!0})}})}})},4760:(a,b)=>{"use strict";let c;b.qg=function(a,b){let c=new i,d=a.length;if(d<2)return c;let e=b?.decode||l,f=0;do{let b=function(a,b,c){let d=a.indexOf("=",b);return d<c?d:-1}(a,f,d);if(-1===b)break;let g=function(a,b,c){let d=a.indexOf(";",b);return -1===d?c:d}(a,f,d);if(b>g){f=a.lastIndexOf(";",b-1)+1;continue}let h=k(a,f,b);void 0===c[h]&&(c[h]=e(k(a,b+1,g))),f=g+1}while(f<d);return c},b.lK=j,b.lK=j;let d=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,f=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,g=/^[\u0020-\u003A\u003D-\u007E]*$/,h=Object.prototype.toString,i=((c=function(){}).prototype=Object.create(null),c);function j(a,b,c){let i="object"==typeof a?a:{...c,name:a,value:String(b)},j=("object"==typeof b?b:c)?.encode||encodeURIComponent;if(!d.test(i.name))throw TypeError(`argument name is invalid: ${i.name}`);let k=i.value?j(i.value):"";if(!e.test(k))throw TypeError(`argument val is invalid: ${i.value}`);let l=i.name+"="+k;if(void 0!==i.maxAge){if(!Number.isInteger(i.maxAge))throw TypeError(`option maxAge is invalid: ${i.maxAge}`);l+="; Max-Age="+i.maxAge}if(i.domain){if(!f.test(i.domain))throw TypeError(`option domain is invalid: ${i.domain}`);l+="; Domain="+i.domain}if(i.path){if(!g.test(i.path))throw TypeError(`option path is invalid: ${i.path}`);l+="; Path="+i.path}if(i.expires){var m;if(m=i.expires,"[object Date]"!==h.call(m)||!Number.isFinite(i.expires.valueOf()))throw TypeError(`option expires is invalid: ${i.expires}`);l+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(l+="; HttpOnly"),i.secure&&(l+="; Secure"),i.partitioned&&(l+="; Partitioned"),i.priority)switch("string"==typeof i.priority?i.priority.toLowerCase():void 0){case"low":l+="; Priority=Low";break;case"medium":l+="; Priority=Medium";break;case"high":l+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${i.priority}`)}if(i.sameSite)switch("string"==typeof i.sameSite?i.sameSite.toLowerCase():i.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${i.sameSite}`)}return l}function k(a,b,c){let d=b,e=c;do{let b=a.charCodeAt(d);if(32!==b&&9!==b)break}while(++d<e);for(;e>d;){let b=a.charCodeAt(e-1);if(32!==b&&9!==b)break;e--}return a.slice(d,e)}function l(a){if(-1===a.indexOf("%"))return a;try{return decodeURIComponent(a)}catch(b){return a}}},4870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5511:a=>{"use strict";a.exports=require("crypto")},5579:a=>{function b(a){return Array.isArray(a)?a:[a]}let c=/^\s+$/,d=/(?:[^\\]|^)\\$/,e=/^\\!/,f=/^\\#/,g=/\r?\n/g,h=/^\.*\/|^\.+$/,i="node-ignore";"u">typeof Symbol&&(i=Symbol.for("node-ignore"));let j=i,k=/([0-z])-([0-z])/g,l=()=>!1,m=[[/^\uFEFF/,()=>""],[/((?:\\\\)*?)(\\?\s+)$/,(a,b,c)=>b+(0===c.indexOf("\\")?" ":"")],[/(\\+?)\s/g,(a,b)=>{let{length:c}=b;return b.slice(0,c-c%2)+" "}],[/[\\$.|*+(){^]/g,a=>`\\${a}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(a,b,c)=>b+6<c.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(a,b,c)=>b+c.replace(/\\\*/g,"[^\\/]*")],[/\\\\\\(?=[$.|*+(){^])/g,()=>"\\"],[/\\\\/g,()=>"\\"],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(a,b,c,d,e)=>"\\"===b?`\\[${c}${(a=>{let{length:b}=a;return a.slice(0,b-b%2)})(d)}${e}`:"]"===e&&d.length%2==0?`[${c.replace(k,(a,b,c)=>b.charCodeAt(0)<=c.charCodeAt(0)?a:"")}${d}]`:"[]"],[/(?:[^*])$/,a=>/\/$/.test(a)?`${a}$`:`${a}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(a,b)=>{let c=b?`${b}[^/]+`:"[^/]*";return`${c}(?=$|\\/$)`}]],n=Object.create(null);class o{constructor(a,b,c,d){this.origin=a,this.pattern=b,this.negative=c,this.regex=d}}let p=(a,b)=>{throw new b(a)},q=(a,b,c)=>"string"!=typeof a?c(`path must be a string, but got \`${b}\``,TypeError):a?!q.isNotRelative(a)||c(`path should be a \`path.relative()\`d string, but got "${b}"`,RangeError):c("path must not be empty",TypeError),r=a=>h.test(a);q.isNotRelative=r,q.convert=a=>a;class s{constructor({ignorecase:a=!0,ignoreCase:b=a,allowRelativePaths:c=!1}={}){((a,b,c)=>Object.defineProperty(a,b,{value:c}))(this,j,!0),this._rules=[],this._ignoreCase=b,this._allowRelativePaths=c,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(a){let b;if(a&&a[j]){this._rules=this._rules.concat(a._rules),this._added=!0;return}if((b=a)&&"string"==typeof b&&!c.test(b)&&!d.test(b)&&0!==b.indexOf("#")){var g,h,i;let b,c,d,j=(g=a,h=this._ignoreCase,b=g,c=!1,0===g.indexOf("!")&&(c=!0,g=g.substr(1)),i=g=g.replace(e,"!").replace(f,"#"),(d=n[i])||(d=m.reduce((a,[b,c])=>a.replace(b,c.bind(i)),i),n[i]=d),new o(b,g,c,h?RegExp(d,"i"):new RegExp(d)));this._added=!0,this._rules.push(j)}}add(a){return this._added=!1,b("string"==typeof a?a.split(g):a).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(a){return this.add(a)}_testOne(a,b){let c=!1,d=!1;return this._rules.forEach(e=>{let{negative:f}=e;(d!==f||c===d)&&(!f||c||d||b)&&e.regex.test(a)&&(c=!f,d=f)}),{ignored:c,unignored:d}}_test(a,b,c,d){let e=a&&q.convert(a);return q(e,a,this._allowRelativePaths?l:p),this._t(e,b,c,d)}_t(a,b,c,d){if(a in b)return b[a];if(d||(d=a.split("/")),d.pop(),!d.length)return b[a]=this._testOne(a,c);let e=this._t(d.join("/")+"/",b,c,d);return b[a]=e.ignored?e:this._testOne(a,c)}ignores(a){return this._test(a,this._ignoreCache,!1).ignored}createFilter(){return a=>!this.ignores(a)}filter(a){return b(a).filter(this.createFilter())}test(a){return this._test(a,this._testCache,!0)}}let t=a=>new s(a);if(t.isPathValid=a=>q(a&&q.convert(a),a,l),t.default=t,a.exports=t,"u">typeof process&&(process.env&&process.env.IGNORE_TEST_WIN32||"win32"===process.platform)){q.convert=a=>/^\\\\\?\\/.test(a)||/["<>|\u0000-\u001F]+/u.test(a)?a:a.replace(/\\/g,"/");let a=/^[a-z]:\//i;q.isNotRelative=b=>a.test(b)||r(b)}},6439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},6469:(a,b,c)=>{"use strict";let d,e;c.r(b),c.d(b,{handler:()=>aD,patchFetch:()=>aC,routeModule:()=>ay,serverHooks:()=>aB,workAsyncStorage:()=>az,workUnitAsyncStorage:()=>aA});var f,g,h,i,j,k={};c.r(k),c.d(k,{GET:()=>aw,POST:()=>ax});var l=c(1722),m=c(2931),n=c(402),o=c(6132),p=c(4202),q=c(2150),r=c(261),s=c(9756),t=c(8534),u=c(2462),v=c(5565),w=c(8523),x=c(5073),y=c(9111),z=c(3648),A=c(6439),B=c(9998),C=c(4760);class D extends TypeError{constructor(a,b){let c;const{message:d,explanation:e,...f}=a,{path:g}=a,h=0===g.length?d:`At path: ${g.join(".")} -- ${d}`;super(e??h),null!=e&&(this.cause=h),Object.assign(this,f),this.name=this.constructor.name,this.failures=()=>c??(c=[a,...b()])}}function E(a){return"object"==typeof a&&null!=a}function F(a){return"symbol"==typeof a?a.toString():"string"==typeof a?JSON.stringify(a):`${a}`}function*G(a,b,c,d){var e;for(let f of(E(e=a)&&"function"==typeof e[Symbol.iterator]||(a=[a]),a)){let a=function(a,b,c,d){if(!0===a)return;!1===a?a={}:"string"==typeof a&&(a={message:a});let{path:e,branch:f}=b,{type:g}=c,{refinement:h,message:i=`Expected a value of type \`${g}\`${h?` with refinement \`${h}\``:""}, but received: \`${F(d)}\``}=a;return{value:d,type:g,refinement:h,key:e[e.length-1],path:e,branch:f,...a,message:i}}(f,b,c,d);a&&(yield a)}}class H{constructor(a){const{type:b,schema:c,validator:d,refiner:e,coercer:f=a=>a,entries:g=function*(){}}=a;this.type=b,this.schema=c,this.entries=g,this.coercer=f,d?this.validator=(a,b)=>G(d(a,b),b,this,a):this.validator=()=>[],e?this.refiner=(a,b)=>G(e(a,b),b,this,a):this.refiner=()=>[]}assert(a,b){var c=a,d=this,e=b;let f=J(c,d,{message:e});if(f[0])throw f[0]}create(a,b){return I(a,this,b)}is(a){var b,c;return b=a,c=this,!J(b,c)[0]}mask(a,b){var c=a,d=this,e=b;let f=J(c,d,{coerce:!0,mask:!0,message:e});if(!f[0])return f[1];throw f[0]}validate(a,b={}){return J(a,this,b)}}function I(a,b,c){let d=J(a,b,{coerce:!0,message:c});if(!d[0])return d[1];throw d[0]}function J(a,b,c={}){let d=function* a(b,c,d={}){let{path:e=[],branch:f=[b],coerce:g=!1,mask:h=!1}=d,i={path:e,branch:f};if(g&&(b=c.coercer(b,i),h&&"type"!==c.type&&E(c.schema)&&E(b)&&!Array.isArray(b)))for(let a in b)void 0===c.schema[a]&&delete b[a];let j="valid";for(let a of c.validator(b,i))a.explanation=d.message,j="not_valid",yield[a,void 0];for(let[k,l,m]of c.entries(b,i))for(let c of a(l,m,{path:void 0===k?e:[...e,k],branch:void 0===k?f:[...f,l],coerce:g,mask:h,message:d.message}))c[0]?(j=null!=c[0].refinement?"not_refined":"not_valid",yield[c[0],void 0]):g&&(l=c[1],void 0===k?b=l:b instanceof Map?b.set(k,l):b instanceof Set?b.add(l):E(b)&&(void 0!==l||k in b)&&(b[k]=l));if("not_valid"!==j)for(let a of c.refiner(b,i))a.explanation=d.message,j="not_refined",yield[a,void 0];"valid"===j&&(yield[void 0,b])}(a,b,c),e=function(a){let{done:b,value:c}=a.next();return b?void 0:c}(d);return e[0]?[new D(e[0],function*(){for(let a of d)a[0]&&(yield a[0])}),void 0]:[void 0,e[1]]}function K(a,b){return new H({type:a,schema:null,validator:b})}function L(a){return new H({type:"array",schema:a,*entries(b){if(a&&Array.isArray(b))for(let[c,d]of b.entries())yield[c,d,a]},coercer:a=>Array.isArray(a)?a.slice():a,validator:a=>Array.isArray(a)||`Expected an array value, but received: ${F(a)}`})}function M(){return K("number",a=>"number"==typeof a&&!isNaN(a)||`Expected a number, but received: ${F(a)}`)}function N(a){let b=a?Object.keys(a):[],c=K("never",()=>!1);return new H({type:"object",schema:a||null,*entries(d){if(a&&E(d)){let e=new Set(Object.keys(d));for(let c of b)e.delete(c),yield[c,d[c],a[c]];for(let a of e)yield[a,d[a],c]}},validator:a=>E(a)||`Expected an object, but received: ${F(a)}`,coercer:a=>E(a)?{...a}:a})}function O(){return K("string",a=>"string"==typeof a||`Expected a string, but received: ${F(a)}`)}function P(a){let b=Object.keys(a);return new H({type:"type",schema:a,*entries(c){if(E(c))for(let d of b)yield[d,c[d],a[d]]},validator:a=>E(a)||`Expected an object, but received: ${F(a)}`,coercer:a=>E(a)?{...a}:a})}var Q=c(6760),R=c(1455);let S=require("fs/promises");var T=c(3873),U=c(4019);c(796),c(4094),c(4970);var V=c(5579);async function W(a){let b;try{b=await S.readdir(a,{withFileTypes:!0})}catch(a){if("ENOENT"===a.code)return[];throw a}return b}async function X(a,b){let c=b.map(a=>a.segment).join("/"),d=await W(T.join(a,c)),e=d.find(a=>a.isFile()&&".gitignore"===a.name),f=e?V().add(await S.readFile(T.join(a,c,e.name),"utf8")).createFilter():()=>!0,g=b.map(a=>a.segment);return(await Promise.all(d.filter(a=>{if(!a.isDirectory()&&!a.isFile()||".git"===a.name||"node_modules"===a.name||".next"===a.name||!f(`${g.concat(a.name).join("/")}${a.isDirectory()?"/":""}`))return!1;let c=a.name;for(let a=b.length-1;a>=0;a--){let d=b[a];if(c=`${d.segment}/${c}`,!d.gitignoreFilterForDescendents(c))return!1}return!0}).map(async c=>{if(c.isDirectory())return X(a,[...b,{gitignoreFilterForDescendents:f,segment:c.name}]);{let b=g.concat(c.name).join("/"),d=await S.readFile(T.join(a,b));return{path:b,contents:{byteLength:d.byteLength,sha:await (0,U.i)(d)}}}}))).flat()}async function Y(a){let b=await X(a,[]),{entries:c}=await (0,U.u)(new Map,{additions:b,deletions:[]});return c}let Z=require("node:crypto");function $(a,b){return{body:null,status:307,headers:[...null!=b?b:[],["Location",a]]}}function _(a){let b=atob(a.replace(/-/g,"+").replace(/_/g,"/"));return Uint8Array.from(b,a=>a.codePointAt(0))}async function aa(a,b,c){return"1"!==a.headers.get("no-cors")?{status:400,body:"Bad Request"}:{status:200,headers:{"content-type":"application/json"},body:JSON.stringify(await Y(c))}}function ab(a){let b=function(a){var b,c;let d=[];for(let[c,e]of Object.entries(null!=(b=a.collections)?b:{}))d.push(...(0,U.b)((0,U.o)(e.schema),(0,U.c)(a,c),void 0,{data:"yaml",contentField:void 0,dataLocation:"index"})),e.template&&d.push(e.template);for(let[b,e]of Object.entries(null!=(c=a.singletons)?c:{}))d.push(...(0,U.b)((0,U.o)(e.schema),(0,U.h)(a,b),void 0,(0,U.e)(a,b)));return[...new Set(d)]}(a);return a=>!a.includes("\\")&&a.split("/").every(a=>"."!==a&&".."!==a)&&b.some(b=>a.startsWith(b))}async function ac(a,b,c,d){let e;if("1"!==a.headers.get("no-cors"))return{status:400,body:"Bad Request"};let f=c[1],g=c.slice(2).join("/");if(!ab(b)(g))return{status:400,body:"Bad Request"};try{e=await R.readFile(Q.join(d,g))}catch(a){if("ENOENT"===a.code)return{status:404,body:"Not Found"};throw a}return await (0,U.i)(e)!==f?{status:404,body:"Not Found"}:{status:200,body:e}}c(1446),c(5511),P({slug:O(),client_id:O(),client_secret:O()});let ad=(f=Uint8Array,g=K("instance",a=>a instanceof f||`Expected a \`${f.name}\` instance, but received: ${F(a)}`),h=O(),i=a=>_(a),new H({...g,coercer:(a,b)=>J(a,h)[0]?g.coercer(a,b):g.coercer(i(a,b),b)}));async function ae(a,b,c){var d;let e;if("1"!==a.headers.get("no-cors")||"application/json"!==a.headers.get("content-type"))return{status:400,body:"Bad Request"};let f=ab(b),g=(d=O(),new H({...d,*refiner(a,b){for(let c of(yield*d.refiner(a,b),G(f(a,b),b,d,a)))yield{...c,refinement:"filepath"}}}));try{e=I(await a.json(),N({additions:L(N({path:g,contents:ad})),deletions:L(N({path:g}))}))}catch{return{status:400,body:"Bad data"}}for(let a of e.additions)await R.mkdir(Q.dirname(Q.join(c,a.path)),{recursive:!0}),await R.writeFile(Q.join(c,a.path),a.contents);for(let a of e.deletions)await R.rm(Q.join(c,a.path),{force:!0});return{status:200,headers:{"content-type":"application/json"},body:JSON.stringify(await Y(c))}}let af=new TextEncoder,ag=new TextDecoder;async function ah(a,b){if(a.length<32)throw Error("KEYSTATIC_SECRET must be at least 32 characters long");let c=af.encode(a),d=await Z.webcrypto.subtle.importKey("raw",c,"HKDF",!1,["deriveKey"]);return Z.webcrypto.subtle.deriveKey({name:"HKDF",salt:b,hash:"SHA-256",info:new Uint8Array(0)},d,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function ai(a,b){let c=Z.webcrypto.getRandomValues(new Uint8Array(16)),d=Z.webcrypto.getRandomValues(new Uint8Array(12)),e=await ah(b,c),f=af.encode(a),g=await Z.webcrypto.subtle.encrypt({name:"AES-GCM",iv:d},e,f),h=new Uint8Array(28+g.byteLength);return h.set(c),h.set(d,16),h.set(new Uint8Array(g),28),btoa(Array.from(h,a=>String.fromCodePoint(a)).join("")).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}async function aj(a,b){let c=_(a),d=c.slice(0,16),e=await ah(b,d),f=c.slice(16,28),g=c.slice(28),h=await Z.webcrypto.subtle.decrypt({name:"AES-GCM",iv:f},e,g);return ag.decode(h)}let ak=/^branch\/[^]+(\/collection\/[^/]+(|\/(create|item\/[^/]+))|\/singleton\/[^/]+)?$/,al={clientId:"KEYSTATIC_GITHUB_CLIENT_ID",clientSecret:"KEYSTATIC_GITHUB_CLIENT_SECRET",secret:"KEYSTATIC_SECRET"};function am(a){try{return a()}catch{return}}let an=P({access_token:O(),expires_in:M(),refresh_token:O(),refresh_token_expires_in:M(),scope:O(),token_type:(d=F(j="bearer"),new H({type:"literal",schema:"string"==(e=typeof j)||"number"===e||"boolean"===e?j:null,validator:a=>a===j||`Expected the literal \`${d}\`, but received: ${F(a)}`}))});async function ao(a,b){var c;let d,e=new URL(a.url,"http://localhost").searchParams,f=e.get("error"),g=e.get("error_description");if("string"==typeof g)return{status:400,body:`An error occurred when trying to authenticate with GitHub:
${g}${"redirect_uri_mismatch"===f?"\n\nIf you were trying to sign in locally and recently upgraded Keystatic from @keystatic/core@0.0.69 or below, you need to add `http://127.0.0.1/api/keystatic/github/oauth/callback` as a callback URL in your GitHub app.":""}`};let h=e.get("code"),i=e.get("state");if("string"!=typeof h)return{status:400,body:"Bad Request"};let j=C.qg(null!=(c=a.headers.get("cookie"))?c:""),k=i?j["ks-"+i]:void 0,l="string"==typeof k&&ak.test(k)?k:void 0,m=new URL("https://github.com/login/oauth/access_token");m.searchParams.set("client_id",b.clientId),m.searchParams.set("client_secret",b.clientSecret),m.searchParams.set("code",h);let n=await fetch(m,{method:"POST",headers:{Accept:"application/json"}});if(!n.ok)return{status:401,body:"Authorization failed"};let o=await n.json();try{d=an.create(o)}catch{return{status:401,body:"Authorization failed"}}let p=await ap(d,b);return"close"===i?{headers:[...p,["Content-Type","text/html"]],body:"<script>localStorage.setItem('ks-refetch-installations', 'true');window.close();<\/script>",status:200}:$(`/keystatic${l?`/${l}`:""}`,p)}async function ap(a,b){return[["Set-Cookie",C.lK("keystatic-gh-access-token",a.access_token,{sameSite:"lax",secure:!0,maxAge:a.expires_in,expires:new Date(Date.now()+1e3*a.expires_in),path:"/"})],["Set-Cookie",C.lK("keystatic-gh-refresh-token",await ai(a.refresh_token,b.secret),{sameSite:"lax",secure:!0,httpOnly:!0,maxAge:a.refresh_token_expires_in,expires:new Date(Date.now()+100*a.refresh_token_expires_in),path:"/"})]]}async function aq(a,b){let c,d=C.qg(a.headers.get("cookie")||"")["keystatic-gh-refresh-token"];if(d){try{c=await aj(d,b.secret)}catch{return}return c}}async function ar(a,b){let c=await as(a,b);return c?{status:200,headers:c,body:""}:{status:401,body:"Authorization failed"}}async function as(a,b){let c,d=await aq(a,b);if(!d)return;let e=new URL("https://github.com/login/oauth/access_token");e.searchParams.set("client_id",b.clientId),e.searchParams.set("client_secret",b.clientSecret),e.searchParams.set("grant_type","refresh_token"),e.searchParams.set("refresh_token",d);let f=await fetch(e,{method:"POST",headers:{Accept:"application/json"}});if(!f.ok)return;let g=await f.json();try{c=an.create(g)}catch{return}return ap(c,b)}async function at(a,b){let c=await as(a,b);return c?$("/keystatic/repo-not-found",c):au(a,b)}async function au(a,b){let c=new URL(a.url),d=c.searchParams.get("from"),e="string"==typeof d&&ak.test(d)?d:"/",f=function(a){let b="";for(let c of a)b+=c.toString(16).padStart(2,"0");return b}(Z.webcrypto.getRandomValues(new Uint8Array(10))),g=new URL("https://github.com/login/oauth/authorize");return(g.searchParams.set("client_id",b.clientId),g.searchParams.set("redirect_uri",`${c.origin}/api/keystatic/github/oauth/callback`),"/"===e)?$(g.toString()):(g.searchParams.set("state",f),$(g.toString(),[["Set-Cookie",C.lK("ks-"+f,e,{sameSite:"lax",secure:!0,maxAge:86400,expires:new Date(Date.now()+864e5),path:"/",httpOnly:!0})]]))}function av(a){return C.lK(a,"",{secure:!0,sameSite:"lax",path:"/",maxAge:0,expires:new Date})}let{GET:aw,POST:ax}=function(a){let b=function(a,b){var c,d,e,f,g;let h={clientId:null!=(c=a.clientId)?c:am(()=>process.env.KEYSTATIC_GITHUB_CLIENT_ID),clientSecret:null!=(d=a.clientSecret)?d:am(()=>process.env.KEYSTATIC_GITHUB_CLIENT_SECRET),secret:null!=(e=a.secret)?e:am(()=>process.env.KEYSTATIC_SECRET),config:a.config},i=a=>{let c;try{c=new URL(a.url)}catch(a){throw Error(`Found incomplete URL in Keystatic API route URL handler${(null==b?void 0:b.slugEnvName)==="NEXT_PUBLIC_KEYSTATIC_GITHUB_APP_SLUG"?". Make sure you're using the latest version of @keystatic/next":""}`)}return c.pathname.replace(/^\/api\/keystatic\/?/,"").split("/").map(a=>decodeURIComponent(a)).filter(Boolean)};if("local"===h.config.storage.kind){let b,c=(f=h.config,g=a.localBaseDirectory,b=Q.resolve(null!=g?g:process.cwd()),async(a,c)=>{let d=c.join("/");return"GET"===a.method&&"tree"===d?aa(a,f,b):"GET"===a.method&&"blob"===c[0]?ac(a,f,c,b):"POST"===a.method&&"update"===d?ae(a,f,b):{status:404,body:"Not Found"}});return a=>{let b=i(a);return c(a,b)}}if("cloud"===h.config.storage.kind)return async function(){return{status:404,body:"Not Found"}};if(!h.clientId||!h.clientSecret||!h.secret){let a=["clientId","clientSecret","secret"].filter(a=>!h[a]);throw Error(`Missing required config in Keystatic API setup when using the 'github' storage mode:
${a.map(a=>`- ${a} (can be provided via ${al[a]} env var)`).join("\n")}

If you've created your GitHub app locally, make sure to copy the environment variables from your local env file to your deployed environment`)}let j={clientId:h.clientId,clientSecret:h.clientSecret,secret:h.secret,config:h.config};return async function(a){let b=i(a).join("/");if("github/oauth/callback"===b)return ao(a,j);if("github/login"===b)return au(a,j);if("github/refresh-token"===b)return ar(a,j);if("github/repo-not-found"===b)return at(a,j);if("github/logout"===b){var c;let b=C.qg(null!=(c=a.headers.get("cookie"))?c:"")["keystatic-gh-access-token"];return b&&await fetch(`https://api.github.com/applications/${j.clientId}/token`,{method:"DELETE",headers:{Authorization:`Basic ${btoa(j.clientId+":"+j.clientSecret)}`},body:JSON.stringify({access_token:b})}),$("/keystatic",[["Set-Cookie",av("keystatic-gh-access-token")],["Set-Cookie",av("keystatic-gh-refresh-token")]])}return"github/created-app"===b?{status:404,body:"It looks like you just tried to create a GitHub App for Keystatic but there is already a GitHub App configured for Keystatic.\n\nYou may be here because you started creating a GitHub App but then started the process again elsewhere and completed it there. You should likely go back to Keystatic and sign in with GitHub to continue."}:{status:404,body:"Not Found"}}}(a,{slugEnvName:"NEXT_PUBLIC_KEYSTATIC_GITHUB_APP_SLUG"});async function c(a){let c=new URL(a.url);"localhost"===c.hostname&&(c.hostname="127.0.0.1",a=new Request(c.toString(),a));let{body:d,headers:e,status:f}=await b(a);return new Response(d,{status:f,headers:e})}return{GET:c,POST:c}}({config:c(4363).A}),ay=new l.AppRouteRouteModule({definition:{kind:m.RouteKind.APP_ROUTE,page:"/api/keystatic/[[...params]]/route",pathname:"/api/keystatic/[[...params]]",filename:"route",bundlePath:"app/api/keystatic/[[...params]]/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/Users/rajulamsal/projects/rlamsal/app/api/keystatic/[[...params]]/route.ts",nextConfigOutput:"standalone",userland:k}),{workAsyncStorage:az,workUnitAsyncStorage:aA,serverHooks:aB}=ay;function aC(){return(0,n.patchFetch)({workAsyncStorage:az,workUnitAsyncStorage:aA})}async function aD(a,b,c){ay.isDev&&(0,o.addRequestMeta)(a,"devRequestTimingInternalsEnd",process.hrtime.bigint());let d="/api/keystatic/[[...params]]/route";"/index"===d&&(d="/");let e=await ay.prepare(a,b,{srcPage:d,multiZoneDraftMode:!1});if(!e)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:f,params:g,nextConfig:h,parsedUrl:i,isDraftMode:j,prerenderManifest:k,routerServerContext:l,isOnDemandRevalidate:n,revalidateOnlyGenerated:C,resolvedPathname:D,clientReferenceManifest:E,serverActionsManifest:F}=e,G=(0,r.normalizeAppPath)(d),H=!!(k.dynamicRoutes[G]||k.routes[D]),I=async()=>((null==l?void 0:l.render404)?await l.render404(a,b,i,!1):b.end("This page could not be found"),null);if(H&&!j){let a=!!k.routes[D],b=k.dynamicRoutes[G];if(b&&!1===b.fallback&&!a){if(h.experimental.adapterPath)return await I();throw new A.NoFallbackError}}let J=null;!H||ay.isDev||j||(J="/index"===(J=D)?"/":J);let K=!0===ay.isDev||!H,L=H&&!K;F&&E&&(0,q.setManifestsSingleton)({page:d,clientReferenceManifest:E,serverActionsManifest:F});let M=a.method||"GET",N=(0,p.getTracer)(),O=N.getActiveScopeSpan(),P={params:g,prerenderManifest:k,renderOpts:{experimental:{authInterrupts:!!h.experimental.authInterrupts},cacheComponents:!!h.cacheComponents,supportsDynamicResponse:K,incrementalCache:(0,o.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:h.cacheLife,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d,e)=>ay.onRequestError(a,b,d,e,l)},sharedContext:{buildId:f}},Q=new s.NodeNextRequest(a),R=new s.NodeNextResponse(b),S=t.NextRequestAdapter.fromNodeNextRequest(Q,(0,t.signalFromNodeResponse)(b));try{let e=async a=>ay.handle(S,P).finally(()=>{if(!a)return;a.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let c=N.getRootSpanAttributes();if(!c)return;if(c.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${c.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=c.get("next.route");if(e){let b=`${M} ${e}`;a.setAttributes({"next.route":e,"http.route":e,"next.span_name":b}),a.updateName(b)}else a.updateName(`${M} ${d}`)}),f=!!(0,o.getRequestMeta)(a,"minimalMode"),g=async g=>{var i,o;let p=async({previousCacheEntry:h})=>{try{if(!f&&n&&C&&!h)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let d=await e(g);a.fetchMetrics=P.renderOpts.fetchMetrics;let i=P.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=P.renderOpts.collectedTags;if(!H)return await (0,w.I)(Q,R,d,P.renderOpts.pendingWaitUntil),null;{let a=await d.blob(),b=(0,x.toNodeOutgoingHttpHeaders)(d.headers);j&&(b[z.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==P.renderOpts.collectedRevalidate&&!(P.renderOpts.collectedRevalidate>=z.INFINITE_CACHE)&&P.renderOpts.collectedRevalidate,e=void 0===P.renderOpts.collectedExpire||P.renderOpts.collectedExpire>=z.INFINITE_CACHE?void 0:P.renderOpts.collectedExpire;return{value:{kind:B.CachedRouteKind.APP_ROUTE,status:d.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:e}}}}catch(b){throw(null==h?void 0:h.isStale)&&await ay.onRequestError(a,b,{routerKind:"App Router",routePath:d,routeType:"route",revalidateReason:(0,v.c)({isStaticGeneration:L,isOnDemandRevalidate:n})},!1,l),b}},q=await ay.handleResponse({req:a,nextConfig:h,cacheKey:J,routeKind:m.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:k,isRoutePPREnabled:!1,isOnDemandRevalidate:n,revalidateOnlyGenerated:C,responseGenerator:p,waitUntil:c.waitUntil,isMinimalMode:f});if(!H)return null;if((null==q||null==(i=q.value)?void 0:i.kind)!==B.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==q||null==(o=q.value)?void 0:o.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});f||b.setHeader("x-nextjs-cache",n?"REVALIDATED":q.isMiss?"MISS":q.isStale?"STALE":"HIT"),j&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let r=(0,x.fromNodeOutgoingHttpHeaders)(q.value.headers);return f&&H||r.delete(z.NEXT_CACHE_TAGS_HEADER),!q.cacheControl||b.getHeader("Cache-Control")||r.get("Cache-Control")||r.set("Cache-Control",(0,y.getCacheControlHeader)(q.cacheControl)),await (0,w.I)(Q,R,new Response(q.value.body,{headers:r,status:q.value.status||200})),null};O?await g(O):await N.withPropagatedContext(a.headers,()=>N.trace(u.BaseServerSpan.handleRequest,{spanName:`${M} ${d}`,kind:p.SpanKind.SERVER,attributes:{"http.method":M,"http.target":a.url}},g))}catch(b){if(b instanceof A.NoFallbackError||await ay.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"route",revalidateReason:(0,v.c)({isStaticGeneration:L,isOnDemandRevalidate:n})},!1,l),H)throw b;return await (0,w.I)(Q,R,new Response(null,{status:500})),null}}},6487:()=>{},6760:a=>{"use strict";a.exports=require("node:path")},8335:()=>{},8523:(a,b,c)=>{"use strict";Object.defineProperty(b,"I",{enumerable:!0,get:function(){return g}});let d=c(6675),e=c(1698),f=c(5073);async function g(a,b,c,g){if((0,d.isNodeNextResponse)(b)){var h;b.statusCode=c.status,b.statusMessage=c.statusText;let d=["set-cookie","www-authenticate","proxy-authenticate","vary"];null==(h=c.headers)||h.forEach((a,c)=>{if("x-middleware-set-cookie"!==c.toLowerCase())if("set-cookie"===c.toLowerCase())for(let d of(0,f.splitCookiesString)(a))b.appendHeader(c,d);else{let e=void 0!==b.getHeader(c);(d.includes(c.toLowerCase())||!e)&&b.appendHeader(c,a)}});let{originalResponse:i}=b;c.body&&"HEAD"!==a.method?await (0,e.pipeToNodeResponse)(c.body,i,g):i.end()}}},9294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var b=require("../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[80,730],()=>b(b.s=6469));module.exports=c})();