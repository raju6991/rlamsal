"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9110],{80246:(e,t,n)=>{let r,i,o,a,l,s,c;n.d(t,{$:()=>e5,A:()=>tZ,B:()=>tW,C:()=>tp,D:()=>tu,E:()=>nu,F:()=>tG,G:()=>np,H:()=>na,I:()=>eO,J:()=>ng,K:()=>ts,L:()=>eY,M:()=>tC,N:()=>nv,O:()=>eU,P:()=>ta,Q:()=>tN,R:()=>e7,S:()=>tO,T:()=>te,U:()=>eq,V:()=>th,W:()=>n_,X:()=>tt,Y:()=>to,Z:()=>eC,_:()=>tn,a:()=>no,a$:()=>rg,a0:()=>e8,a1:()=>ty,a2:()=>nM,a3:()=>n$,a4:()=>t5,a5:()=>nx,a6:()=>nb,a7:()=>t6,a8:()=>tV,a9:()=>ne,aA:()=>rP,aB:()=>r$,aC:()=>nR,aD:()=>n8,aE:()=>n9,aF:()=>re,aG:()=>nE,aH:()=>nJ,aI:()=>rv,aJ:()=>nK,aK:()=>rn,aL:()=>nY,aM:()=>nq,aN:()=>rw,aO:()=>rb,aP:()=>ry,aQ:()=>nB,aR:()=>nQ,aS:()=>n0,aT:()=>nO,aU:()=>rk,aV:()=>nz,aW:()=>nS,aX:()=>n7,aY:()=>nG,aZ:()=>nW,a_:()=>eh,aa:()=>t2,ab:()=>ev,ac:()=>ex,ad:()=>ti,ae:()=>tx,af:()=>ec,ag:()=>t1,ah:()=>t3,ai:()=>nC,aj:()=>nl,ak:()=>nc,al:()=>nI,am:()=>rh,an:()=>t0,ao:()=>t_,ap:()=>e9,aq:()=>tm,ar:()=>rp,as:()=>rC,at:()=>nZ,au:()=>nD,av:()=>n1,aw:()=>n2,ax:()=>nV,ay:()=>nX,az:()=>nP,b:()=>ns,b0:()=>r_,b1:()=>eQ,b2:()=>rc,b3:()=>rs,b4:()=>ri,b5:()=>rl,b6:()=>ru,b7:()=>rm,b8:()=>rj,b9:()=>rS,ba:()=>rM,c:()=>nn,d:()=>eZ,e:()=>e0,f:()=>eG,g:()=>ey,h:()=>eR,i:()=>tP,j:()=>eI,k:()=>tk,l:()=>eS,m:()=>tg,n:()=>tc,o:()=>e2,p:()=>em,q:()=>t7,r:()=>tr,s:()=>tS,t:()=>tl,u:()=>ed,v:()=>eg,w:()=>ew,x:()=>eb,y:()=>tb,z:()=>nk});var d,u,h=n(22465),f=n(19739),p=n(12115),m=n(52421),g=n(46765),v=n(89613);n(88711);var w=n(32669),y=n(2498);n(11304);var b=n(27707),k=n(28734);n(47512),n(37753);var x=n(90945),C=n(91441),j=n(52983),$=n(96156);n(29101),n(420);var S=n(22621),P=n(57383),M=n(67998),E=n(88350);n(35180);var I=n(64149),R=n(44823),_=n(32102),B=n(44512),A=n(94678),F=n(9121),T=n(18758),H=n(54034),U=n(96297),z=n(28925),N=n(95155),O=n(42213),L=n(75127),D=n(50093),W=n(85856),Y=n(63855),K=n(27827),q=n(84651),G=n(32683),J=n(2974),V=n(51253),X=n(93708),Q=n(70767),Z=n(99726),ee=n(60196),et=n(75038),en=n(52762),er=n(26445),ei=n(2532),eo=n(76941),ea=n(16366),el=n(65278);let es=(0,p.createContext)(null);function ec(e){let t,n,r,i,o,a,l,s,c,d,u=(0,h.c)(17);u[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>window.location.href,u[0]=t):t=u[0];let[f,m]=(0,p.useState)(t);u[1]===Symbol.for("react.memo_cache_sentinel")?(n=function(e,t){let n=new URL(e,window.location.href);n.origin===window.location.origin&&n.pathname.startsWith("/keystatic")?(window.history[t?"replaceState":"pushState"](null,"",n),(0,p.startTransition)(()=>{m(n.toString())})):window.location.assign(n)},u[1]=n):n=u[1];let g=n;u[2]===Symbol.for("react.memo_cache_sentinel")?(r=function(e){g(e,!0)},u[2]=r):r=u[2];let v=r;u[3]===Symbol.for("react.memo_cache_sentinel")?(i=function(e){g(e,!1)},u[3]=i):i=u[3];let w=i;if(u[4]!==f){let e=(a=new URL(f)).pathname.replace(/^\/keystatic\/?/,"");o=""===e?[]:e.split("/").map(decodeURIComponent),u[4]=f,u[5]=o,u[6]=a}else o=u[5],a=u[6];let y=o,b=a.pathname+a.search;u[7]!==b||u[8]!==a.pathname||u[9]!==a.search||u[10]!==y?(l={href:b,pathname:a.pathname,search:a.search,replace:v,push:w,params:y},u[7]=b,u[8]=a.pathname,u[9]=a.search,u[10]=y,u[11]=l):l=u[11];let k=l;return u[12]===Symbol.for("react.memo_cache_sentinel")?(s=()=>{let e=()=>{(0,p.startTransition)(()=>{m(window.location.href)})};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},c=[],u[12]=s,u[13]=c):(s=u[12],c=u[13]),(0,p.useEffect)(s,c),u[14]!==k||u[15]!==e.children?(d=(0,N.jsx)(es.Provider,{value:k,children:e.children}),u[14]=k,u[15]=e.children,u[16]=d):d=u[16],d}function ed(){let e=(0,p.useContext)(es);if(null==e)throw Error("useRouter must be used within a RouterProvider");return e}let eu=Symbol("emptyCacheNode");function eh(e){return e.replace(/^\.?\/+/,"").replace(/\/*$/,"")}let ef=/\/\*\*?(?:$|\/)/;function ep(e,t){var n;let r=null!=(n=e.collections[t].path)?n:`${t}/*/`;if(!ef.test(r))throw Error(`Collection path must end with /* or /** or include /*/ or /**/ but ${t} has ${r}`);return r}function em(e,t){return eh(ep(e,t).replace(/\*\*?.*$/,""))}function eg(e,t){return ej(e,"collections",t)}function ev(e,t){return ej(e,"singletons",t)}function ew(e,t,n){let r=em(e,t),i=ek(e,t);return`${r}/${n}${i}`}function ey(e,t){return`${e}${"index"===t.dataLocation?"/index":""}${eC(t)}`}function eb(e,t){return ep(e,t).includes("**")?"**":"*"}function ek(e,t){let n=eh(ep(e,t).replace(/^[^*]+\*\*?/,""));return n?`/${n}`:""}function ex(e,t){var n,r;if(null!=(n=e.singletons[t].path)&&n.includes("*"))throw Error(`Singleton paths cannot include * but ${t} has ${e.singletons[t].path}`);return eh(null!=(r=e.singletons[t].path)?r:t)}function eC(e){return e.contentField?e.contentField.contentExtension:"."+e.data}let ej=(d=function(e,t,n){var r,i;let o,a="collections"===t?e.collections[n]:e.singletons[n],l=("collections"===t?ep(e,n):null!=(r=a.path)?r:`${n}/`).endsWith("/")?"index":"outer",{schema:s,format:c="yaml"}=a;if("string"==typeof c)return{dataLocation:l,contentField:void 0,data:c};if(c.contentField){let e,r=Array.isArray(c.contentField)?c.contentField:[c.contentField];try{e=function e(t,n,r){if(0===t.length){if("form"!==n.kind||"content"!==n.formKind)throw new e$(`Content field for ${r()} is not a content field`);return n.contentExtension}if("object"===n.kind){let i=n.fields[t[0]];if(!i)throw new e$(`Field ${r()} specified in contentField does not exist`);return e(t.slice(1),i,r)}if("conditional"===n.kind){let i;if("value"!==t[0])throw new e$(`Conditional fields referenced in a contentField path must only reference the value field (${r()})`);let o=t.slice(1);for(let t of Object.values(n.values)){let n=e(o,t,r);if(!i){i=n;continue}if(i!==n)throw new e$(`contentField ${r()} has conflicting content extensions`)}if(!i)throw new e$(`contentField ${r()} does not point to a content field`);return i}throw new e$(`Path specified in contentField ${r()} does not point to a content field`)}(r,{kind:"object",fields:s},()=>JSON.stringify(c.contentField))}catch(e){if(e instanceof e$)throw Error(`${e.message} (${t}.${n})`);throw e}o={path:r,contentExtension:e}}return{data:null!=(i=c.data)?i:"yaml",contentField:o,dataLocation:l}},s={value:eu,strong:void 0,weak:void 0},(...e)=>{let t=s;for(let n of e){if("string"==typeof n||"number"==typeof n){void 0===t.strong&&(t.strong=new Map),t.strong.has(n)||t.strong.set(n,{value:eu,strong:void 0,weak:void 0}),t=t.strong.get(n);continue}if("object"==typeof n){void 0===t.weak&&(t.weak=new WeakMap),t.weak.has(n)||t.weak.set(n,{value:eu,strong:void 0,weak:void 0}),t=t.weak.get(n);continue}}if(t.value!==eu)return t.value;let n=d(...e);return t.value=n,n});class e$ extends Error{constructor(e){super(e)}}function eS(e){if("local"!==e.kind&&e.pathPrefix)return eh(e.pathPrefix)+"/"}async function eP(e){let t=await crypto.subtle.digest("SHA-1",e);return(0,en.d)(new Uint8Array(t))}let eM=new TextEncoder,eE=new WeakMap;async function eI(e){let t=eE.get(e);if(void 0!==t)return t;let n=eM.encode("blob "+e.length+"\0"),r=new Uint8Array(n.byteLength+e.byteLength);r.set(n,0),r.set(e,n.byteLength);let i=eP(r);return eE.set(e,i),i.then(t=>eE.set(e,t)),i}function eR(e,t){let n=t.split("/"),r=e.get(n[0]);for(let e of n.slice(1)){if(!r||!r.children)return;r=r.children.get(e)}return r}function e_(e,t){if(""===t)return e;let n=e;for(let e of t.split("/")){n.has(e)||n.set(e,new Map);let t=n.get(e);(0,z.vA)(t instanceof Map,"expected tree"),n=t}return n}function eB(e){return e.replace(/.*\//,"")}function eA(e){return e.includes("/")?e.replace(/\/[^/]+$/,""):""}let eF=new Uint8Array([32]),eT=new Uint8Array([0]),eH=eM.encode("tree ");function eU(e){let t=[...e].map(([e,t])=>({name:e,sha:t.entry.sha,mode:t.entry.mode}));t.sort((e,t)=>{let n="040000"===e.mode?e.name+"/":e.name,r="040000"===t.mode?t.name+"/":t.name;return n===r?0:n<r?-1:1});let n=t.flatMap(e=>[eM.encode(e.mode.replace(/^0/,"")),eF,eM.encode(e.name),eT,function(e){let t=new Uint8Array(e.length/2);for(var n=0;n<t.byteLength;n+=1){let r=2*n;t[n]=parseInt(e.slice(r,r+2),16)}return t}(e.sha)]);return eP(function(e){let t=new Uint8Array(e.reduce((e,t)=>e+t.byteLength,0)),n=0;for(let r of e)t.set(r,n),n+=r.byteLength;return t}([eH,eM.encode(n.reduce((e,t)=>e+t.byteLength,0).toString()),eT,...n]))}async function ez(e,t){return{path:e,mode:"040000",type:"tree",sha:await eU(t)}}async function eN(e,t){return{path:e,mode:"100644",type:"blob",sha:"sha"in t?t.sha:await eI(t)}}async function eO(e,t){var n;let r=null!=(n=await eD(e,function(e){let t=new Map;for(let n of e.deletions)e_(t,eA(n)).set(eB(n),"delete");for(let n of e.additions)e_(t,eA(n.path)).set(eB(n.path),n.contents);return t}(t),[]))?n:new Map;return{entries:eL(r),sha:await eU(null!=r?r:new Map)}}function eL(e){return[...e.values()].flatMap(e=>e.children?[e.entry,...eL(e.children)]:[e.entry])}async function eD(e,t,n){let r=new Map(e);for(let[e,a]of t){if("delete"===a&&r.delete(e),a instanceof Map){var i,o;let t=null!=(i=null==(o=r.get(e))?void 0:o.children)?i:new Map,l=await eD(t,a,n.concat(e));if(void 0===l){r.delete(e);continue}let s=await ez(n.concat(e).join("/"),l);r.set(e,{entry:s,children:l})}if(a instanceof Uint8Array||"object"==typeof a&&"sha"in a){let t=await eN(n.concat(e).join("/"),a);r.set(e,{entry:t})}}if(0!==r.size)return r}function eW(e){let t=new Map,n=e=>{var n;if(0===e.length)return t;let r=t.get(e[0]);for(let t of e.slice(1)){if(!r||!r.children)return;r=r.children.get(t)}return null==(n=r)?void 0:n.children};for(let t of e){let e=t.path.split("/"),r=n(e.slice(0,-1));r&&r.set(e[e.length-1],{entry:t,children:"tree"===t.type?new Map:void 0})}return t}let eY={then(){}};function eK(e){return e&&"function"==typeof e.then}function eq(e){if("error"===e.kind)throw e.error;if("loaded"===e.kind)return e.data;throw e.promise}function eG(e){let t=(0,p.useMemo)(()=>{try{let t=e();return eK(t)&&t.then(()=>{},()=>{}),{kind:"result",result:t}}catch(e){return{kind:"error",error:e}}},[e]),[n,r]=(0,p.useState)(()=>"result"===t.kind?eK(t.result)?{kind:"loading",promise:t.result}:{kind:"loaded",data:t.result}:t),i=n,o=(0,p.useMemo)(()=>"error"===t.kind&&("error"!==n.kind||n.error!==t.error)?{kind:"error",error:t.error}:"result"!==t.kind||eK(t.result)||"loaded"===n.kind&&n.data===t.result?void 0:{kind:"loaded",data:t.result},[t,n]);return o&&o!==n&&(i=o,r(o)),(0,p.useEffect)(()=>{if("result"===t.kind&&eK(t.result)){r({kind:"loading",promise:t.result});let e=!0;return t.result.then(t=>{e&&r({kind:"loaded",data:t})},t=>{e&&r({kind:"error",error:t})}),()=>{e=!1}}},[t]),i}function eJ(e,t){return"error"===e.kind||"loading"===e.kind?e:{kind:"loaded",data:t(e.data)}}function eV(e){let t=Object.entries(e);for(let[,e]of t)if("error"===e.kind)return{kind:"error",error:e.error};let n=[];for(let[,e]of t)"loading"===e.kind&&n.push(e.promise);return n.length?{kind:"loading",promise:eX(...n)}:{kind:"loaded",data:Object.fromEntries(t.map(([e,t])=>[e,t.data]))}}let eX=(u=(...e)=>Promise.all(e),c={inner:new WeakMap},function(...e){let t=c;for(let n of e){let{inner:e}=t;e.has(n)||e.set(n,{inner:new WeakMap}),t=e.get(n)}return t.hasOwnProperty("value")||(t.value=u(...e)),t.value});function eQ(e){let t=new Set;return!function e(t,n,r){if(!r.has(t)){if(r.add(t),"array"===t.kind)return e(t.element,n,r);if("child"!==t.kind){if("form"===t.kind){if("asset"===t.formKind&&void 0!==t.directory&&n.add(eh(t.directory)),("content"===t.formKind||"assets"===t.formKind)&&void 0!==t.directories)for(let e of t.directories)n.add(eh(e));return}if("object"===t.kind){for(let i of Object.values(t.fields))e(i,n,r);return}if("conditional"===t.kind){for(let i of Object.values(t.values))e(i,n,r);return}(0,z.xb)(t)}}}(e,t,new Set),t}function eZ(e,t,n,r){let i=[eh(t)];"outer"===r.dataLocation&&i.push(eh(t)+eC(r));let o=void 0===n?"":`/${n}`;for(let t of eQ(e))i.push(t+o);return i}function e0(e,t){return e.map(e=>{var n;return null==(n=eR(t,e))?void 0:n.entry.sha}).join("-")}var e1="0.5.48";function e2(e,t){return{...t,kind:"object",fields:e}}let e3={seconds:60,minutes:60,hours:24,days:7,weeks:4,months:12,years:1/0};function e4(e){let t,n,r,i,o,a=(0,h.c)(10),{locale:l}=(0,er.Y)();a[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>new Date,a[0]=t):t=a[0];let[s]=(0,p.useState)(t);if(a[1]!==l||a[2]!==e.date||a[3]!==s){let t=new Intl.RelativeTimeFormat(l);t.format(e.date.getTime()-s.getTime(),"second"),r=function(e,t,n){let r=(e.getTime()-t.getTime())/1e3;for(let[e,t]of Object.entries(e3)){if(Math.abs(r)<t)return n.format(Math.round(r),e);r/=t}return"unknown"}(e.date,s,t),a[1]=l,a[2]=e.date,a[3]=s,a[4]=r}else r=a[4];return n=r,a[5]!==e.date?(i=e.date.toISOString(),a[5]=e.date,a[6]=i):i=a[6],a[7]!==i||a[8]!==n?(o=(0,N.jsx)("time",{dateTime:i,children:n}),a[7]=i,a[8]=n,a[9]=o):o=a[9],o}function e6(){return r||(r=(0,ei.y$)("keystatic","items")),r}function e5(e,t){return(0,ei.hZ)(e,t,e6())}function e8(e){return(0,ei.yH)(e,e6())}function e7(e){return(0,ei.Jt)(e,e6())}async function e9(){await (0,ei.IU)(e6())}function te(e,t){return e.collections[t]}function tt(e){return"local"!==e.storage.kind?e.storage.branchPrefix:void 0}function tn(e){return"github"===e.storage.kind}function tr(e){return"local"===e.storage.kind}function ti(e){var t;if("cloud"!==e.storage.kind)return!1;if(!(null!=(t=e.cloud)&&t.project)||!e.cloud.project.includes("/"))throw Error(`Keystatic is set to \`storage: { kind: 'cloud' }\` but \`cloud.project\` isn't set.
config({
  storage: { kind: 'cloud' },
  cloud: { project: 'team/project' },
})`);return!0}function to(e){return`https://github.com/${e.owner}/${e.name}`}function ta(e,t){let n=t[e.slugField],r=e.schema[e.slugField];if("form"!==r.kind||"slug"!==r.formKind)throw Error("slugField is not a slug field");return r.serializeWithSlug(n).slug}function tl(e,t,n){var r,i,o;let a=e2(e.collections[t].schema),l=eg(e,t),s=eC(l),c=eb(e,t),d=null!=(r=null==(i=eR(n,em(e,t)))?void 0:i.children)?r:new Map,u=[],h=[...eQ(a)],f=ek(e,t),p=new Map(d);if("**"===c){let e=(t,n)=>{for(let[r,i]of t)i.children?(p.set(`${n}${r}`,i),e(i.children,`${n}${r}/`)):p.set(`${n}${r}`,i)};e(d,"")}for(let[r,i]of p)if("index"===l.dataLocation){let i=eR(n,ew(e,t,r));if(!(null!=i&&null!=(o=i.children)&&o.has("index"+s)))continue;u.push({key:e0([i.entry.path,...h.map(e=>`${e}/${r}`)],n),slug:r,sha:i.children.get("index"+s).entry.sha})}else{if(f){let o=eR(n,ew(e,t,r)+s);if(!o||o.children)continue;u.push({key:e0([i.entry.path,ew(e,t,r),...h.map(e=>`${e}/${r}`)],n),slug:r,sha:o.entry.sha})}if(i.children||!r.endsWith(s))continue;let o=r.slice(0,-s.length);u.push({key:e0([i.entry.path,ew(e,t,o),...h.map(e=>`${e}/${o}`)],n),slug:o,sha:i.entry.sha})}return u}let ts="https://api.keystatic.cloud",tc={"x-keystatic-version":e1},td=new TextEncoder;async function tu(e,t){var n;if(!(null!=(n=t.cloud)&&n.project))throw Error("Not a cloud config");let r=(0,en.c)(crypto.getRandomValues(new Uint8Array(32))),i=(0,en.c)(new Uint8Array(await crypto.subtle.digest("SHA-256",td.encode(r)))),o=(0,en.c)(crypto.getRandomValues(new Uint8Array(32)));localStorage.setItem("keystatic-cloud-state",JSON.stringify({state:o,from:e,code_verifier:r}));let a=new URL(`${ts}/oauth/authorize`);a.searchParams.set("state",o),a.searchParams.set("client_id",t.cloud.project),a.searchParams.set("redirect_uri",`${window.location.origin}/keystatic/cloud/oauth/callback`),a.searchParams.set("response_type","code"),a.searchParams.set("code_challenge_method","S256"),a.searchParams.set("code_challenge",i),a.searchParams.set("keystatic_version",e1),window.location.href=a.toString()}function th(e,t,n){let r,i,o,a=(0,h.c)(8);a[0]!==e||a[1]!==t||a[2]!==n?(r=()=>{var r,i;e&&t===e.state&&(r=e.savedAt,i=n!==e.treeKey,P.n.info((0,N.jsxs)(E.EY,{children:["Restored draft from ",(0,N.jsx)(e4,{date:r}),"."," ",i&&(0,N.jsx)(E.EY,{color:"accent",children:"Other changes have been made to this entry since the draft. You may want to discard the draft changes."})]}),{timeout:8e3}))},a[0]=e,a[1]=t,a[2]=n,a[3]=r):r=a[3];let l=(0,A.J)(r);a[4]!==e||a[5]!==l?(i=()=>{e&&l()},o=[e,l],a[4]=e,a[5]=l,a[6]=i,a[7]=o):(i=a[6],o=a[7]),(0,p.useEffect)(i,o)}let tf=g.Ik({token:g.Yj(),project:g.Yj(),validUntil:g.au(g.p6(),g.ai(),e=>new Date(e))});function tp(e){if("u"<typeof document)return null;if("github"===e.storage.kind){let e=(0,Z.qg)(document.cookie)["keystatic-gh-access-token"];return e?{accessToken:e}:null}return"cloud"===e.storage.kind?tm(e):null}function tm(e){var t;let n;if(!(null!=(t=e.cloud)&&t.project))return null;let r=localStorage.getItem("keystatic-cloud-access-token");try{n=tf.create(JSON.parse(r))}catch(e){return null}return!n||n.validUntil<new Date||n.project!==e.cloud.project?null:{accessToken:n.token}}async function tg(e){let t=tp(e);return"github"!==e.storage.kind||t?t:(i||(i=(async()=>{try{let e=await fetch("/api/keystatic/github/refresh-token",{method:"POST"});if(200===e.status){let e=(0,Z.qg)(document.cookie)["keystatic-gh-access-token"];if(e)return{accessToken:e}}}catch{}finally{i=void 0}return null})()),i)}let tv=(0,ee.Ay)`
  fragment SidebarFooter_viewer on User {
    id
    name
    login
    avatarUrl
    databaseId
  }
`,tw=(0,p.createContext)(void 0);function ty(){return(0,p.useContext)(tw)}function tb(e){if("string"==typeof e){let[t,n]=e.split("/");return{owner:t,name:n}}return e}function tk(e){return"string"==typeof e?e:`${e.owner}/${e.name}`}function tx(e){if("string"==typeof e&&!e.includes("/"))throw Error(`Invalid repo config: ${e}. It must be in the form owner/name`);if("object"==typeof e){if(!e.owner&&!e.name)throw Error("Invalid repo config: owner and name are missing");if(!e.owner)throw Error("Invalid repo config: owner is missing");if(!e.name)throw Error("Invalid repo config: name is missing")}}function tC(e,t){let n=eS(t.storage);if(!n)return e;let r=[];for(let t of e.entries.values())t.path.startsWith(n)&&r.push({...t,path:t.path.slice(n.length)});return{entries:new Map(r.map(e=>[e.path,e])),tree:eW(r)}}function tj(){return o||(o=(0,ei.y$)("keystatic-trees","trees")),o}function t$(){return a||(a=(0,ei.y$)("keystatic-blobs","blobs")),a}function tS(e,t){return(0,ei.hZ)(e,t,t$())}async function tP(e){let t=await (0,ei.Jt)(e,t$());if(t instanceof Uint8Array)return t}let tM=g.YO(g.Ik({path:g.Yj(),mode:g.Yj(),sha:g.Yj()}));function tE(){if(l)return l;let e=new Map;return(0,ei.jO)(tj()).then(t=>{for(let[n,r]of t){let t;if("string"==typeof n){try{t=tM.create(r)}catch{continue}e.set(n,t)}}return l=e,e})}function tI(e,t,n=""){let r=new Map,i=t.get(e);if(i){for(let e of i){let i=(""===n?"":n+"/")+e.path;if("040000"===e.mode){let n=tI(e.sha,t,i);if(n){r.set(e.path,n);continue}return}r.set(e.path,{entry:{mode:e.mode,path:i,sha:e.sha,type:"120000"===e.mode?"symlink":"blob"}})}return{entry:{mode:"040000",path:n,sha:e,type:"tree"},children:r}}}async function tR(e){let t=new Map,n=[];for(let[e,r]of(await tE())){let i;if("string"!=typeof e){n.push(e);continue}try{i=tM.create(r)}catch{n.push(e);continue}t.set(e,i)}let r=new Set(await (0,ei.HP)(t$())),i=new Set(e);for(let e of i){if(r.has(e)){r.delete(e);continue}let n=t.get(e);if(n){for(let e of n)i.add(e.sha);t.delete(e);continue}}let o=[...t.keys(),...n];for(let e of(await Promise.all([(0,ei.LJ)([...r],t$()),(0,ei.LJ)([...t.keys(),...n],tj())]),o)){var a;null==(a=l)||a.delete(e)}}async function t_(){await Promise.all([(0,ei.IU)(t$()),(0,ei.IU)(tj())])}let tB=[];tB[0]=(e,t,n,r)=>{K.zd(e,0);let i=G.VU(t,e,n.doc,n);r&&i===G.Zg&&!n.synced&&(n.synced=!0)},tB[3]=(e,t,n)=>{K.zd(e,1),K.Gu(e,O.X3(n.awareness,Array.from(n.awareness.getStates().keys())))},tB[1]=(e,t,n)=>{O.tQ(n.awareness,q.bo(t),n)},tB[2]=(e,t,n)=>{J.gU(t,n.doc,tA)},tB[4]=(e,t,n,r)=>{let i=q.t3(t);K.zd(e,0);let o=n.getSubDoc(i);if(o){let i=G.VU(t,e,o,n);r&&i===G.Zg&&o.emit("sync",[!0])}};let tA=(e,t)=>console.warn(`Permission denied to access ${e.url}.
${t}`),tF=(e,t,n)=>{let r=q.$C(t),i=K.xv(),o=q.cw(r),a=tB[o];return a?a(i,r,e,n,o):console.error("Unable to compute message"),i},tT=(e,t)=>{if(e.shouldConnect&&null===e.ws){let n=new t(e.url);n.binaryType="arraybuffer",e.ws=n,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1;let r={kind:"authenticating",queue:[]};n.onmessage=t=>{e.wsLastMessageReceived=Y._g();let i=new Uint8Array(t.data);if("authenticating"===r.kind){let t=q.$C(i);if(2===q.pT(t)&&2===q.pT(t)){let t=r.queue;for(let i of(r={kind:"authed"},e.onConnect(n),t)){let t=tF(e,i,!0);K.Bw(t)>1&&n.send(K.Fo(t))}return}r.queue.push(i)}else{let t=tF(e,i,!0);K.Bw(t)>1&&n.send(K.Fo(t))}},n.onclose=()=>{e.ws=null,e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,O._g(e.awareness,Array.from(e.awareness.getStates().keys()).filter(t=>t!==e.doc.clientID),e),e.onStatus({status:"disconnected"})):e.wsUnsuccessfulReconnects++,setTimeout(tT,X.jk(1200*X.YL(e.wsUnsuccessfulReconnects+1),2500),e)},n.onopen=async()=>{e.wsLastMessageReceived=Y._g();let t=K.xv();K.zd(t,2),K.zd(t,0),K.Qj(t,await e.authToken()),n.send(K.Fo(t))},e.onStatus({status:"connecting"})}},tH=(e,t)=>{if(e.ws&&e.wsconnected){var n;null==(n=e.ws)||n.send(t)}e.bcconnected&&e.mux(()=>{W.mk(e.bcChannel,t)})};class tU{#e;#t;#n;#r;constructor(e){var t,n,r;this.bcChannel=e.url,this.url=e.url,this.doc=e.doc,this.#e=null!=(t=e.WebSocketPolyfill)?t:WebSocket,this.awareness=e.awareness,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.wsUnsuccessfulReconnects=0,this.mux=V.i(),this.#t=!1,this.authToken=e.authToken,this.ws=null,this.wsLastMessageReceived=0,this.onStatus=null!=(n=e.onStatus)?n:()=>{},this.onSynced=null!=(r=e.onSynced)?r:()=>{},this.shouldConnect=!1,this.subdocs=new Map,this.#n=null,void 0!==e.resyncInterval&&e.resyncInterval>0&&(this.#n=setInterval(()=>{if(this.ws){let t=K.xv();K.zd(t,0),G.ue(t,e.doc),this.ws.send(K.Fo(t))}},e.resyncInterval)),this.doc.on("subdocs",({added:e,removed:t,loaded:n})=>{e.forEach(e=>{this.subdocs.set(e.guid,e)}),t.forEach(e=>{e.off("update",this.#i(e)),this.subdocs.delete(e.guid)}),n.forEach(e=>{this.waitForConnection(()=>{let t=K.xv();K.zd(t,4),K.Qj(t,e.guid),G.ue(t,e),this.send(K.Fo(t),()=>{e.on("update",this.#i(e))})},1e3)})}),this.doc.on("update",this.#o),"u">typeof window&&window.addEventListener("beforeunload",this.#a),e.awareness.on("update",this.#l),this.#r=setInterval(()=>{if(this.wsconnected&&3e4<Y._g()-this.wsLastMessageReceived){var e;null==(e=this.ws)||e.close()}},3e3)}onConnect(e){this.wsconnecting=!1,this.wsconnected=!0,this.wsUnsuccessfulReconnects=0,this.onStatus({status:"connected"});let t=K.xv();if(K.zd(t,0),G.ue(t,this.doc),e.send(K.Fo(t)),null!==this.awareness.getLocalState()){let t=K.xv();K.zd(t,1),K.Gu(t,O.X3(this.awareness,[this.doc.clientID])),e.send(K.Fo(t))}}#s=e=>{this.mux(()=>{let t=tF(this,new Uint8Array(e),!1);K.Bw(t)>1&&W.mk(this.bcChannel,K.Fo(t))})};#a=()=>{O._g(this.awareness,[this.doc.clientID],"window unload")};waitForConnection=(e,t)=>{let n=this.ws;(null==n?void 0:n.readyState)===1?e(n):setTimeout(()=>{this.waitForConnection(e,t)},t)};#l=({added:e,updated:t,removed:n})=>{let r=e.concat(t).concat(n),i=K.xv();K.zd(i,1),K.Gu(i,O.X3(this.awareness,r)),tH(this,K.Fo(i))};send=(e,t)=>{this.waitForConnection(n=>{n.send(e),void 0!==t&&t()},1e3)};get synced(){return this.#t}getSubDoc(e){return this.subdocs.get(e)}set synced(e){this.#t!==e&&(this.#t=e,this.onSynced(e),this.doc.emit("sync",[e]))}#i=(0,Q.A)(e=>t=>{let n=K.xv();K.zd(n,4),K.Qj(n,e.guid),G.f7(n,t),tH(this,K.Fo(n))});#o=(e,t)=>{if(t!==this){let t=K.xv();K.zd(t,0),G.f7(t,e),tH(this,K.Fo(t))}};destroy(){null!==this.#n&&clearInterval(this.#n),clearInterval(this.#r),this.disconnect(),"u">typeof window&&window.removeEventListener("beforeunload",this.#a),this.awareness.off("update",this.#l),this.doc.off("update",this.#o)}connectBc(){this.bcconnected||(W.B1(this.bcChannel,this.#s),this.bcconnected=!0),this.mux(()=>{let e=K.xv();K.zd(e,0),G.ue(e,this.doc),W.mk(this.bcChannel,K.Fo(e));let t=K.xv();K.zd(t,0),G.nh(t,this.doc),W.mk(this.bcChannel,K.Fo(t));let n=K.xv();K.zd(n,3),W.mk(this.bcChannel,K.Fo(n));let r=K.xv();K.zd(r,1),K.Gu(r,O.X3(this.awareness,[this.doc.clientID])),W.mk(this.bcChannel,K.Fo(r))})}disconnectBc(){let e=K.xv();K.zd(e,1),K.Gu(e,O.X3(this.awareness,[this.doc.clientID],new Map)),tH(this,K.Fo(e)),this.bcconnected&&(W.al(this.bcChannel,this.#s),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(tT(this,this.#e),this.connectBc())}}let tz=(0,p.createContext)(null);function tN(){let e=(0,p.useContext)(tz);if(!e)throw Error("CollabProvider not found");if("loading"===e)throw Error("CollabProvider is loading");return e}function tO(){return(0,p.useContext)(tz)}let tL=new Map,tD=(0,p.createContext)(tL);function tW(){return(0,p.useContext)(tD)}let tY=new WeakMap;function tK(e){var t;let n=ed(),r=tZ(),i=null==(t=e.config.cloud)?void 0:t.project,o=`ks-multiplayer-${i}`,a=null===r?"true"===localStorage.getItem(o):r.team.multiplayer,l=(0,p.useMemo)(()=>{if(!a)return;let t=new L.JA,n=t.getMap("data"),r=new O.ww(t),o=(0,D.NW)(t,`keystatic-2-${i}`),l=new tU({doc:t,url:`wss://live.keystatic.cloud/${i}?v=${e1}`,WebSocketPolyfill:class extends ea.Ay{constructor(e){super(e),this.addEventListener("message",e=>{e.data})}send(e){if(Uint8Array,e instanceof Uint8Array&&e.byteLength>1e6){let t=Math.ceil(e.byteLength/1e6),n=(0,K.xv)();(0,K.zd)(n,5),(0,K.zd)(n,t),super.send((0,K.Fo)(n));for(let n=0;n<t;n++){let t=1e6*n,r=Math.min((n+1)*1e6,e.byteLength);super.send(e.slice(t,r))}return}super.send(e)}},awareness:r,authToken:async()=>tg(e.config).then(e=>{var t;return null!=(t=null==e?void 0:e.accessToken)?t:""})});return{doc:t,awareness:r,provider:l,data:n,idb:o}},[a,i,e.config]),s=t7();(0,p.useEffect)(()=>{null==l||l.awareness.setLocalStateField("branch",s),null==l||l.awareness.setLocalStateField("location",n.params.slice(2).join("/"))},[s,n.params,null==l?void 0:l.awareness]);let c=!!s;(0,p.useEffect)(()=>{if(c&&l){l.idb.connect();let e=!1,t=l.idb.subscribeStatusChange(()=>{("synced"===l.idb.status.type||"error"===l.idb.status.type)&&(t(),l.provider.connect(),e=!0)});return()=>{l.idb.disconnect(),e?l.provider.disconnect():t()}}},[l,c]),(0,p.useEffect)(()=>{if(null===r)return;let e=`ks-multiplayer-${i}`;r.team.multiplayer?localStorage.setItem(e,"true"):localStorage.removeItem(e)},[r,i]);let d=(0,p.useSyncExternalStore)((0,p.useCallback)(e=>{let t=null==l?void 0:l.awareness;if(!t)return()=>{};let n=()=>{tY.set(t,new Map(t.getStates())),e()};return t.on("change",n),()=>{tY.set(t,new Map(t.getStates())),t.off("change",n)}},[l]),()=>{var e;return null!=l&&l.awareness&&null!=(e=tY.get(l.awareness))?e:tL});return(0,N.jsx)(tD.Provider,{value:null!=d?d:tL,children:(0,N.jsx)(tz.Provider,{value:void 0===l?void 0===r?"loading":null:l,children:e.children})})}function tq(e){let t,n,r=(0,h.c)(4);r[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,N.jsx)(C.so,{justifyContent:"center",children:(0,N.jsx)(E.DZ,{children:"Git repo not initialised"})}),r[0]=t):t=r[0];let i=`https://github.com/${e.repo}`;return r[1]!==i||r[2]!==e.repo?(n=(0,N.jsx)(C.so,{alignItems:"center",justifyContent:"center",margin:"xxlarge",children:(0,N.jsxs)(C.so,{backgroundColor:"surface",padding:"large",border:"color.alias.borderIdle",borderRadius:"medium",direction:"column",justifyContent:"center",gap:"xlarge",maxWidth:"scale.4600",children:[t,(0,N.jsxs)(E.EY,{children:["The Keystatic GitHub App is installed in the GitHub repository"," ",(0,N.jsx)(j.Y,{href:i,children:e.repo})," ","but the Git repo is not initialised. Please initialise the Git repo before using Keystatic."]})]})}),r[1]=i,r[2]=e.repo,r[3]=n):n=r[3],n}function tG(){return(0,p.useContext)(tJ)}let tJ=(0,p.createContext)(()=>{throw Error("SetTreeShaContext not set")});function tV(e){let[t,n]=(0,p.useState)("initial"),r=eG((0,p.useCallback)(()=>(function(e){if(nm.has(e))return nm.get(e);let t=fetch("/api/keystatic/tree",{headers:{"no-cors":"1"}}).then(e=>e.json()).then(async e=>ng(e));return nm.set(e,t),t})(t),[t])),i=(0,p.useMemo)(()=>({unscopedDefault:r,scoped:{default:r,current:r,merged:eV({default:r,current:r})}}),[r]),o=(0,p.useMemo)(()=>"loaded"!==i.scoped.merged.kind?{collections:new Map,singletons:new Set}:ny(e.config,i.scoped.merged.data),[i,e.config]);return(0,N.jsx)(tJ.Provider,{value:n,children:(0,N.jsx)(nr.Provider,{value:o,children:(0,N.jsx)(ni.Provider,{value:i,children:e.children})})})}let tX=g.NW({user:g.NW({id:g.Yj(),name:g.Yj(),email:g.Yj(),avatarUrl:g.lq(g.Yj())}),project:g.NW({name:g.Yj()}),team:g.Ik({name:g.Yj(),slug:g.Yj(),images:g.zM(),multiplayer:g.zM()})}),tQ=(0,p.createContext)(null);function tZ(){let e=(0,p.useContext)(tQ);return"unauthorized"===e?null:e}function t0(){return(0,p.useContext)(tQ)}function t1(e){let t=eG((0,p.useCallback)(async()=>{var t,n;if(!(null!=(t=e.config.cloud)&&t.project))throw Error("no cloud project set");let r=null==(n=tm(e.config))?void 0:n.accessToken;if(!r)return"unauthorized";let i=await fetch(`${ts}/v1/info`,{headers:{...tc,Authorization:`Bearer ${r}`}});return 401===i.status?"unauthorized":tX.create(await i.json())},[e.config]));return(0,N.jsx)(tQ.Provider,{value:"loaded"===t.kind?t.data:null,children:e.children})}let t2=(0,p.createContext)(null);function t3(e){var t,n,r,i;let o="github"===e.config.storage.kind?tb(e.config.storage.repo):{name:"repo-name",owner:"repo-owner"},[a]=(0,et.IT)({query:"github"===e.config.storage.kind?np:nu,variables:o}),[l,s]=(0,p.useState)(null),[c]=(0,et.IT)({query:(0,ee.Ay)`
      query FetchMoreRefs($owner: String!, $name: String!, $after: String) {
        repository(owner: $owner, name: $name) {
          __typename
          id
          refs(refPrefix: "refs/heads/", first: 100, after: $after) {
            __typename
            nodes {
              ...Ref_base
            }
            pageInfo {
              hasNextPage
              endCursor
            }
          }
        }
      }
      ${nc}
    `,pause:!(null!=(t=a.data)&&null!=(t=t.repository)&&null!=(t=t.refs)&&t.pageInfo.hasNextPage),variables:{...o,after:null!=l?l:null==(n=a.data)||null==(n=n.repository)||null==(n=n.refs)?void 0:n.pageInfo.endCursor}}),d=null==(r=c.data)||null==(r=r.repository)||null==(r=r.refs)?void 0:r.pageInfo;return(null!=d&&d.hasNextPage&&d.endCursor!==l&&d.endCursor&&s(d.endCursor),null==(i=a.data)||null==(i=i.repository)||!i.owner||a.data.repository.defaultBranchRef||a.fetching||a.error)?(0,N.jsx)(t2.Provider,{value:a,children:(0,N.jsx)(tw.Provider,{value:a.data&&"viewer"in a.data?a.data.viewer:void 0,children:e.children})}):(0,N.jsx)(tq,{repo:`${a.data.repository.owner.login}/${a.data.repository.name}`})}let t4=new Set(["WRITE","ADMIN","MAINTAIN"]);function t6(e){var t,n,r,i,o,a,l,s,c,d,u,h,f,m,g;let v=ed(),{data:w,error:y}=(0,p.useContext)(t2),b=null==w?void 0:w.repository;b&&"viewerPermission"in b&&b.viewerPermission&&!t4.has(b.viewerPermission)&&"forks"in b&&(b=null!=(m=null==(g=b.forks)||null==(g=g.nodes)?void 0:g[0])?m:b);let k=null==(t=b)||null==(t=t.refs)||null==(t=t.nodes)?void 0:t.find(e=>{var t;return(null==e?void 0:e.name)===(null==(t=b)||null==(t=t.defaultBranchRef)?void 0:t.name)}),x=null==(n=b)||null==(n=n.refs)||null==(n=n.nodes)?void 0:n.find(t=>(null==t?void 0:t.name)===e.currentBranch);(0,p.useEffect)(()=>{var e;null!=(e=b)&&null!=(e=e.refs)&&e.nodes&&tR(b.refs.nodes.map(e=>{var t;return(null==e||null==(t=e.target)?void 0:t.__typename)==="Commit"?e.target.tree.oid:void 0}).filter(z.O9))},[null==(r=b)?void 0:r.id]);let C=null!=(i=null==k?void 0:k.target.tree.oid)?i:null,j=null!=(o=null==x?void 0:x.target.tree.oid)?o:null,$=nw(C,e.config),S=nw(j,e.config),P=(0,p.useMemo)(()=>{let t=eJ($,t=>tC(t,e.config)),n=eJ(S,t=>tC(t,e.config));return{unscopedDefault:S,scoped:{default:t,current:n,merged:eV({default:t,current:n})}}},[S,$,e.config]),M=(0,p.useMemo)(()=>"loaded"!==P.scoped.merged.kind?{collections:new Map,singletons:new Set}:ny(e.config,P.scoped.merged.data),[P,e.config]);(0,p.useEffect)(()=>{var t,n;(null==y||null==(t=y.response)?void 0:t.status)===401&&(tn(e.config)?window.location.href=`/api/keystatic/github/login?from=${v.params.map(encodeURIComponent).join("/")}`:tu(v.params.map(encodeURIComponent).join("/"),e.config)),!(null!=(n=b)&&n.id)&&null!=y&&y.graphQLErrors.some(e=>{var t,n;return(null==e||null==(t=e.originalError)?void 0:t.type)==="NOT_FOUND"||(null==e||null==(n=e.originalError)?void 0:n.type)==="FORBIDDEN"})&&(window.location.href=`/api/keystatic/github/repo-not-found?from=${v.params.map(encodeURIComponent).join("/")}`)},[y,v,null==(a=b)?void 0:a.id,e.config]);let E=(0,p.useMemo)(()=>{var e;return new Map(null==(e=b)||null==(e=e.refs)||null==(e=e.nodes)?void 0:e.flatMap(e=>{var t;return(null==e||null==(t=e.target)?void 0:t.__typename)!=="Commit"?[]:[[e.name,{id:e.id,commitSha:e.target.oid,treeSha:e.target.tree.oid}]]}))},[null==(l=b)||null==(l=l.refs)?void 0:l.nodes]),I=!!b&&("cloud"===e.config.storage.kind||"viewerPermission"in b&&!!(null!=(s=b)&&s.viewerPermission)&&t4.has(b.viewerPermission)),R=(0,p.useMemo)(()=>{var e;return null!=w&&w.repository&&null!=(e=b)&&null!=(e=e.defaultBranchRef)&&e.name?{id:b.id,defaultBranch:b.defaultBranchRef.name,hasWritePermission:I,isPrivate:b.isPrivate,name:b.name,owner:b.owner.login,upstream:{name:b.name,owner:b.owner.login}}:null},[null==w?void 0:w.repository,I,null==(c=b)||null==(c=c.defaultBranchRef)?void 0:c.name,null==(d=b)?void 0:d.id,null==(u=b)?void 0:u.isPrivate,null==(h=b)?void 0:h.name,null==(f=b)?void 0:f.owner.login]);return(0,N.jsx)(t5.Provider,{value:y,children:(0,N.jsx)(t8.Provider,{value:e.currentBranch,children:(0,N.jsx)(t9.Provider,{value:E,children:(0,N.jsx)(nt.Provider,{value:R,children:(0,N.jsx)(nr.Provider,{value:M,children:(0,N.jsx)(ni.Provider,{value:P,children:"cloud"===e.config.storage.kind?(0,N.jsx)(tK,{config:e.config,children:e.children}):e.children})})})})})})}let t5=(0,p.createContext)(void 0),t8=(0,p.createContext)("");function t7(){return(0,p.useContext)(t8)}let t9=(0,p.createContext)(new Map);function ne(){return(0,p.useContext)(t9)}let nt=(0,p.createContext)(null);function nn(){return(0,p.useContext)(nt)}let nr=(0,p.createContext)({collections:new Map,singletons:new Set}),ni=(0,p.createContext)({unscopedDefault:{kind:"loading",promise:eY},scoped:{current:{kind:"loading",promise:eY},default:{kind:"loading",promise:eY},merged:{kind:"loading",promise:eY}}});function no(){return(0,p.useContext)(ni).scoped}function na(){return(0,p.useContext)(ni).unscopedDefault}function nl(){return(0,p.useContext)(nr)}function ns(){var e,t;let n=ne(),r=t7();return null!=(e=null==(t=n.get(r))?void 0:t.commitSha)?e:""}let nc=(0,ee.Ay)`
  fragment Ref_base on Ref {
    id
    name
    target {
      __typename
      id
      oid
      ... on Commit {
        tree {
          id
          oid
        }
      }
    }
  }
`,nd=(0,ee.Ay)`
  fragment Repo_base on Repository {
    id
    isPrivate
    owner {
      id
      login
    }
    name
    defaultBranchRef {
      id
      name
    }
    refs(refPrefix: "refs/heads/", first: 100) {
      nodes {
        ...Ref_base
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
  ${nc}
`,nu=(0,ee.Ay)`
  query CloudAppShell($name: String!, $owner: String!) {
    repository(owner: $owner, name: $name) {
      id
      ...Repo_base
    }
  }
  ${nd}
`,nh=(0,ee.Ay)`
  fragment Repo_ghDirect on Repository {
    id
    ...Repo_base
    viewerPermission
  }
  ${nd}
`,nf=(0,ee.Ay)`
  fragment Repo_primary on Repository {
    id
    ...Repo_ghDirect
    forks(affiliations: [OWNER], first: 1) {
      nodes {
        ...Repo_ghDirect
      }
    }
  }
  ${nh}
`,np=(0,ee.Ay)`
  query GitHubAppShell($name: String!, $owner: String!) {
    repository(owner: $owner, name: $name) {
      id
      ...Repo_primary
    }
    viewer {
      ...SidebarFooter_viewer
    }
  }
  ${nf}
  ${tv}
`,nm=new eo.q({max:40});async function ng(e){let t={entries:new Map(e.map(e=>[e.path,e])),tree:eW(e)},n=await eU(t.tree);return nm.set(n,t),t}function nv(e,t){let n,r=nm.get(e);if(r)return r;let i=(n=tE())instanceof Map?tI(e,n):n.then(t=>tI(e,t));if(i&&!(i instanceof Promise)){let t={entries:new Map(eL(i.children).map(e=>[e.path,e])),tree:i.children};return nm.set(e,t),t}let o=(async()=>{var n;let r,o=await i;if(o){let t={entries:new Map(eL(o.children).map(e=>[e.path,e])),tree:o.children};return nm.set(e,t),t}let a=await tg(t);if(!a)throw Error("Not authorized");let{tree:l}=await fetch("github"===t.storage.kind?`https://api.github.com/repos/${tk(t.storage.repo)}/git/trees/${e}?recursive=1`:`${ts}/v1/github/trees/${e}`,{headers:{Authorization:`Bearer ${a.accessToken}`,..."cloud"===t.storage.kind?tc:{}}}).then(e=>e.json()),s=l.map(({url:e,size:t,...n})=>n);return await (n=eW(s),function e(t,n,r){let i=[];for(let[t,o]of n)i.push({path:t.replace(/.*\//,""),mode:o.entry.mode,sha:o.entry.sha}),o.children&&e(o.entry.sha,o.children,r);r.push([t,i])}(e,n,r=[]),(0,ei._y)(r,tj())),ng(s)})();return nm.set(e,o),o}function nw(e,t){return eG((0,p.useCallback)(()=>e?nv(e,t):eY,[e,t]))}function ny(e,t){var n,r;return{collections:new Map(Object.keys(null!=(n=e.collections)?n:{}).map(n=>{let r=new Map(tl(e,n,t.current.tree).map(e=>[e.slug,e.key])),i=new Map(tl(e,n,t.default.tree).map(e=>[e.slug,e.key])),o=new Set,a=new Set;for(let[e,t]of r){let n=i.get(e);if(void 0===n){a.add(e);continue}t!==n&&o.add(e)}return[n,{removed:new Set([...i.keys()].filter(e=>!r.has(e))),added:a,changed:o,totalCount:r.size}]})),singletons:new Set(Object.keys(null!=(r=e.singletons)?r:{}).filter(n=>{var r,i;let o=ex(e,n);return(null==(r=eR(t.current.tree,o))?void 0:r.entry.sha)!==(null==(i=eR(t.default.tree,o))?void 0:i.entry.sha)}))}}let nb=(0,p.createContext)(null);function nk(){let e=(0,p.useContext)(nb);if(!e)throw Error("ConfigContext.Provider not found");return e}let nx=(0,p.createContext)({basePath:"/keystatic"});function nC(){let e=(0,p.useContext)(nx);if(!e)throw Error("AppStateContext.Provider not found");return e}let nj=(0,p.createContext)("mobile"),n$=nj.Provider;function nS(){return(0,p.useContext)(nj)}function nP(e){let t=["mobile","tablet","desktop","wide"],n=nS(),r="above"in e?t.indexOf(e.above)+1:0,i="below"in e?t.indexOf(e.below)-1:t.length-1;return t.slice(r,i+1).includes(n)}function nM(e){let t,n,r=(0,h.c)(5),[i,o]=(0,p.useState)("mobile");r[0]!==e.current?(t=()=>{o(t=>{let n=e.current;return n?n.offsetWidth>=I.fi.wide?"wide":n.offsetWidth>=I.fi.desktop?"desktop":n.offsetWidth>=I.fi.tablet?"tablet":"mobile":t})},r[0]=e.current,r[1]=t):t=r[1];let a=t;return r[2]!==e||r[3]!==a?(n={ref:e,onResize:a},r[2]=e,r[3]=a,r[4]=n):n=r[4],(0,F.w)(n),i}function nE(e){let t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(m.rL.toDOMRange(e,e.selection))),m.rL.focus(e)}let nI=(0,I.AH)({marginBlock:"0.75em","&:first-child":{marginBlockStart:0},"&:last-child":{marginBlockEnd:0}});function nR(e,t){let[n,r]=(0,p.useState)({element:t,elementWithChanges:t});n.element!==t&&r({element:t,elementWithChanges:t});let i=(0,p.useRef)(t);(0,p.useEffect)(()=>{i.current=t});let o=(0,p.useCallback)(t=>{let n=i.current,o="function"==typeof t?t(n):t;R.gB.setNodes(e,o,{at:m.rL.findPath(e,n)}),r({element:n,elementWithChanges:{...n,...o}})},[e]);return[n.elementWithChanges,o]}function n_(e){let t=(0,p.useRef)(e),n=(0,p.useCallback)((...e)=>t.current(...e),[]);return(0,p.useEffect)(()=>{t.current=e}),n}function nB(e,t){var n;let r,i=R.KE.above(e,{match:e=>"heading"===e.type||"paragraph"===e.type});i&&""===R.bP.string(i[0])&&(r=R.KE.pathRef(e,i[1])),R.gB.insertNodes(e,t);let o=null==(n=r)?void 0:n.unref();o&&(R.gB.removeNodes(e,{at:o}),m.rL.focus(e))}p.createContext(!1).Provider;let nA=["paragraph","code","heading","ordered-list","unordered-list","divider","image"],nF=[...nA,"table"],nT=[...nF,"blockquote","component-block"];function nH(e){return{kind:"blocks",allowedChildren:new Set(e.allowedChildren),blockToWrapInlinesIn:e.allowedChildren[0],invalidPositionHandleMode:e.invalidPositionHandleMode}}function nU(e){return{kind:"inlines",invalidPositionHandleMode:e.invalidPositionHandleMode}}let nz={editor:nH({allowedChildren:[...nT,"layout"],invalidPositionHandleMode:"move"}),layout:nH({allowedChildren:["layout-area"],invalidPositionHandleMode:"move"}),"layout-area":nH({allowedChildren:nT,invalidPositionHandleMode:"unwrap"}),blockquote:nH({allowedChildren:nF,invalidPositionHandleMode:"move"}),paragraph:nU({invalidPositionHandleMode:"unwrap"}),code:nU({invalidPositionHandleMode:"move"}),divider:nU({invalidPositionHandleMode:"move"}),heading:nU({invalidPositionHandleMode:"unwrap"}),"component-block":nH({allowedChildren:["component-block-prop","component-inline-prop"],invalidPositionHandleMode:"move"}),"component-inline-prop":nU({invalidPositionHandleMode:"unwrap"}),"component-block-prop":nH({allowedChildren:nT,invalidPositionHandleMode:"unwrap"}),"ordered-list":nH({allowedChildren:["list-item"],invalidPositionHandleMode:"move"}),"unordered-list":nH({allowedChildren:["list-item"],invalidPositionHandleMode:"move"}),"list-item":nH({allowedChildren:["list-item-content","ordered-list","unordered-list"],invalidPositionHandleMode:"unwrap"}),"list-item-content":nU({invalidPositionHandleMode:"unwrap"}),image:nU({invalidPositionHandleMode:"move"}),table:nH({invalidPositionHandleMode:"move",allowedChildren:["table-head","table-body"]}),"table-body":nH({invalidPositionHandleMode:"move",allowedChildren:["table-row"]}),"table-row":nH({invalidPositionHandleMode:"move",allowedChildren:["table-cell"]}),"table-cell":nH({invalidPositionHandleMode:"move",allowedChildren:nA}),"table-head":nH({invalidPositionHandleMode:"move",allowedChildren:["table-row"]})},nN=new Set(Object.entries(nz).filter(([,e])=>"inlines"===e.kind).map(([e])=>e));function nO(e){return void 0!==e.type&&nN.has(e.type)}let nL=new Set(Object.keys(nz).filter(e=>"editor"!==e));function nD(e){return nL.has(e.type)}function nW(e,t){var n,r,i,o,a,l,s;let c=null==(n=t.formatting)?void 0:n.inlineMarks,d=Object.fromEntries(Object.keys(e.formatting.inlineMarks).map(t=>[t,("inherit"===c||(null==c?void 0:c[t])==="inherit")&&e.formatting.inlineMarks[t]])),u=null==(r=t.formatting)?void 0:r.headingLevels;return{formatting:{inlineMarks:d,softBreaks:(null==(i=t.formatting)?void 0:i.softBreaks)==="inherit"&&e.formatting.softBreaks,alignment:{center:e.formatting.alignment.center&&(null==(o=t.formatting)?void 0:o.alignment)==="inherit",end:e.formatting.alignment.end&&(null==(a=t.formatting)?void 0:a.alignment)==="inherit"},blockTypes:(null==(l=t.formatting)?void 0:l.blockTypes)==="inherit"?e.formatting.blockTypes:{blockquote:!1,code:!1},headings:"inherit"===u?e.formatting.headings:{levels:u?e.formatting.headings.levels.filter(e=>u.includes(e)):[],schema:e.formatting.headings.schema},listTypes:(null==(s=t.formatting)?void 0:s.listTypes)==="inherit"?e.formatting.listTypes:{ordered:!1,unordered:!1}},dividers:"inherit"===t.dividers&&e.dividers,images:"inherit"===t.images&&e.images,layouts:[],links:"inherit"===t.links&&e.links,tables:"inherit"===t.tables&&e.tables}}function nY(e,t){var n,r,i,o,a,l,s;let c=null==(n=t.formatting)?void 0:n.inlineMarks,d="inherit"===c?"inherit":Object.fromEntries(Object.keys(e.formatting.inlineMarks).map(e=>[e,!!(c||{})[e]]));if("inline"===t.kind)return{kind:"inline",inlineMarks:d,documentFeatures:{links:"inherit"===t.links},softBreaks:(null==(s=t.formatting)?void 0:s.softBreaks)==="inherit"};let u=null==(r=t.formatting)?void 0:r.headingLevels;return{kind:"block",inlineMarks:d,softBreaks:(null==(i=t.formatting)?void 0:i.softBreaks)==="inherit",documentFeatures:{layouts:[],dividers:"inherit"===t.dividers&&e.dividers,formatting:{alignment:(null==(o=t.formatting)?void 0:o.alignment)==="inherit"?e.formatting.alignment:{center:!1,end:!1},blockTypes:(null==(a=t.formatting)?void 0:a.blockTypes)==="inherit"?e.formatting.blockTypes:{blockquote:!1,code:!1},headings:"inherit"===u?e.formatting.headings:{levels:u?e.formatting.headings.levels.filter(e=>u.includes(e)):[],schema:e.formatting.headings.schema},listTypes:(null==(l=t.formatting)?void 0:l.listTypes)==="inherit"?e.formatting.listTypes:{ordered:!1,unordered:!1}},links:"inherit"===t.links,images:"inherit"===t.images&&e.images,tables:"inherit"===t.tables},componentBlocks:"inherit"===t.componentBlocks}}function nK(e,t,n){return function e(t,n,r){if(0===t.length)return r;if("child"!==r.kind&&"form"!==r.kind){if("conditional"===r.kind){let i=t.shift();if("discriminant"===i)return e(t,n.discriminant,r.discriminant);if("value"===i){let i=r.values[n.discriminant];return e(t,n.value,i)}return}if("object"===r.kind){let i=t.shift();return e(t,n[i],r.fields[i])}if("array"===r.kind){let i=t.shift();return e(t,n[i],r.element)}(0,z.xb)(r)}}([...e],t,{kind:"object",fields:n})}function nq(e,t,n){let r=[],i=[...t],o=e,a=n;for(;i.length;){r.push(o);let e=i.shift();if("array"===o.kind)o=o.element,a=a[e];else if("conditional"===o.kind)o=o.values[n.discriminant],a=a.value;else if("object"===o.kind)a=a[e],o=o.fields[e];else if("child"===o.kind||"form"===o.kind)throw Error(`unexpected prop "${e}"`);else(0,z.xb)(o)}return r}function nG(e,t,n){let r=nK(e,n,t);return(null==r?void 0:r.kind)==="child"&&("block"===r.options.kind&&"modal"!==r.options.editIn||"inline"===r.options.kind)?r.options.placeholder:""}function nJ(e){return R.Hg.isElement(e)?{...e,children:e.children.map(nJ)}:{...e}}let nV=["bold","italic","underline","strikethrough","code","superscript","subscript","keyboard"],nX=(e,t)=>{let[n]=R.KE.nodes(e,{match:e=>e.type===t});return!!n};function nQ(e){R.gB.unwrapNodes(e,{match:e=>"heading"===e.type||"blockquote"===e.type||"code"===e.type}),R.gB.unsetNodes(e,nV,{match:R.EY.isText})}function nZ(e,t,n,r=()=>!0){let i=R.wA.isPath(t)?t:t[1],o=R.wA.isPath(t)?R.bP.get(e,i):t[0];if(nD(o)){for(let t=o.children.length-1;t>=0;t--)if(r(o.children[t],t)){let r=[...i,t];R.gB.moveNodes(e,{at:r,to:n})}}}function n0(e,t,{distance:n=1}={}){let r,i=R.KE.point(e,t,{edge:"end"}),o=R.KE.end(e,[]),a=0;for(let t of R.KE.positions(e,{at:{anchor:i,focus:o}})){if(a>n)break;R.bP.get(e,t.path).text.length!==t.offset&&(0!==a&&(r=t),a++)}return r}function n1(...e){if(1===e.length){let t=e[0];return e=>e.type===t}let t=new Set(e);return e=>"string"==typeof e.type&&t.has(e.type)}function n2(e,t,n){let r=R.KE.above(e,{match:n1("component-block-prop","component-inline-prop")});if(r){let i=r[0].propPath,o=R.KE.parent(e,r[1]);if("component-block"===o[0].type){let e=n[o[0].component];if(e&&i){let n=nK(i,o[0].props,e.schema);if((null==n?void 0:n.kind)==="child")return nY(t,n.options)}}}}let n3=(0,p.createContext)(null);function n4(){let e=(0,p.useContext)(n3);if(!e)throw Error("useBlockPopoverContext must be used within a BlockPopoverTrigger");return e}let n6=n1("code","component-block","image","layout","link","table","heading"),n5=(0,p.createContext)(void 0);function n8(){return(0,p.useContext)(n5)}function n7(e){let t=R.KE.above(e.editor,{match:n6});return(0,N.jsx)(n5.Provider,{value:null==t?void 0:t[0],children:e.children})}let n9=({children:e,element:t})=>{let[n,r]=e,i=n8(),o=(0,p.useRef)(null),a=(0,f.T)({isOpen:i===t}),l=(0,p.useMemo)(()=>({state:a,triggerRef:o}),[a,o]);return(0,N.jsxs)(n3.Provider,{value:l,children:[(0,p.cloneElement)(n,{ref:o}),r]})};function re(e){let{state:t}=n4(),n=(0,p.useRef)(null);return(0,N.jsx)(U.hJ,{isOpen:t.isOpen,nodeRef:n,children:(0,N.jsx)(rt,{wrapperRef:n,...e})})}let rt=({children:e,placement:t="bottom"})=>{let n=(0,p.useRef)(null),{state:r,triggerRef:i}=n4(),{placement:o,popoverProps:a}=function(e,t){var n,r;let i,{triggerRef:o,popoverRef:a,isNonModal:l,isKeyboardDismissDisabled:s,...c}=e,[d,u]=(0,p.useState)(!1),{overlayProps:h,underlayProps:f}=(0,_.e)({isOpen:t.isOpen,onClose:t.close,shouldCloseOnBlur:!0,isDismissable:!l,isKeyboardDismissDisabled:!1},a);(0,p.useEffect)(()=>{if(t.isOpen){let e=()=>{var e,t;let n=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),r=null==(e=a.current)?void 0:e.getBoundingClientRect(),i=null==(t=o.current)?void 0:t.getBoundingClientRect();r&&i&&u(i.bottom+r.height+16>n&&i.top<n)};return e(),window.addEventListener("scroll",e),()=>{e(),window.removeEventListener("scroll",e)}}},[a,o,t.isOpen]);let{overlayProps:m,arrowProps:g,placement:v,updatePosition:w}=(0,B.v)({...c,containerPadding:8,shouldFlip:!1,targetRef:o,overlayRef:a,isOpen:t.isOpen,onClose:void 0}),y=(r=null==(n=o.current)?void 0:n.getBoundingClientRect(),i=(0,p.useRef)(void 0),(0,p.useEffect)(()=>{i.current=r}),i.current);return(0,T.N)(()=>{if(y){var e;let t=null==(e=o.current)?void 0:e.getBoundingClientRect();t&&(y.height!==t.height||y.width!==t.width||y.x!==t.x||y.y!==t.y)&&w()}},[y,o,w]),m.style&&(m.style.zIndex=1),d&&(m.style={...m.style,maxHeight:null,position:"fixed",top:null,bottom:8}),{arrowProps:g,placement:v,popoverProps:(0,H.v)(h,m),underlayProps:f,updatePosition:w}}({isNonModal:!0,isKeyboardDismissDisabled:!1,placement:t,triggerRef:i,popoverRef:n},r);return(0,N.jsx)("div",{ref:n,...a,"data-open":r.isOpen,"data-placement":o,contentEditable:!1,className:(0,I.AH)({backgroundColor:I.Bk.color.background.surface,borderRadius:I.Bk.size.radius.medium,border:`${I.Bk.size.border.regular} solid ${I.Bk.color.border.emphasis}`,boxSizing:"content-box",minHeight:I.Bk.size.element.regular,minWidth:I.Bk.size.element.regular,opacity:0,outline:0,pointerEvents:"auto",position:"absolute",filter:`drop-shadow(0 1px 4px ${I.Bk.color.shadow.regular})`,willChange:"filter",userSelect:"none",'&[data-placement="top"]':{marginBottom:I.Bk.size.space.regular,transform:`translateY(${I.Bk.size.space.regular})`},'&[data-placement="bottom"]':{marginTop:I.Bk.size.space.regular,transform:`translateY(calc(${I.Bk.size.space.regular} * -1))`},'&[data-open="true"]':{opacity:1,transform:"translateX(0) translateY(0)",transition:(0,I.kY)(["opacity","transform"],{easing:"easeOut"})}}),children:"function"==typeof e?e(r.close):e})},rn=(0,p.forwardRef)(function({className:e,...t},n){return(0,N.jsx)("div",{...t,ref:n,className:[(0,I.AH)({userSelect:"none",whiteSpace:"initial"}),e].join(" "),contentEditable:!1})}),rr=g.NW({src:g.Yj(),width:g.ai(),height:g.ai()});function ri(e){try{let t=JSON.parse(e);if("object"==typeof t&&null!==t&&"src"in t&&"string"==typeof t.src)return{src:t.src,alt:"alt"in t&&"string"==typeof t.alt?t.alt:"",height:"height"in t&&"number"==typeof t.height&&Number.isInteger(t.height)?t.height:void 0,width:"width"in t&&"number"==typeof t.width&&Number.isInteger(t.width)?t.width:void 0}}catch(e){}let t=e.match(/^\s*!\[(.*)\]\(([a-z0-9_\-/:.]+)\)\s*$/);return t?{src:t[2],alt:t[1]}:{src:e,alt:""}}function ro(e){return new Promise((t,n)=>{let r=new Image;r.onload=()=>{t({width:r.width,height:r.height})},r.onerror=()=>{n()},r.src=e})}let ra=g.NW({src:g.Yj(),alt:g.Yj(),width:g.ai(),height:g.ai()});async function rl(e,t){let n=tm(t);if(n){let t=await fetch(`${ts}/v1/image?${new URLSearchParams({url:e})}`,{headers:{Authorization:`Bearer ${n.accessToken}`,...tc}});if(t.ok){let e=await t.json();try{return ra.create(e)}catch{}}}return ro(e).then(t=>({src:e,alt:"",...t}))}function rs(e){let t,n,r,i,o,a,l,s,c,d,u,f,m,g,w,j,S,P=(0,h.c)(42),E=function(e){let t,n,r,i=(0,h.c)(4);i[0]===Symbol.for("react.memo_cache_sentinel")?(t={},i[0]=t):t=i[0];let[o,a]=(0,p.useState)(t);return i[1]!==e?(n=()=>{let t;return e&&function(e){try{return new URL(e),!0}catch{return!1}}(e)?(t=!0,ro(e).then(e=>{t&&a(e)}),()=>{t=!1}):void a({})},r=[e],i[1]=e,i[2]=n,i[3]=r):(n=i[2],r=i[3]),(0,p.useEffect)(n,r),o}(e.src),[I,R]=(0,p.useState)(!0),_=`Revert to original (${E.width} \xd7 ${E.height})`,B=E.width===e.image.width&&E.height===e.image.height;P[0]===Symbol.for("react.memo_cache_sentinel")?(t={maximumFractionDigits:0},P[0]=t):t=P[0],P[1]!==I||P[2]!==e?(n=t=>{I?e.onChange({width:t,height:Math.round(t/rf(e.image))}):e.onChange({width:t})},P[1]=I,P[2]=e,P[3]=n):n=P[3],P[4]!==e.image.width||P[5]!==n?(r=(0,N.jsx)($.o,{label:"Width",width:"scale.1600",formatOptions:t,value:e.image.width,onChange:n}),P[4]=e.image.width,P[5]=n,P[6]=r):r=P[6],P[7]===Symbol.for("react.memo_cache_sentinel")?(i=()=>{R(e=>!e)},P[7]=i):i=P[7];let A=I?b.A:k.J;P[8]!==A?(o=(0,N.jsx)(y.I,{src:A}),P[8]=A,P[9]=o):o=P[9],P[10]!==I||P[11]!==o?(a=(0,N.jsx)(v.ff,{isSelected:I,"aria-label":"Constrain proportions",prominence:"low",onPress:i,children:o}),P[10]=I,P[11]=o,P[12]=a):a=P[12],P[13]===Symbol.for("react.memo_cache_sentinel")?(l=(0,N.jsx)(M.m,{children:"Constrain proportions"}),P[13]=l):l=P[13],P[14]!==a?(s=(0,N.jsxs)(M.k,{children:[a,l]}),P[14]=a,P[15]=s):s=P[15],P[16]===Symbol.for("react.memo_cache_sentinel")?(c={maximumFractionDigits:0},P[16]=c):c=P[16],P[17]!==I||P[18]!==e?(d=t=>{I?e.onChange({height:t,width:Math.round(t*rf(e.image))}):e.onChange({height:t})},P[17]=I,P[18]=e,P[19]=d):d=P[19],P[20]!==e.image.height||P[21]!==d?(u=(0,N.jsx)($.o,{label:"Height",width:"scale.1600",formatOptions:c,value:e.image.height,onChange:d}),P[20]=e.image.height,P[21]=d,P[22]=u):u=P[22];let F=B||!E.width||!E.height;return P[23]!==e||P[24]!==E.height||P[25]!==E.width?(f=()=>{e.onChange({height:E.height,width:E.width})},P[23]=e,P[24]=E.height,P[25]=E.width,P[26]=f):f=P[26],P[27]===Symbol.for("react.memo_cache_sentinel")?(m=(0,N.jsx)(y.I,{src:x.u}),P[27]=m):m=P[27],P[28]!==_||P[29]!==F||P[30]!==f?(g=(0,N.jsx)(v.rA,{"aria-label":_,isDisabled:F,onPress:f,children:m}),P[28]=_,P[29]=F,P[30]=f,P[31]=g):g=P[31],P[32]!==_?(w=(0,N.jsx)(M.m,{maxWidth:"100%",children:_}),P[32]=_,P[33]=w):w=P[33],P[34]!==g||P[35]!==w?(j=(0,N.jsxs)(M.k,{children:[g,w]}),P[34]=g,P[35]=w,P[36]=j):j=P[36],P[37]!==r||P[38]!==s||P[39]!==u||P[40]!==j?(S=(0,N.jsxs)(C.zt,{gap:"regular",alignItems:"end",children:[r,s,u,j]}),P[37]=r,P[38]=s,P[39]=u,P[40]=j,P[41]=S):S=P[41],S}let rc={src:"",alt:""},rd=["jpeg","jpg","png","gif","webp"].map(e=>`image/${e}`);function ru(e){var t;let n,r,i,o,a=(0,h.c)(12);if(a[0]!==e){let{onUploaded:t,...r}=e;n=r,a[0]=e,a[1]=n}else n=a[1];let l=nk(),[s,c]=(0,p.useState)(!1);if(!(null!=(t=l.cloud)&&t.project))return null;a[2]!==l||a[3]!==e?(r=async t=>{let n=Array.from(t||[]);if(n[0]){c(!0);try{let t=await function(e,t){if(e.size>1e7)throw Error("Images must be smaller than 10MB");let n=tm(t);if(!n)throw Error("You must be signed in to upload images");let r=/(.+)\.(png|jpe?g|gif|webp)$/.exec(e.name);if(!r)throw Error("Invalid image type, only PNG, JPEG, GIF, and WebP are supported");let i=r[1].toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g," ").trim().replace(/[\s-]+/g,"-"),o=r[2],a=`${i}.${o}`,l=new File([e],a,{type:`image/${"jpg"===a?"jpeg":a}`}),s=new FormData;return s.set("image",l,a),(async()=>{let e,t=await fetch(`${ts}/v1/image`,{method:"PUT",headers:{Authorization:`Bearer ${n.accessToken}`,...tc},body:s});if(!t.ok)throw Error(`Failed to upload image: ${await t.text()}`);let r=await t.json();try{e=rr.create(r)}catch{throw Error("Unexpected response from cloud")}return e})()}(n[0],l);e.onUploaded({...t,alt:""}),c(!1)}catch(e){c(!1),P.n.critical(e.message)}}},a[2]=l,a[3]=e,a[4]=r):r=a[4];let d=s?"Uploading":"Upload";return a[5]!==s||a[6]!==n||a[7]!==d?(i=(0,N.jsx)(v.rA,{isDisabled:s,...n,children:d}),a[5]=s,a[6]=n,a[7]=d,a[8]=i):i=a[8],a[9]!==r||a[10]!==i?(o=(0,N.jsx)(w.FS,{acceptedFileTypes:rd,onSelect:r,children:i}),a[9]=r,a[10]=i,a[11]=o):o=a[11],o}function rh(){let e=function(e){var t;if(!(null!=(t=e.cloud)&&t.project))return;let[n,r]=e.cloud.project.split("/");return{team:n,project:r}}(nk());return e?`https://keystatic.cloud/teams/${e.team}/project/${e.project}/images`:"https://keystatic.cloud/"}function rf(e){return e.width&&e.height?e.width/e.height:1}class rp extends Error{constructor(e){super(e),this.name="FieldDataError"}}function rm(e,t,n){if(null===e&&null!=t&&t.isRequired)throw new rp(`${n} is required`)}function rg(e){return{kind:"form",Input:e.Input,defaultValue:e.defaultValue,parse:e.parse,serialize:e.serialize,validate:e.validate,reader:{parse:t=>e.validate(e.parse(t))},label:e.label}}function rv(e,t){return e.length===t.length&&e.every((e,n)=>e===t[n])}function rw([e,t],n,r,i){let o=Object.keys(e).filter(e=>"text"!==e&&"insertMenu"!==e&&!0!==r[e]);if(o.length)return R.gB.unsetNodes(n,o,{at:t}),!0;if(!i&&e.text.includes("\n")){let[e]=R.KE.parent(n,t);if("code"!==e.type){for(let e of R.KE.positions(n,{at:t}))if("\n"===R.bP.get(n,e.path).text[e.offset])return R.gB.delete(n,{at:e}),!0}}return!1}function ry([e,t],n,r){return"link"===e.type&&!r&&(R.gB.insertText(n,` (${e.href})`,{at:R.KE.end(n,t)}),R.gB.unwrapNodes(n,{at:t}),!0)}function rb([e,t],n,{formatting:r,dividers:i,layouts:o,links:a,images:l,tables:s}){return("heading"!==e.type||r.headings.levels.length&&r.headings.levels.includes(e.level))&&("ordered-list"!==e.type||r.listTypes.ordered)&&("unordered-list"!==e.type||r.listTypes.unordered)&&("code"!==e.type||r.blockTypes.code)&&("blockquote"!==e.type||r.blockTypes.blockquote)&&("image"!==e.type||l)&&("table"!==e.type||s)&&("layout"!==e.type||0!==o.length&&o.some(t=>rv(t,e.layout)))?("paragraph"===e.type||"heading"===e.type)&&(!r.alignment.center&&"center"===e.textAlign||!r.alignment.end&&"end"===e.textAlign||"textAlign"in e&&"center"!==e.textAlign&&"end"!==e.textAlign)?(R.gB.unsetNodes(n,"textAlign",{at:t}),!0):"divider"!==e.type||i?ry([e,t],n,a):(R.gB.removeNodes(n,{at:t}),!0):(R.gB.unwrapNodes(n,{at:t}),!0)}function rk(e,t){let{normalizeNode:n}=t;return t.normalizeNode=([r,i])=>{R.EY.isText(r)?rw([r,i],t,e.formatting.inlineMarks,e.formatting.softBreaks):R.Hg.isElement(r)&&rb([r,i],t,e),n([r,i])},t}function rx(e){let t=tO(),n=tZ(),r=ed(),i=tW(),o=(0,p.useMemo)(()=>{if(!t||"loading"===t||!n)return[];let o=[];for(let[n,a]of i)n!==t.awareness.clientID&&a.user&&r.href===`/keystatic/branch/${a.branch}/${a.location}`&&Array.isArray(a.path)&&rv(a.path,e.path)&&o.push(a.user);return o},[t,n,i,r.href,e.path]);return(0,N.jsxs)("div",{"data-ks-path":JSON.stringify(e.path),onFocus:n=>{n.target.closest("[data-ks-path]")===n.currentTarget&&t&&"loading"!==t&&t.awareness.setLocalStateField("path",e.path)},children:[!!o.length&&(0,N.jsx)("div",{className:(0,I.AH)({position:"relative",width:"100%",height:0}),children:(0,N.jsx)("div",{className:(0,I.AH)({position:"absolute",top:0,right:0,display:"flex",gap:"0.5em"}),children:o.map((e,t)=>(0,N.jsx)(el.e,{size:"xsmall",src:e.avatarUrl,name:e.name},t))})}),e.children]})}function rC(e){let t,n,r,i=(0,h.c)(9),o=(0,p.useContext)(rS),a=nk();i[0]!==o||i[1]!==e.part?(n=o.concat(e.part),i[0]=o,i[1]=e.part,i[2]=n):n=i[2],t=n,i[3]!==t||i[4]!==e.children?(r=(0,N.jsx)(rS.Provider,{value:t,children:e.children}),i[3]=t,i[4]=e.children,i[5]=r):r=i[5];let l=r;if("cloud"===a.storage.kind){let e;return i[6]!==t||i[7]!==l?(e=(0,N.jsx)(rx,{path:t,children:l}),i[6]=t,i[7]=l,i[8]=e):e=i[8],e}return l}let rj=(0,p.createContext)(void 0),r$=rj.Provider,rS=(0,p.createContext)([]),rP=rS.Provider;function rM(e,t,n,r,i,o){if(e.length<t)if(1===t)return`${r} must not be empty`;else return`${r} must be at least ${t} characters long`;if(e.length>n)return`${r} must be no longer than ${n} characters`;if(o&&!o.regex.test(e))return o.message||`${r} must match the pattern ${o.regex}`;if(i){if(""===e)return`${r} must not be empty`;if(".."===e)return`${r} must not be ..`;if("."===e)return`${r} must not be .`;if("**"===i.glob){let t=e.split("/");if(t.some(e=>".."===e))return`${r} must not contain ..`;if(t.some(e=>"."===e))return`${r} must not be .`}if(("*"===i.glob?/[\\/]/:/[\\]/).test(e))return`${r} must not contain slashes`;if(/^\s|\s$/.test(e))return`${r} must not start or end with spaces`;if(i.slugs.has(e))return`${r} must be unique`}}function rE(e){let t,n,r,i=(0,h.c)(15),o=e.multiline?S.fs:S.A_,[a,l]=(0,p.useState)(!1),s=(0,p.useContext)(rj),c=(0,p.useContext)(rS);i[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>l(!0),i[0]=t):t=i[0];let d=e.min>0;return i[1]!==e||i[2]!==a||i[3]!==c||i[4]!==s?(n=e.forceValidation||a?rM(e.value,e.min,e.max,e.label,1===c.length&&(null==s?void 0:s.field)===c[0]?s:void 0,e.pattern):void 0,i[1]=e,i[2]=a,i[3]=c,i[4]=s,i[5]=n):n=i[5],i[6]!==o||i[7]!==e.label||i[8]!==e.description||i[9]!==e.autoFocus||i[10]!==e.value||i[11]!==e.onChange||i[12]!==d||i[13]!==n?(r=(0,N.jsx)(o,{label:e.label,description:e.description,autoFocus:e.autoFocus,value:e.value,onChange:e.onChange,onBlur:t,isRequired:d,errorMessage:n}),i[6]=o,i[7]=e.label,i[8]=e.description,i[9]=e.autoFocus,i[10]=e.value,i[11]=e.onChange,i[12]=d,i[13]=n,i[14]=r):r=i[14],r}function rI(e){if(void 0===e)return"";if("string"!=typeof e)throw new rp("Must be a string");return e}let rR=new Set;function r_({label:e,defaultValue:t="",validation:{length:{max:n=1/0,min:r=0}={},pattern:i,isRequired:o}={},description:a,multiline:l=!1}){function s(t,o){let a=rM(t,r,n,e,o,i);if(void 0!==a)throw new rp(a);return t}return r=Math.max(+!!o,r),{kind:"form",formKind:"slug",label:e,Input:t=>(0,N.jsx)(rE,{label:e,description:a,min:r,max:n,multiline:l,pattern:i,...t}),defaultValue:()=>"string"==typeof t?t:t(),parse:(e,t)=>(null==t?void 0:t.slug)!==void 0?t.slug:rI(e),serialize:e=>({value:""===e?void 0:e}),serializeWithSlug:e=>({slug:e,value:void 0}),reader:{parse:e=>s(rI(e),void 0),parseWithSlug:(e,t)=>(s(rI(t.slug),{glob:t.glob,slugs:rR}),null)},validate:(e,t)=>s(e,null==t?void 0:t.slugField)}}}}]);