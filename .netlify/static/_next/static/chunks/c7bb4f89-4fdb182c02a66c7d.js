"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7518],{14705:(e,t,n)=>{n.d(t,{Q:()=>tB});var a=n(22465),i=n(12115),r=n(89613),l=n(2498),o=n(63637),s=n(62210),c=n(91441),d=n(88350),u=n(45668),h=n(62452),m=n(43391),f=n(82309),g=n(3581),p=n(81489),b=n(25026),y=n(79766),j=n(40349),x=n(52983),v=n(29101),w=n(21050),k=n(64149),S=n(92464),C=n(21307),$=n(80246),_=n(95155),P=n(76941);n(33185);var I=n(88711);n(82849),n(16945);var E=n(420);n(32669);var F=n(37753);n(4192),n(67998);var R=n(28925),U=n(47005);n(90974),n(6208),n(18509),n(41865),n(37712),n(96156);var T=n(22621);n(11304),n(89930),n(15921),n(44381),n(20274),n(47188),n(89290);var A=n(93427),D=n(75127),L=n(46765),O=n(21477),K=n(73199),z=n(57383),B=n(3947),H=n(87338),Y=n(41036),N=n(42218),M=n(26496),W=n(62174),q=n(89191),G=n(75038),V=n(56593),J=n(40517),Q=n(41699),Z=n(65278),X=n(60196),ee=n(97157),et=n(1828),en=n(99793),ea=n(96069),ei=n(425),er=n(66317),el=n(52762),eo=n(49315),es=n(2509),ec=n(33017),ed=n(83305),eu=n(3761);n(67807),n(21286),n(41662),n(48640),n(18033),n(17177),n(30728),n(93145),n(29305),n(45926),n(9306),n(95873),n(11754),n(93960),n(8525),n(48878),n(80459),n(79588),n(61337),n(59122),n(29695),n(96297),n(78488),n(35180),n(18615),n(14697),n(88911),n(76080),n(76719),n(23238),n(95006),n(51225),n(86237),n(45542),n(50411),n(48693),n(58252),n(8585),n(92469),n(84526),n(36893),n(91032),n(18545),n(26153),n(17467),n(94370),n(59010),n(47214),n(51543),n(76336),n(47512),n(47650),n(48474),n(27707),n(28734),n(90945),n(42213),n(50093),n(16366);let eh=new Intl.Collator(void 0,{sensitivity:"base"});function em(e){let t,n,i,r=(0,a.c)(5);return r[0]===Symbol.for("react.memo_cache_sentinel")?(t={mobile:"medium",tablet:"xlarge",desktop:"xxlarge"},r[0]=t):t=r[0],r[1]!==e?(n="children"in e?e.children:(0,_.jsxs)(_.Fragment,{children:[e.icon&&(0,_.jsx)(l.I,{src:e.icon,size:"large",color:"neutralEmphasis"}),e.title&&(0,_.jsx)(d.DZ,{align:"center",size:"medium",children:e.title}),e.message&&(0,_.jsx)(d.EY,{align:"center",children:e.message}),e.actions]}),r[1]=e,r[2]=n):n=r[2],r[3]!==n?(i=(0,_.jsx)(c.so,{alignItems:"center",direction:"column",gap:"large",justifyContent:"center",minHeight:"scale.3000",paddingX:t,children:n}),r[3]=n,r[4]=i):i=r[4],i}class ef extends Error{constructor(){super("Not found"),this.name="NotFoundError"}}function eg(e){return"object"==typeof e&&null!==e&&e instanceof ef}function ep(){throw new ef}class eb extends i.Component{constructor(e){super(e),this.state={notFound:!1,lastHref:e.href}}static getDerivedStateFromError(e){if(eg(e))return{notFound:!0};throw e}static getDerivedStateFromProps(e,t){return e.href!==t.lastHref&&t.notFound?{notFound:!1,lastHref:e.href}:{notFound:t.notFound,lastHref:e.href}}render(){return this.state.notFound?this.props.fallback:this.props.children}}function ey(e){let t,n=(0,a.c)(3),i=(0,$.u)();return n[0]!==e||n[1]!==i.href?(t=(0,_.jsx)(eb,{...e,href:i.href}),n[0]=e,n[1]=i.href,n[2]=t):t=n[2],t}class ej extends Map{#e;constructor(e,t){super(t),this.#e=e}get(e){return this.#e(e),super.get(e)}}function ex(e,t){let n,a=(0,$.g)(e.dirpath,e.format),i=t.get(a);if(!i)throw Error(`Could not find data file at ${a}`);let{loaded:r,extraFakeFile:l}=(0,A.l)(i,e.format,e.requireFrontmatter),o=new Map(t);l&&o.set(`${e.dirpath}/${l.path}`,l.contents);let s=new Set([a]),c=(0,$.o)(e.schema),d=e=>(s.add(e),o.get(e));try{n=(0,C.p)(c,r,[],[],(t,n,a,i)=>{var r,l,c,u,h,m;if(1===a.length&&a[0]===(null==(r=e.slug)?void 0:r.field)){if("slug"!==t.formKind)throw Error("slugField is not a slug field");return t.parse(n,{slug:e.slug.slug})}if("asset"===t.formKind){let a=i.join("/"),r=t.filename(n,{suggestedFilenamePrefix:a,slug:null==(l=e.slug)?void 0:l.slug}),o=r?d(`${t.directory?`${t.directory}${(null==(c=e.slug)?void 0:c.slug)===void 0?"":`/${e.slug.slug}`}`:e.dirpath}/${r}`):void 0;return t.parse(n,{asset:o,slug:null==(u=e.slug)?void 0:u.slug})}if("content"===t.formKind||"assets"===t.formKind){let a=`${e.dirpath}/${i.join("/")}`,{external:r,other:l}=((t,n)=>{let a=new ej(e=>{s.add(`${t}/${e}`)}),i=new Map;for(let[e]of o)if(e.startsWith(t+"/")){let n=e.slice(t.length+1);a.set(n,o.get(e))}for(let t of null!=(r=n.directories)?r:[]){var r,l,c;let n=new ej(e=>s.add(a+e)),a=`${t}${(null==(l=e.slug)?void 0:l.slug)===void 0?"":`/${null==(c=e.slug)?void 0:c.slug}`}/`;for(let[e,t]of o)if(e.startsWith(a)){let i=e.slice(a.length);n.set(i,t)}n.size&&i.set(t,n)}return{other:a,external:i}})(a,t);if("content"===t.formKind){let i=a+t.contentExtension,o=d(i);return t.parse(n,{content:o,other:l,external:r,slug:null==(h=e.slug)?void 0:h.slug})}if("assets"===t.formKind)return t.parse(n,{other:l,external:r,slug:null==(m=e.slug)?void 0:m.slug})}return t.parse(n,void 0)},!1)}catch(e){throw(0,C.t)(e)}return l&&s.delete(`${e.dirpath}/${l.path}`),{initialState:n,initialFiles:[...s]}}function ev(e){var t;let{current:n}=(0,$.a)(),a=(0,$.b)(),r=(0,$.c)(),l="loaded"===n.kind?n.data.tree:void 0,o=(0,i.useMemo)(()=>{var t;return(0,$.d)((0,$.o)(e.schema),e.dirpath,null==(t=e.slug)?void 0:t.slug,e.format)},[e.dirpath,e.format,e.schema,null==(t=e.slug)?void 0:t.slug]),s=(0,i.useMemo)(()=>(0,$.e)(o,null!=l?l:new Map),[o,l]),c=(0,i.useMemo)(()=>null!=l?l:new Map,[s,o]),d="loaded"===n.kind;return(0,$.f)((0,i.useCallback)(()=>{var t;if(!d)return $.L;if(void 0===(null==(t=(0,$.h)(c,(0,$.g)(e.dirpath,e.format)))?void 0:t.entry.sha))return"not-found";let n={dirpath:e.dirpath,format:e.format,schema:e.schema,slug:e.slug},i=o.flatMap(e=>{let t=(0,$.h)(c,e);return t?t.children?function e(t){return[...t.values()].flatMap(t=>t.children?e(t.children):[t.entry])}(t.children):[t.entry]:[]}).map(t=>{let n=eC(e.config,t.sha,t.path,a,r);return n instanceof Uint8Array?[t.path,n]:n.then(e=>[t.path,e])});if(i.every(e=>Array.isArray(e))){let{initialFiles:e,initialState:t}=ex(n,new Map(i));return{initialState:t,initialFiles:e,localTreeKey:s}}return Promise.all(i).then(async e=>{let{initialState:t,initialFiles:a}=ex(n,new Map(e));return{initialState:t,initialFiles:a,localTreeKey:s}})},[d,c,e.dirpath,e.format,e.config,e.schema,e.slug,o,a,r,s]))}let ew=new P.q({max:200});async function ek(e){let t=await (0,$.j)(e);return ew.set(t,e),await (0,$.s)(t,e),t}async function eS(e,t,n,a,i){if((null==i?void 0:i.isPrivate)===!1){var r;return fetch(`https://raw.githubusercontent.com/${(0,$.k)(i)}/${a}/${null!=(r=(0,$.l)(e.storage))?r:""}${n}`)}let l=await (0,$.m)(e);return fetch("github"===e.storage.kind?`https://api.github.com/repos/${(0,$.k)(e.storage.repo)}/git/blobs/${t}`:`${$.K}/v1/github/blob/${t}`,{headers:{Authorization:`Bearer ${l.accessToken}`,Accept:"application/vnd.github.raw",..."cloud"===e.storage.kind?$.n:{}}})}function eC(e,t,n,a,i){if(ew.has(t))return ew.get(t);let r=(async()=>{let r="local"===e.storage.kind;if(!r){let e=await (0,$.i)(t);if(e)return ew.set(t,e),e}return(r?fetch(`/api/keystatic/blob/${t}/${n}`,{headers:{"no-cors":"1"}}):eS(e,t,n,a,i)).then(async e=>{if(!e.ok)throw Error(`Could not fetch blob ${t} (${n}): ${e.status}
${await e.text()}`);return e.arrayBuffer()}).then(n=>{let a=new Uint8Array(n);return ew.set(t,a),"local"!==e.storage.kind&&(0,$.s)(t,a),a}).catch(e=>{throw ew.delete(t),e})})();return ew.set(t,r),r}function e$(e){var t,n;let r,l,o,s,c,d=(0,a.c)(15),{collection:u,config:h}=e,m=null==(t=h.collections)?void 0:t[u];m||ep();let f=(0,$.u)();d[0]!==f.search?(r=null!=(n=new URLSearchParams(f.search).get("search"))?n:"",d[0]=f.search,d[1]=r):r=d[1];let[g,p]=(0,i.useState)(r);d[2]!==f?(l=e=>{p(e);let t=new URLSearchParams(f.search);e?t.set("search",e):t.delete("search"),f.replace(f.pathname+"?"+t.toString())},d[2]=f,d[3]=l):l=d[3];let b=l,y=function(e,t){let n,r,l=(0,a.c)(4),o=300,[s,c]=(0,i.useState)(e);return l[0]!==e||l[1]!==o?(n=()=>{let t=setTimeout(()=>c(e),o);return()=>{clearTimeout(t)}},r=[e,o],l[0]=e,l[1]=o,l[2]=n,l[3]=r):(n=l[2],r=l[3]),(0,i.useEffect)(n,r),s}(g,300),j=`${e.basePath}/collection/${encodeURIComponent(e.collection)}/create`;return d[4]!==m.label||d[5]!==j||d[6]!==g||d[7]!==b?(o=(0,_.jsx)(e_,{collectionLabel:m.label,createHref:j,searchTerm:g,onSearchTermChange:b}),d[4]=m.label,d[5]=j,d[6]=g,d[7]=b,d[8]=o):o=d[8],d[9]!==y||d[10]!==e?(s=(0,_.jsx)(eP,{searchTerm:y,...e}),d[9]=y,d[10]=e,d[11]=s):s=d[11],d[12]!==o||d[13]!==s?(c=(0,_.jsxs)(C.P,{containerWidth:"none",children:[o,s]}),d[12]=o,d[13]=s,d[14]=c):c=d[14],c}function e_(e){let t,n,o,s,c,m,f,p,b,y,j,x,v,S,$,P,I,E,F,R,U=(0,a.c)(50),{collectionLabel:T,createHref:A}=e,D=(0,u.o)(C.s),L=(0,k.Ub)(k.C3.above.mobile),[O,K]=(0,i.useState)(L),z=(0,i.useRef)(null);U[0]!==L?(t=()=>{K(L)},n=[L],U[0]=L,U[1]=t,U[2]=n):(t=U[1],n=U[2]),(0,i.useEffect)(t,n),U[3]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{let e=e=>{if(document.activeElement!==z.current&&(0,h.v_)("mod+f",e)){var t;e.preventDefault(),null==(t=z.current)||t.select()}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},s=[],U[3]=o,U[4]=s):(o=U[3],s=U[4]),(0,i.useEffect)(o,s),U[5]!==T?(c=(0,_.jsx)(d.DZ,{elementType:"h1",id:"page-title",size:"small",flex:!0,minWidth:0,children:T}),U[5]=T,U[6]=c):c=U[6];let B=O?"block":"none";return U[7]!==B?(m={display:B},U[7]=B,U[8]=m):m=U[8],U[9]!==D?(f=D.format("search"),U[9]=D,U[10]=f):f=U[10],U[11]!==e||U[12]!==L?(p=()=>{e.onSearchTermChange(""),L||setTimeout(()=>{K(!1)},250)},U[11]=e,U[12]=L,U[13]=p):p=U[13],U[14]!==L||U[15]!==e.searchTerm?(b=()=>{L||""!==e.searchTerm||K(!1)},U[14]=L,U[15]=e.searchTerm,U[16]=b):b=U[16],U[17]!==D?(y=D.format("search"),U[17]=D,U[18]=y):y=U[18],U[19]!==z||U[20]!==f||U[21]!==e.onSearchTermChange||U[22]!==e.searchTerm||U[23]!==p||U[24]!==b||U[25]!==y?(j=(0,_.jsx)(w.L,{ref:z,"aria-label":f,onChange:e.onSearchTermChange,onClear:p,onBlur:b,placeholder:y,value:e.searchTerm,width:"scale.2400"}),U[19]=z,U[20]=f,U[21]=e.onSearchTermChange,U[22]=e.searchTerm,U[23]=p,U[24]=b,U[25]=y,U[26]=j):j=U[26],U[27]!==m||U[28]!==j?(x=(0,_.jsx)("div",{role:"search",style:m,children:j}),U[27]=m,U[28]=j,U[29]=x):x=U[29],U[30]!==O?(v=O||{above:"mobile"},U[30]=O,U[31]=v):v=U[31],U[32]===Symbol.for("react.memo_cache_sentinel")?(S=()=>{K(!0);let e=document.createElement("input");e.style.position="absolute",e.style.opacity="0",document.body.appendChild(e),e.focus(),setTimeout(()=>{var t;null==(t=z.current)||t.focus(),e.remove()},0)},U[32]=S):S=U[32],U[33]===Symbol.for("react.memo_cache_sentinel")?($=(0,_.jsx)(l.I,{src:g.q}),U[33]=$):$=U[33],U[34]!==v||U[35]!==S?(P=(0,_.jsx)(r.rA,{"aria-label":"show search",isHidden:v,onPress:S,children:$}),U[34]=v,U[35]=S,U[36]=P):P=U[36],U[37]!==O?(I=O?{below:"tablet"}:void 0,U[37]=O,U[38]=I):I=U[38],U[39]!==D?(E=D.format("add"),U[39]=D,U[40]=E):E=U[40],U[41]!==A||U[42]!==I||U[43]!==E?(F=(0,_.jsx)(r.$n,{marginStart:"auto",prominence:"high",href:A,isHidden:I,children:E}),U[41]=A,U[42]=I,U[43]=E,U[44]=F):F=U[44],U[45]!==c||U[46]!==x||U[47]!==P||U[48]!==F?(R=(0,_.jsxs)(C.a,{children:[c,x,P,F]}),U[45]=c,U[46]=x,U[47]=P,U[48]=F,U[49]=R):R=U[49],R}function eP(e){let t,n=(0,a.c)(11),i=(0,$.a)(),l="loaded"===i.merged.kind?i.merged.data.current.entries.get((0,$.p)(e.config,e.collection)):null;if("error"===i.merged.kind){let t,a;return n[0]!==e.basePath?(t=(0,_.jsx)(r.$n,{tone:"accent",href:e.basePath,children:"Dashboard"}),n[0]=e.basePath,n[1]=t):t=n[1],n[2]!==i.merged.error.message||n[3]!==t?(a=(0,_.jsx)(em,{icon:m.a,title:"Unable to load collection",message:i.merged.error.message,actions:t}),n[2]=i.merged.error.message,n[3]=t,n[4]=a):a=n[4],a}if("loading"===i.merged.kind){let e;return n[5]===Symbol.for("react.memo_cache_sentinel")?(e=(0,_.jsx)(em,{children:(0,_.jsx)(v.a3,{"aria-label":"Loading Entries",isIndeterminate:!0,size:"large"})}),n[5]=e):e=n[5],e}if(!l){let t,a=`${e.basePath}/collection/${encodeURIComponent(e.collection)}/create`;return n[6]!==a?(t=(0,_.jsx)(em,{icon:f.a,title:"Empty collection",message:(0,_.jsxs)(_.Fragment,{children:["There aren't any entries yet."," ",(0,_.jsx)(x.Y,{href:a,children:"Create the first entry"})," ","to see it here."]})}),n[6]=a,n[7]=t):t=n[7],t}return n[8]!==e||n[9]!==i.merged.data?(t=(0,_.jsx)(eF,{...e,trees:i.merged.data}),n[8]=e,n[9]=i.merged.data,n[10]=t):t=n[10],t}let eI="@@slug",eE="@@status";function eF(e){let{searchTerm:t}=e,n=(0,$.c)(),a=(0,$.q)(),r=(0,$.r)(e.config),o=(0,$.u)(),[s,c]=(0,i.useState)({column:eI,direction:"ascending"}),u=r||a===(null==n?void 0:n.defaultBranch),h=(0,$.b)(),m=e.config.collections[e.collection],f=(0,i.useMemo)(()=>{let t=new Map((0,$.t)(e.config,e.collection,e.trees.default.tree).map(e=>[e.slug,e.key]));return(0,$.t)(e.config,e.collection,e.trees.current.tree).map(e=>({name:e.slug,status:t.has(e.slug)?t.get(e.slug)===e.key?"Unchanged":"Changed":"Added",sha:e.sha}))},[e.collection,e.config,e.trees]),g=(0,$.f)((0,i.useCallback)(async()=>{var t;if(!(null!=(t=m.columns)&&t.length))return;let a=(0,$.v)(e.config,e.collection),i=await Promise.all(f.map(async t=>[t.name,await eC(e.config,t.sha,(0,$.g)((0,$.w)(e.config,e.collection,t.name),a),h,n)])),r=(0,$.x)(e.config,e.collection),l={kind:"object",fields:m.schema},o=new Map;for(let[e,t]of i)try{let{loaded:n}=(0,A.l)(t,a),i=(0,C.p)(l,n,[],[],(t,n,a)=>{if("asset"===t.formKind)return t.reader.parse(n);if("content"!==t.formKind&&"assets"!==t.formKind){if(1===a.length&&void 0!==e&&a[0]===m.slugField){if("slug"!==t.formKind)throw Error(`Slug field ${m.slugField} is not a slug field`);return t.reader.parseWithSlug(n,{slug:e,glob:r})}return t.reader.parse(n)}},!0);o.set(e,i)}catch{}return o},[m,e.config,e.collection,f,h,n])),x=(0,i.useMemo)(()=>{if("loaded"!==g.kind||!g.data)return f;let{data:e}=g;return f.map(t=>({...t,data:e.get(t.name)}))},[f,g]),v=(0,i.useMemo)(()=>x.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())),[x,t]),w=(0,i.useMemo)(()=>[...v].sort((e,t)=>{var n,a,i,r,l;let o,c=(e,t)=>{var n,a,i;return s.column===eI?null!=(a=null==(i=m.parseSlugForSort)?void 0:i.call(m,e.name))?a:e.name:s.column===eE?e.status:null!=(n=null==t?void 0:t[s.column])?n:e.name},d="loaded"===g.kind?g.data:void 0;return n=s.direction,a=c(e,null==d?void 0:d.get(e.name)),i=c(t,null==d?void 0:d.get(t.name)),o="ascending"===n?1:-1,null==a?1:null==i?-1:"string"==typeof a&&"string"==typeof i?eh.compare(a,i)*o:((r=a)<(l=i)?-1:+(r>l))*o}),[m,v,g,s.column,s.direction]),P=(0,i.useMemo)(()=>{var e;return null!=(e=m.columns)&&e.length?[...u?[]:[{name:"Status",key:eE,minWidth:32,width:32}],{name:"Slug",key:eI},...m.columns.map(e=>{let t=m.schema[e];return{name:"label"in t&&t.label||e,key:e}})]:u?[{name:"Name",key:eI}]:[{name:"Status",key:eE,minWidth:32,width:32},{name:"Name",key:eI}]},[m,u]);return(0,_.jsxs)(S.Qg,{"aria-labelledby":"page-title",selectionMode:"none",onSortChange:c,sortDescriptor:s,density:"spacious",overflowMode:"truncate",prominence:"low",onAction:t=>{var n,a,i;o.push((n=e.basePath,a=e.collection,i=t.toString().slice(4),`${n}/collection/${encodeURIComponent(a)}/item/${encodeURIComponent(i)}`))},renderEmptyState:()=>(0,_.jsx)(em,{icon:p.q,title:"No results",message:`No items matching "${t}" were found.`}),flex:!0,marginTop:{tablet:"large"},marginBottom:{mobile:"regular",tablet:"xlarge"},UNSAFE_className:(0,k.AH)({marginInline:k.Bk.size.space.regular,[k.C3.above.mobile]:{marginInline:`calc(${k.Bk.size.space.xlarge} - ${k.Bk.size.space.medium})`},[k.C3.above.tablet]:{marginInline:`calc(${k.Bk.size.space.xxlarge} - ${k.Bk.size.space.medium})`},"[role=rowheader]":{cursor:"pointer"}}),children:[(0,_.jsx)(S.A0,{columns:P,children:({name:e,key:t,...n})=>t===eE?(0,_.jsx)(S.VP,{isRowHeader:!0,allowsSorting:!0,...n,children:(0,_.jsx)(l.I,{"aria-label":"Status",src:b.P})},t):(0,_.jsx)(S.VP,{isRowHeader:!0,allowsSorting:!0,...n,children:e},t)}),(0,_.jsx)(S.BF,{items:w,children:e=>{var t;let n=(0,_.jsx)(S.fh,{textValue:e.status,children:"Added"===e.status?(0,_.jsx)(l.I,{color:"positive",src:y.B}):"Changed"===e.status?(0,_.jsx)(l.I,{color:"accent",src:j.S}):null},eE+e.name),a=(0,_.jsx)(S.fh,{textValue:e.name,children:(0,_.jsx)(d.EY,{weight:"medium",children:e.name})},eI+e.name);return null!=(t=m.columns)&&t.length?(0,_.jsx)(S.fI,{children:[...u?[]:[n],a,...m.columns.map(t=>{var n;let a;return null==(a=null==(n=e.data)?void 0:n[t])?a=void 0:a+="",(0,_.jsx)(S.fh,{textValue:a,children:(0,_.jsx)(d.EY,{weight:"medium",children:a})},t+e.name)})]},"key:"+e.name):u?(0,_.jsx)(S.fI,{children:a},"key:"+e.name):(0,_.jsxs)(S.fI,{children:[n,a]},"key:"+e.name)}})]})}function eR(e,t){if("form"===e.kind)return"content"===e.formKind&&e.collaboration?e.collaboration.toYjs(t):t;if("child"===e.kind)return null;if("object"===e.kind)return new D.T5(Object.entries(e.fields).map(([e,n])=>[e,eR(n,t[e])]));if("array"===e.kind){let n=new D.O3;return n.push(t.map(t=>eR(e.element,t))),n}if("conditional"===e.kind){let n=t.discriminant;return new D.T5([["discriminant",n],["value",eR(e.values[n+""],t.value)]])}(0,q.xb)(e)}function eU(e,t,n){if("form"===e.kind)return"content"===e.formKind&&e.collaboration?e.collaboration.fromYjs(n,t):n;if("child"===e.kind)return null;if("object"===e.kind)return Object.fromEntries(Object.entries(e.fields).map(([e,a])=>[e,eU(a,t,n.get(e))]));if("array"===e.kind){let a=n.map(n=>eU(e.element,t,n));return(0,C.b)(a,(0,C.g)(n)),a}if("conditional"===e.kind)return{discriminant:eU(e.discriminant,t,n.get("discriminant")),value:eU(e.values[n.get("discriminant")+""],t,n.get("value"))}}function eT(e,t){if("form"===e.kind||"child"===e.kind)return t;if("object"===e.kind)return new D.T5(Object.entries(e.fields).map(([e,n])=>[e,eT(n,t[e])]));if("array"===e.kind){let n=new D.O3;return n.push(t.map(t=>eT(e.element,t))),n}if("conditional"===e.kind){let n=t.discriminant;return new D.T5([["discriminant",n],["value",eT(e.values[n.toString()],t.value)]])}}let eA=(0,i.createContext)(void 0),eD=eA.Provider;function eL(e){let t,n,l,o,s,u,h,m=(0,a.c)(18),f=(0,$.u)(),g=(0,i.useContext)(eA);if(m[0]!==f.href||m[1]!==g){var p;t=null!=(p=new URL(f.href,"https://example.com").searchParams.get("slug"))?p:null==g?void 0:g.value,m[0]=f.href,m[1]=g,m[2]=t}else t=m[2];let b=t;m[3]!==e.config.storage.repo?(n=(0,$.y)(e.config.storage.repo),m[3]=e.config.storage.repo,m[4]=n):n=m[4];let y=n;return m[5]!==y.name?(l=(0,_.jsx)(T.A_,{label:"Repo Name",width:"100%",isReadOnly:!0,value:y.name}),m[5]=y.name,m[6]=l):l=m[6],m[7]!==y.name?(o=(0,_.jsx)(r.rA,{onPress:()=>{navigator.clipboard.writeText(y.name)},children:"Copy Repo Name"}),m[7]=y.name,m[8]=o):o=m[8],m[9]!==l||m[10]!==o?(s=(0,_.jsxs)(c.so,{alignItems:"end",gap:"regular",children:[l,o]}),m[9]=l,m[10]=o,m[11]=s):s=m[11],m[12]!==b||m[13]!==g?(u=b?(0,_.jsx)(r.$n,{prominence:"high",href:`https://github.com/apps/${b}/installations/new`,children:"Install GitHub App"}):(0,_.jsx)(K.$,{tone:"caution",children:g?(0,_.jsxs)(d.EY,{children:["The ",(0,_.jsx)("code",{children:g.envName})," environment variable wasn't provided so we can't link to the GitHub app installation page. You should find the App on GitHub and add the repo yourself."]}):(0,_.jsx)(d.EY,{children:"Find the App on GitHub and add the repo."})}),m[12]=b,m[13]=g,m[14]=u):u=m[14],m[15]!==s||m[16]!==u?(h=(0,_.jsxs)(c.so,{direction:"column",gap:"regular",children:[s,u]}),m[15]=s,m[16]=u,m[17]=h):h=m[17],h}function eO(e){let t=(0,u.o)(C.s),n=(0,G.tH)(),[a,l]=(0,i.useState)({kind:"idle"});(0,i.useEffect)(()=>{let t=async t=>{if("ks-refetch-installations"===t.key&&"true"===t.newValue){localStorage.removeItem("ks-refetch-installations");try{var a;if(!await (0,$.m)(e.config))throw Error("Unauthorized");null!=(a=(await n.query($.G,(0,$.y)(e.config.storage.repo)).toPromise()).data)&&null!=(a=a.repository)&&null!=(a=a.forks.nodes)&&a.some(e=>(null==e?void 0:e.viewerPermission)==="ADMIN"||(null==e?void 0:e.viewerPermission)==="WRITE"||(null==e?void 0:e.viewerPermission)==="MAINTAIN")&&(await new Promise(e=>setTimeout(e,100)),e.onCreate())}catch(e){l({kind:"error",error:e})}}};return addEventListener("storage",t),()=>removeEventListener("storage",t)},[n,e]);let o=(0,i.useContext)(eA);return(0,_.jsxs)(I.lG,{size:"small",isDismissable:!0,onDismiss:()=>{e.onDismiss()},children:[(0,_.jsx)(d.DZ,{children:"Fork Repo"}),"error"===a.kind?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(E.UC,{children:(0,_.jsx)(K.$,{tone:"critical",children:a.error.message})}),(0,_.jsx)(r.e2,{children:(0,_.jsx)(r.$n,{onPress:e.onDismiss,children:t.format("cancel")})})]}):(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(E.UC,{children:(0,_.jsxs)(c.so,{gap:"large",direction:"column",marginBottom:"large",children:[(0,_.jsx)(d.EY,{children:"You don't have permission to write to this repo so to save your changes, you need to fork the repo."}),(0,_.jsxs)(d.EY,{children:["To start,"," ",(0,_.jsx)(x.Y,{href:`https://github.com/${(0,$.k)(e.config.storage.repo)}/fork`,target:"_blank",rel:"noopener noreferrer",children:"fork the repo on GitHub"}),". Then, come back to this page and"," ",(0,_.jsx)(x.Y,{href:`https://github.com/apps/${null==o?void 0:o.value}/installations/new?state=close`,target:"_blank",rel:"noopener noreferrer",children:"install the Keystatic GitHub App on your fork."})]})]})})})]})}let eK=(0,i.memo)(e=>{let t,n,i=(0,a.c)(5);if(i[0]!==e.items){let n;i[2]===Symbol.for("react.memo_cache_sentinel")?(n=e=>(0,_.jsx)(J.q,{href:e.href,children:e.label},e.key),i[2]=n):n=i[2],t=e.items.map(n),i[0]=e.items,i[1]=t}else t=i[1];return i[3]!==t?(n=(0,_.jsx)(J.B,{flex:!0,size:"medium",minWidth:"alias.singleLineWidth",children:t}),i[3]=t,i[4]=n):n=i[4],n});function ez(e,t){let n,i,r,l=(0,a.c)(10),o=(0,$.z)(),s=(0,Q.u)(e);l[0]!==s||l[1]!==t?(n=new Set(s),t&&n.delete(t),l[0]=s,l[1]=t,l[2]=n):n=l[2];let c=o.collections[e];return l[3]!==o||l[4]!==e?(i=(0,$.x)(o,e),l[3]=o,l[4]=e,l[5]=i):i=l[5],l[6]!==c.slugField||l[7]!==n||l[8]!==i?(r={field:c.slugField,slugs:n,glob:i},l[6]=c.slugField,l[7]=n,l[8]=i,l[9]=r):r=l[9],r}function eB(){let e,t,n,i=(0,a.c)(7),r=(0,$.A)(),l=(0,$.B)(),o=(0,$.u)();return r?(i[0]!==l?(e=l.values(),i[0]=l,i[1]=e):e=i[1],i[2]!==e?(t=[...e],i[2]=e,i[3]=t):t=i[3],i[4]!==o.href||i[5]!==t?(n=(0,_.jsx)(c.zt,{children:t.map(e=>e.user&&o.href===`/keystatic/branch/${e.branch}/${e.location}`?(0,_.jsx)(Z.e,{src:e.user.avatarUrl,name:e.user.name}):null)}),i[4]=o.href,i[5]=t,i[6]=n):n=i[6],n):null}function eH(e){let t="github"===e.storage.kind?(0,$.y)(e.storage.repo):{owner:"repo-owner",name:"repo-name"};return(0,V.UU)({url:"github"===e.storage.kind?"https://api.github.com/graphql":`${$.K}/v1/github/graphql`,requestPolicy:"cache-and-network",exchanges:[(0,ea.K)(async t=>{let n=await (0,$.m)(e);return{addAuthToOperation:a=>(n=(0,$.C)(e))?t.appendHeaders(a,{Authorization:`Bearer ${n.accessToken}`,..."cloud"===e.storage.kind?$.n:{}}):a,didAuthError:()=>!1,willAuthError(t){var a;return(n=(0,$.C)(e),"OperationDefinition"===t.query.definitions[0].kind&&null!=(a=t.query.definitions[0].name)&&a.value.includes("AppShell")&&!n)?("github"===e.storage.kind?window.location.href="/api/keystatic/github/login":(0,$.D)("",e),!0):!n},async refreshAuth(){n=await (0,$.m)(e)}}}),(0,en.WG)({resolvers:{Repository:{refs:(0,er.G)()}},updates:{Mutation:{createRef(n,a,i,r){i.updateQuery({query:"github"===e.storage.kind?$.G:$.E,variables:t},e=>{var t;return null!=e&&null!=(t=e.repository)&&null!=(t=t.refs)&&t.nodes&&n.createRef&&"object"==typeof n.createRef&&"ref"in n.createRef?{...e,repository:{...e.repository,refs:{...e.repository.refs,nodes:[...e.repository.refs.nodes,n.createRef.ref]}}}:e})},deleteRef(n,a,i,r){i.updateQuery({query:"github"===e.storage.kind?$.G:$.E,variables:t},e=>{var t;if(null!=e&&null!=(t=e.repository)&&null!=(t=t.refs)&&t.nodes&&n.deleteRef&&"object"==typeof n.deleteRef&&"__typename"in n.deleteRef&&"object"==typeof a.input&&null!==a.input&&"refId"in a.input&&"string"==typeof a.input.refId){let t=a.input.refId;return{...e,repository:{...e.repository,refs:{...e.repository.refs,nodes:e.repository.refs.nodes.filter(e=>(null==e?void 0:e.id)!==t)}}}}return e})}}}}),..."github"===e.storage.kind?[]:[(0,ei.L)({enableForMutation:!0,enforcePersistedQueries:!0})],V.cI]})}function eY(e){let t,n,i,r,l,o,s,c,d,u,h,m=(0,a.c)(19),{children:f,config:g}=e,p=(0,C.u)(),{push:b}=(0,$.u)();m[0]!==b?(n={navigate:b},m[0]=b,m[1]=n):n=m[1],t=n,m[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,_.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),m[2]=i):i=m[2];let y=g.locale||"en-US";return m[3]===Symbol.for("react.memo_cache_sentinel")?(r=(0,_.jsx)(et.Wj,{bodyBackground:"surface"}),l=(0,_.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap",rel:"stylesheet"}),m[3]=r,m[4]=l):(r=m[3],l=m[4]),m[5]!==g?(s=eH(g),m[5]=g,m[6]=s):s=m[6],o=s,m[7]!==o||m[8]!==f?(c=(0,_.jsx)(G.Kq,{value:o,children:f}),m[7]=o,m[8]=f,m[9]=c):c=m[9],m[10]===Symbol.for("react.memo_cache_sentinel")?(d=(0,_.jsx)(z.l,{}),m[10]=d):d=m[10],m[11]!==y||m[12]!==p.theme||m[13]!==t||m[14]!==c?(u=(0,_.jsxs)(et.Ln,{locale:y,colorScheme:p.theme,router:t,children:[r,l,c,d]}),m[11]=y,m[12]=p.theme,m[13]=t,m[14]=c,m[15]=u):u=m[15],m[16]!==p||m[17]!==u?(h=(0,_.jsxs)(C.T,{value:p,children:[i,u]}),m[16]=p,m[17]=u,m[18]=h):h=m[18],h}(0,k.HO)({body:{overflow:"hidden"}});let eN=new TextEncoder,eM=eN.encode("---\n");function eW(e){var t,n,a,i;let{value:r,extraFiles:l}=(0,C.c)(e.state,(0,$.o)(e.schema),null==(t=e.slug)?void 0:t.field,null==(n=e.slug)?void 0:n.value,!0),o=e.format.data,s=eN.encode("json"===o?JSON.stringify(r,null,2)+"\n":(0,ee.Bh)(r));if(e.format.contentField){let t,n,r=`${e.format.contentField.path.join("/")}${e.format.contentField.contentExtension}`;l=l.filter(e=>e.path!==r||(t=e.contents,!1)),(0,R.vA)(void 0!==t,"Expected content field to be present"),a=s,i=t,(n=new Uint8Array(a.byteLength+i.byteLength+2*eM.byteLength)).set(eM),n.set(a,eM.byteLength),n.set(eM,eM.byteLength+a.byteLength),n.set(i,2*eM.byteLength+a.byteLength),s=n}return[{path:(0,$.g)(e.basePath,e.format),contents:s},...l.map(t=>({path:`${t.parent?e.slug?`${t.parent}/${e.slug.value}`:t.parent:e.basePath}/${t.path}`,contents:t.contents}))]}function eq(e){let[t,n]=(0,i.useState)({kind:"idle"}),a=(0,$.b)(),r=(0,$.q)(),l=(0,$.F)(),[,o]=(0,G.n_)(eG),s=(0,$.c)(),c=(0,i.useContext)(eA),d=(0,$.H)();return[t,async t=>{try{var i,u,h,m,f,g,p,b,y;let j="loaded"===d.kind?d.data.tree:void 0;if(!j)return!1;if("github"===e.config.storage.kind&&s&&!s.hasWritePermission&&null!=c&&c.value)return n({kind:"needs-fork"}),!1;n({kind:"loading"});let x=null!=(i=(0,$.l)(e.config.storage))?i:"",v=eW({basePath:e.basePath,schema:e.schema,format:e.format,state:e.state,slug:e.slug}).map(e=>({...e,path:x+e.path})),w=new Map(await Promise.all(v.map(async e=>[e.path,await ek(e.contents)]))),k=new Set(null==(u=e.initialFiles)?void 0:u.map(e=>x+e));for(let e of v)k.delete(e.path);v=v.filter(e=>{let t=w.get(e.path),n=(0,$.h)(j,e.path);return(null==n?void 0:n.entry.sha)!==t});let S=[...k].map(e=>({path:e})),C=await (0,$.I)(j,{additions:v,deletions:[...k]});if(await (0,$.J)(C.entries),"github"===e.config.storage.kind||"cloud"===e.config.storage.kind){if(!s)throw Error("Repo info not loaded");let i={branchName:null!=(h=null==t?void 0:t.branch)?h:r,repositoryNameWithOwner:`${s.owner}/${s.name}`},l=t=>o({input:{branch:i,expectedHeadOid:t,message:{headline:`Update ${e.basePath}`},fileChanges:{additions:v.map(e=>({...e,contents:(0,el.b)(e.contents)})),deletions:S}}}),c=await l(null!=(m=null==t?void 0:t.sha)?m:a),d=null==(f=c.error)||null==(f=f.graphQLErrors[0])?void 0:f.originalError;if(d&&"type"in d){if("BRANCH_PROTECTION_RULE_VIOLATION"===d.type)return n({kind:"needs-new-branch",reason:"Changes must be made via pull request to this branch. Create a new branch to save changes."}),!1;if("STALE_DATA"===d.type){let t=await eH(e.config).query(eV,{owner:s.owner,name:s.name,ref:`refs/heads/${r}`}).toPromise();if(!(null!=(b=t.data)&&null!=(b=b.repository)&&null!=(b=b.ref)&&b.target))throw Error("Branch not found");let a=(0,$.M)(await (0,$.N)(t.data.repository.ref.target.oid,e.config),e.config);if((0,$.e)((0,$.d)((0,$.o)(e.schema),e.basePath,null==(y=e.slug)?void 0:y.value,e.format),a.tree)!==e.currentLocalTreeKey)return n({kind:"needs-new-branch",reason:"This entry has been updated since it was opened. Create a new branch to save changes."}),!1;c=await l(t.data.repository.ref.target.oid)}}if(null!=(g=c.error)&&g.graphQLErrors.some(e=>"type"in e&&"FORBIDDEN"===e.type&&"Resource not accessible by integration"===e.message))throw Error(`The GitHub App is unable to commit to the repository. Please ensure that the Keystatic GitHub App is installed in the GitHub repository ${s.owner}/${s.name}`);if(c.error)throw c.error;if(null==(p=c.data)||null==(p=p.createCommitOnBranch)||null==(p=p.ref)?void 0:p.target)return n({kind:"updated"}),!0;throw Error("Failed to update")}{let e=await fetch("/api/keystatic/update",{method:"POST",headers:{"Content-Type":"application/json","no-cors":"1"},body:JSON.stringify({additions:v.map(e=>({...e,contents:(0,el.b)(e.contents)})),deletions:S})});if(!e.ok)throw Error(await e.text());let t=await e.json(),{tree:a}=await (0,$.J)(t);return l(await (0,$.O)(a)),n({kind:"updated"}),!0}}catch(e){return n({kind:"error",error:e}),!1}},()=>{n({kind:"idle"})}]}let eG=(0,X.Ay)`
  mutation CreateCommit($input: CreateCommitOnBranchInput!) {
    createCommitOnBranch(input: $input) {
      ref {
        id
        target {
          id
          oid
          ... on Commit {
            tree {
              id
              oid
            }
          }
        }
      }
    }
  }
`,eV=(0,X.Ay)`
  query FetchRef($owner: String!, $name: String!, $ref: String!) {
    repository(owner: $owner, name: $name) {
      id
      ref(qualifiedName: $ref) {
        id
        target {
          id
          oid
        }
      }
    }
  }
`;function eJ(e){let t,n,r,l,o=(0,a.c)(9);o[0]!==e.slugField||o[1]!==e.schema?(t=async t=>{let n=e.slugField?(0,$.P)({schema:e.schema.fields,slugField:e.slugField},t):void 0,a=(0,C.c)(t,e.schema,e.slugField,n,!0);return{slug:n,value:a.value,extraFiles:Object.fromEntries(await Promise.all(a.extraFiles.map(async e=>[JSON.stringify([e.path,e.parent]),await (0,$.j)(e.contents)])))}},o[0]=e.slugField,o[1]=e.schema,o[2]=t):t=o[2];let s=t;o[3]!==e.initialState||o[4]!==s?(n=()=>null===e.initialState?null:s(e.initialState),o[3]=e.initialState,o[4]=s,o[5]=n):n=o[5];let c=(0,$.f)(n);o[6]!==s||o[7]!==e.state?(r=()=>s(e.state),o[6]=s,o[7]=e.state,o[8]=r):r=o[8];let d=(0,$.f)(r);e:{if("loaded"===c.kind&&"loaded"===d.kind){l=!eo(c.data,d.data);break e}l="unknown"}let u=l,[h,m]=(0,i.useState)(!1);return"boolean"==typeof u&&u!==h&&m(u),h}function eQ(e,t){let n,r,l,o,s,c=(0,a.c)(14),d=(0,$.Q)();c[0]!==e||c[1]!==d.awareness||c[2]!==t?(r=eU(e,d.awareness,t),c[0]=e,c[1]=d.awareness,c[2]=t,c[3]=r):r=c[3];let u=r;c[4]!==u?(l=()=>r,c[4]=u,c[5]=l):l=c[5];let h=r;return c[6]!==h||c[7]!==e||c[8]!==d.awareness||c[9]!==t?(o=n=>{let a=()=>{r=eU(e,d.awareness,t),n()};return t.observeDeep(a),()=>{t.unobserveDeep(a)}},c[6]=h,c[7]=e,c[8]=d.awareness,c[9]=t,c[10]=o):o=c[10],c[11]!==l||c[12]!==o?(s={getSnapshot:l,subscribe:o},c[11]=l,c[12]=o,c[13]=s):s=c[13],n=s,(0,i.useSyncExternalStore)(n.subscribe,n.getSnapshot,n.getSnapshot)}function eZ(e,t,n){return(0,i.useMemo)(()=>(0,C.h)(e,t,()=>void 0),[e,t])(n)}function eX(e,t,n){let a=(0,$.Q)();return(0,i.useMemo)(()=>(function(e,t,n){let a,i={form:(e,t)=>t,array:(e,t)=>({rawOnChange:t,inner:new Map,onChange(a){let i=t.yjs(),r=eU(e,n,i),l=(0,C.g)(i),o=new Set;for(let e of a)if(void 0!==e.key){if(o.has(e.key))throw Error("Array elements must have unique keys");o.add(e.key)}let s=a.map(e=>{if(void 0!==e.key)return e.key;let t=(0,C.d)();for(;o.has(t);)t=(0,C.d)();return o.add(t),t});(0,C.b)(i,s);let c=function(e,t){let n;if(e.length!==t.length)return;let a=[...e].sort(),i=[...t].sort();if(a.join()===i.join()){for(let a=0;a<e.length;a++)if(e[a]!==t[a]){if(n===t[a])continue;if(void 0!==n)return;n=e[a]}return n}}(l,s);if(void 0!==c){let t=l.indexOf(c),n=s.indexOf(c),o=i.get(t);for(let[c,{value:d}]of(o instanceof D.lX&&(o=o.clone()),i.delete(t),i.insert(n,[o]),a.entries())){let t=l.indexOf(s[c]),n=(0,C.e)(e.element,r[t],d);n!==r&&(i.delete(t),i.insert(c,[eT(e.element,n)]))}return}if(l.join()===s.slice(0,l.length).join()){for(let[t,{value:n}]of a.entries()){let a=l.indexOf(s[t]),o=(0,C.e)(e.element,r[a],n);o!==r&&(i.delete(a),i.insert(t,[eT(e.element,o)]))}let t=[];for(let{value:n}of a.slice(l.length))t.push(eT(e.element,(0,C.f)(e.element,n)));t.length&&i.insert(l.length,t);return}let d=a.map((t,n)=>{let a=s[n],o=l.indexOf(a);if(-1!==o){let n=i.get(o);if(void 0===t.value)return n instanceof D.lX?n.clone():n;let a=(0,C.e)(e.element,r[o],t.value);return eT(e.element,a)}return eT(e.element,(0,C.f)(e.element,t.value))});i.delete(0,i.length),i.insert(0,d)}}),conditional:(e,t)=>({onChange:(a,i)=>{if(t.yjs().set("discriminant",a),void 0!==i){let r=eU(e,n,t.yjs().get("value"));t.yjs().set("value",eT(e,(0,C.e)(e.values[a.toString()],r,i)))}},onChangeForValue:Object.assign(a=>{let i=eU(e,n,t.yjs().get("value"));t.yjs().set("value",eT(e,a(i)))},{yjs:()=>t.yjs().get("value")})}),object:(e,t)=>({onChange:a=>{for(let[i,r]of Object.entries(a)){let a=eU(e.fields[i],n,t.yjs().get(i));t.yjs().set(i,eT(e.fields[i],(0,C.e)(e.fields[i],a,r)))}},innerOnChanges:Object.fromEntries(Object.entries(e.fields).map(([e,n])=>{let a=Object.assign(a=>{t.yjs().set(e,eT(n,a))},{yjs:()=>t.yjs().get(e)});return[e,a]}))})},r={form:(e,t,n)=>({value:t,onChange:n,schema:e}),object(e,t,n,a,i){let r={};for(let a of Object.keys(e.fields))r[a]=i(e.fields[a],t[a],n.innerOnChanges[a],a);return{fields:r,onChange:n.onChange,schema:e}},array(e,t,a,i,r){let l=(0,C.g)(t),o=new Set((0,C.g)(t)),s={elements:t.map((t,i)=>{var s,c;let d=l[i];o.delete(d);let u=(s=a.inner,c=()=>{let i=Object.assign(t=>{let i=a.rawOnChange.yjs(),r=(0,C.g)(i).indexOf(d),l=t(eU(e,n,i.get(r)));i.delete(r),i.insert(r,[eT(e.element,l)])},{yjs(){let e=(0,C.g)(a.rawOnChange.yjs()).indexOf(d);return a.rawOnChange.yjs().get(e)}}),l=r(e.element,t,i,d);return{element:l,elementWithKey:{...l,key:d},onChange:i}},s.has(d)||s.set(d,c(d)),s.get(d)),h=r(e.element,t,u.onChange,d);return u.element!==h&&(u.element=h,u.elementWithKey={...h,key:d}),u.elementWithKey}),schema:e,onChange:a.onChange};for(let e of o)a.inner.delete(e);return s},conditional:(e,t,n,a,i)=>({discriminant:t.discriminant,onChange:n.onChange,value:i(e.values[t.discriminant.toString()],t.value,n.onChangeForValue,"value"),schema:e})};function l(e,t,n,a,i){return r[e.kind](e,t,n,a,i)}function o(e,t,n,a){let r=new Map,s=i[e.kind](e,n);return{value:t,inner:r,props:l(e,t,s,a,(e,t,n,i)=>{let l=o(e,t,n,a.concat(i));return r.set(i,l),l.props}),schema:e,cached:s}}let s=Object.assign(n=>{let i=eT(e,n(a.value));for(let[e,n]of i.entries())i.delete(e),t.set(e,n)},{yjs:()=>t});return t=>void 0===a?(a=o(e,t,s,[])).props:function e(t,n,a,i,r){if(i.schema!==t)return Object.assign(i,o(t,n,a,r)),i.props;if(i.value===n)return i.props;i.value=n;let s=new Set(i.inner.keys());for(let a of(i.props=l(t,n,i.cached,r,(t,n,a,l)=>{if(s.delete(l),!i.inner.has(l)){let e=o(t,n,a,r.concat(l));return i.inner.set(l,e),e.props}return e(t,n,a,i.inner.get(l),r.concat(l))}),s))i.inner.delete(a);return i.props}(e,t,s,a,[])})(e,t,a.awareness),[t,e,a.awareness])(n)}function e0(e){let t,n,i,r=(0,a.c)(5),l=(0,$.z)().collections[e];return r[0]!==l.schema?(n={kind:"object",fields:l.schema},r[0]=l.schema,r[1]=n):n=r[1],t=n,r[2]!==t||r[3]!==l?(i={schema:t,collectionConfig:l},r[2]=t,r[3]=l,r[4]=i):i=r[4],i}function e1(e){let t,n,i,r=(0,a.c)(5),l=(0,$.z)().singletons[e];return r[0]!==l.schema?(n={kind:"object",fields:l.schema},r[0]=l.schema,r[1]=n):n=r[1],t=n,r[2]!==t||r[3]!==l?(i={schema:t,singletonConfig:l},r[2]=t,r[3]=l,r[4]=i):i=r[4],i}class e2 extends i.Component{constructor(e){super(e),this.state={message:null}}static getDerivedStateFromError(e){if(eg(e))throw e;return{message:String(e)}}render(){return this.state.message?"function"==typeof this.props.fallback?this.props.fallback(this.state.message):this.props.fallback:this.props.children}}let e3=L.NW({slug:L.lq(L.Yj()),files:L.g1(L.Yj(),L.au(L.KJ(Uint8Array),L.Yj(),e=>(0,el.a)(e)))}),e4=new TextDecoder;async function e5(e,t,n){let a;try{a=await navigator.clipboard.read()}catch(e){if(e instanceof DOMException&&"NotAllowedError"===e.name)return void z.n.critical("Failed to paste because clipboard access was denied",{timeout:5e3});z.n.critical("Failed to read clipboard",{timeout:5e3});return}for(let i of a){if(i.types.includes("text/html")){let a=await i.getType("text/html"),r=function(e,t,n,a){let i=new DOMParser().parseFromString(e,"text/html").querySelector("pre");if(null!=i&&i.dataset.keystaticEntry)try{var r,l;let e=JSON.parse(i.dataset.keystaticEntry),o=e3.create(e),s=new Map(Object.entries(o.files));return ex({dirpath:null!=(r=o.slug)?r:"entry",format:t,schema:n,slug:a?{field:a,slug:null!=(l=o.slug)?l:""}:void 0,requireFrontmatter:!0},s).initialState}catch{}}(await a.text(),e,t,null==n?void 0:n.field);if(r)return r}if(i.types.includes("text/plain")){let a=await i.getType("text/plain"),r=function(e,t,n,a){try{var i;let r=null!=(i=null==a?void 0:a.slug)?i:"entry";return ex({dirpath:r,format:t,schema:n,slug:a,requireFrontmatter:!0},new Map([[(0,$.g)(r,t),e]])).initialState}catch{}}(new Uint8Array(await a.arrayBuffer()),e,t,n);if(r)return r}}z.n.critical("Entry not found in clipboard",{timeout:5e3})}function e6(e,t,n,a){let i=function(e,t,n,a){var i;let r=null!=(i=null==a?void 0:a.value)?i:"entry",l=eW({basePath:r,format:t,schema:n,slug:a,state:e}),o=document.createElement("pre");o.dataset.keystaticEntry=JSON.stringify({slug:null==a?void 0:a.value,files:Object.fromEntries(l.map(e=>[e.path,(0,el.c)(e.contents)]))});let s=(0,$.g)(r,t),c=l.find(e=>e.path===s);if(!c)throw Error("No main entry file found");let d=e4.decode(c.contents);return o.textContent=d,{html:o.outerHTML,plain:d}}(e,t,n,a);navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([i.plain],{type:"text/plain"}),"text/html":new Blob([i.html],{type:"text/html"})})])}let e7=L.NW({version:L.eu(1),savedAt:L.p6(),slug:L.Yj(),beforeTreeKey:L.Yj(),files:L.Tj(L.Yj(),L.KJ(Uint8Array))});function e8(e){var t,n;let r,l,o,s,d,u,m,f,g,p,b,y,j,x,v,w,k,S,P,E,F,R,U,T,A=(0,a.c)(115),{collection:D,config:L,itemSlug:O,updateResult:B,onUpdate:H}=e,{collectionConfig:Y,schema:N}=e0(D),M=(0,$.u)(),W=(0,$.b)();A[0]!==L||A[1]!==D||A[2]!==O?(r=(0,$.w)(L,D,O),A[0]=L,A[1]=D,A[2]=O,A[3]=r):r=A[3];let q=r;A[4]!==L||A[5]!==D?(l=(0,$.v)(L,D),A[4]=L,A[5]=D,A[6]=l):l=A[6];let V=l,J=(0,$.q)(),Q=(0,$.c)(),[Z,X]=(0,i.useState)(!1);A[7]!==Y.previewUrl||A[8]!==e||A[9]!==J?(o=Y.previewUrl?Y.previewUrl.replace("{slug}",e.itemSlug).replace("{branch}",J):void 0,A[7]=Y.previewUrl,A[8]=e,A[9]=J,A[10]=o):o=A[10];let ee=o,{push:et,replace:en}=M,ea=ez(D,O);A[11]!==e.initialFiles||A[12]!==L.storage||A[13]!==q?(s={initialFiles:e.initialFiles,storage:L.storage,basePath:q},A[11]=e.initialFiles,A[12]=L.storage,A[13]=q,A[14]=s):s=A[14];let[ei,er,el]=function(e){let[t,n]=(0,i.useState)({kind:"idle"}),a=(0,$.b)(),r=(0,$.q)(),[,l]=(0,G.n_)(eG),o=(0,$.F)(),s=(0,$.c)(),c=(0,i.useContext)(eA),d=(0,$.H)();return[t,async()=>{try{let t="loaded"===d.kind?d.data.tree:void 0;if(!t)return!1;if("github"===e.storage.kind&&s&&!s.hasWritePermission&&null!=c&&c.value)return n({kind:"needs-fork"}),!1;n({kind:"loading"});let i=e.initialFiles.map(t=>{var n;return(null!=(n=(0,$.l)(e.storage))?n:"")+t}),u=await (0,$.I)(t,{additions:[],deletions:i});if(await (0,$.J)(u.entries),"github"===e.storage.kind||"cloud"===e.storage.kind){if(!s)throw Error("Repo info not loaded");let{error:t}=await l({input:{branch:{repositoryNameWithOwner:`${s.owner}/${s.name}`,branchName:r},message:{headline:`Delete ${e.basePath}`},expectedHeadOid:a,fileChanges:{deletions:i.map(e=>({path:e}))}}});if(null!=t&&t.graphQLErrors.some(e=>"type"in e&&"FORBIDDEN"===e.type&&"Resource not accessible by integration"===e.message))throw Error(`The GitHub App is unable to commit to the repository. Please ensure that the Keystatic GitHub App is installed in the GitHub repository ${s.owner}/${s.name}`);if(t)throw t;return n({kind:"updated"}),!0}{let e=await fetch("/api/keystatic/update",{method:"POST",headers:{"Content-Type":"application/json","no-cors":"1"},body:JSON.stringify({additions:[],deletions:i.map(e=>({path:e}))})});if(!e.ok)throw Error(await e.text());let t=await e.json(),{tree:a}=await (0,$.J)(t);return o(await (0,$.O)(a)),n({kind:"updated"}),!0}}catch(e){n({kind:"error",error:e})}},()=>{n({kind:"idle"})}]}(s);A[15]!==er||A[16]!==et||A[17]!==e.basePath||A[18]!==D?(d=async()=>{await er()&&et(`${e.basePath}/collection/${encodeURIComponent(D)}`)},A[15]=er,A[16]=et,A[17]=e.basePath,A[18]=D,A[19]=d):d=A[19];let eo=(0,$.W)(d);A[20]!==et||A[21]!==e.basePath||A[22]!==D||A[23]!==O?(u=()=>{et(`${e.basePath}/collection/${encodeURIComponent(D)}/create?duplicate=${O}`)},A[20]=et,A[21]=e.basePath,A[22]=D,A[23]=O,A[24]=u):u=A[24];let es=u,ec="loading"===B.kind||!e.hasChanged;A[25]!==ec||A[26]!==N||A[27]!==e.state||A[28]!==e.basePath||A[29]!==ea||A[30]!==Y||A[31]!==H||A[32]!==O||A[33]!==en||A[34]!==D?(m=async()=>{if(ec)return!1;if(!(0,C.m)(N,e.state,ea))return X(!0),!1;let t=(0,$.P)(Y,e.state),n=await H();return n&&t!==O&&en(`${e.basePath}/collection/${encodeURIComponent(D)}/item/${encodeURIComponent(t)}`),n},A[25]=ec,A[26]=N,A[27]=e.state,A[28]=e.basePath,A[29]=ea,A[30]=Y,A[31]=H,A[32]=O,A[33]=en,A[34]=D,A[35]=m):m=A[35];let ed=(0,$.W)(m);A[36]!==e.state||A[37]!==V||A[38]!==Y?(f=()=>{e6(e.state,V,Y.schema,{field:Y.slugField,value:(0,$.P)(Y,e.state)})},A[36]=e.state,A[37]=V,A[38]=Y,A[39]=f):f=A[39];let eu=(0,$.W)(f);A[40]!==V||A[41]!==Y||A[42]!==e.state||A[43]!==e.previewProps?(g=async()=>{let t=await e5(V,Y.schema,{field:Y.slugField,slug:(0,$.P)(Y,e.state)});t&&((0,C.n)(t,e.previewProps),z.n.positive("Entry pasted",{shouldCloseOnAction:!0,actionLabel:"Undo",onAction:()=>{(0,C.n)(e.state,e.previewProps)}}))},A[40]=V,A[41]=Y,A[42]=e.state,A[43]=e.previewProps,A[44]=g):g=A[44];let eh=(0,$.W)(g),em="local"!==L.storage.kind&&Q?`${(0,$.Y)(Q)}${"index"===V.dataLocation?`/tree/${J}/${null!=(t=(0,$.l)(L.storage))?t:""}${q}`:`/blob/${J}/${null!=(n=(0,$.l)(L.storage))?n:""}${q}${(0,$.Z)(V)}`}`:void 0;A[45]!==B.kind||A[46]!==ed?(p=()=>{let e=e=>{"loading"!==B.kind&&(0,h.v_)("mod+s",e)&&(e.preventDefault(),ed())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},b=[B.kind,ed],A[45]=B.kind,A[46]=ed,A[47]=p,A[48]=b):(p=A[47],b=A[48]),(0,i.useEffect)(p,b);let ef="loading"===B.kind;A[49]!==ef||A[50]!==e.hasChanged||A[51]!==e.onReset||A[52]!==eo||A[53]!==es||A[54]!==eu||A[55]!==eh||A[56]!==em||A[57]!==ee?(y=(0,_.jsx)(tt,{formID:"item-edit-form",isLoading:ef,hasChanged:e.hasChanged,onDelete:eo,onDuplicate:es,onCopy:eu,onPaste:eh,onReset:e.onReset,viewHref:em,previewHref:ee}),A[49]=ef,A[50]=e.hasChanged,A[51]=e.onReset,A[52]=eo,A[53]=es,A[54]=eu,A[55]=eh,A[56]=em,A[57]=ee,A[58]=y):y=A[58],A[59]!==B?(j="error"===B.kind&&(0,_.jsx)(K.$,{tone:"critical",children:B.error.message}),A[59]=B,A[60]=j):j=A[60],A[61]!==ei?(x="error"===ei.kind&&(0,_.jsx)(K.$,{tone:"critical",children:ei.error.message}),A[61]=ei,A[62]=x):x=A[62],A[63]!==ed?(v=e=>{e.target===e.currentTarget&&(e.preventDefault(),ed())},A[63]=ed,A[64]=v):v=A[64];let eg=e.previewProps;return A[65]!==eg||A[66]!==Z||A[67]!==Y.entryLayout||A[68]!==V||A[69]!==ea?(w=(0,_.jsx)(C.F,{previewProps:eg,forceValidation:Z,entryLayout:Y.entryLayout,formatInfo:V,slugField:ea}),A[65]=eg,A[66]=Z,A[67]=Y.entryLayout,A[68]=V,A[69]=ea,A[70]=w):w=A[70],A[71]!==v||A[72]!==w?(k=(0,_.jsx)(c.az,{id:"item-edit-form",height:"100%",minHeight:0,minWidth:0,elementType:"form",onSubmit:v,children:w}),A[71]=v,A[72]=w,A[73]=k):k=A[73],A[74]!==B||A[75]!==D||A[76]!==M||A[77]!==O||A[78]!==Y||A[79]!==e||A[80]!==H||A[81]!==W?(S="needs-new-branch"===B.kind&&(0,_.jsx)(tn,{branchOid:W,onCreate:async t=>{let n=`/keystatic/branch/${encodeURIComponent(t)}/collection/${encodeURIComponent(D)}/item/`;M.push(n+encodeURIComponent(O));let a=(0,$.P)(Y,e.state);await H({branch:t,sha:W})&&a!==O&&M.replace(n+encodeURIComponent(a))},reason:B.reason,onDismiss:e.onResetUpdateItem}),A[74]=B,A[75]=D,A[76]=M,A[77]=O,A[78]=Y,A[79]=e,A[80]=H,A[81]=W,A[82]=S):S=A[82],A[83]!==e.onResetUpdateItem||A[84]!==S?(P=(0,_.jsx)(I.Uz,{onDismiss:e.onResetUpdateItem,children:S}),A[83]=e.onResetUpdateItem,A[84]=S,A[85]=P):P=A[85],A[86]!==B.kind||A[87]!==e||A[88]!==Y||A[89]!==O||A[90]!==M||A[91]!==D?(E="needs-fork"===B.kind&&(0,$._)(e.config)&&(0,_.jsx)(eO,{onCreate:async()=>{let t=(0,$.P)(Y,e.state);await e.onUpdate()&&t!==O&&M.replace(`${e.basePath}/collection/${encodeURIComponent(D)}/item/${encodeURIComponent(t)}`)},onDismiss:e.onResetUpdateItem,config:e.config}),A[86]=B.kind,A[87]=e,A[88]=Y,A[89]=O,A[90]=M,A[91]=D,A[92]=E):E=A[92],A[93]!==e.onResetUpdateItem||A[94]!==E?(F=(0,_.jsx)(I.Uz,{onDismiss:e.onResetUpdateItem,children:E}),A[93]=e.onResetUpdateItem,A[94]=E,A[95]=F):F=A[95],A[96]!==ei.kind||A[97]!==e||A[98]!==er||A[99]!==M||A[100]!==D||A[101]!==el?(R="needs-fork"===ei.kind&&(0,$._)(e.config)&&(0,_.jsx)(eO,{onCreate:async()=>{await er(),M.push(`${e.basePath}/collection/${encodeURIComponent(D)}`)},onDismiss:el,config:e.config}),A[96]=ei.kind,A[97]=e,A[98]=er,A[99]=M,A[100]=D,A[101]=el,A[102]=R):R=A[102],A[103]!==el||A[104]!==R?(U=(0,_.jsx)(I.Uz,{onDismiss:el,children:R}),A[103]=el,A[104]=R,A[105]=U):U=A[105],A[106]!==y||A[107]!==e||A[108]!==j||A[109]!==x||A[110]!==k||A[111]!==P||A[112]!==F||A[113]!==U?(T=(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(tr,{headerActions:y,...e,children:[j,x,k,P,F,U]})}),A[106]=y,A[107]=e,A[108]=j,A[109]=x,A[110]=k,A[111]=P,A[112]=F,A[113]=U,A[114]=T):T=A[114],T}function e9(e){var t;let n,r,l,o,s,c,d,u,h,m,f,g,p=(0,a.c)(64),{collection:b,config:y,initialFiles:j,initialState:x,localTreeKey:v,draft:w}=e,{collectionConfig:k,schema:S}=e0(b),C=null!=(t=null==w?void 0:w.state)?t:x;p[0]!==C||p[1]!==v?(n={state:C,localTreeKey:v},p[0]=C,p[1]=v,p[2]=n):n=p[2];let[P,I]=(0,i.useState)(n),{state:E,localTreeKey:F}=P;(0,$.V)(w,E,v),F!==v&&I({state:x,localTreeKey:v}),p[3]===Symbol.for("react.memo_cache_sentinel")?(r=e=>{I(t=>({localTreeKey:t.localTreeKey,state:e(t.state)}))},p[3]=r):r=p[3];let R=eZ(S,r,E);p[4]!==x||p[5]!==S||p[6]!==E||p[7]!==k.slugField?(l={initialState:x,schema:S,state:E,slugField:k.slugField},p[4]=x,p[5]=S,p[6]=E,p[7]=k.slugField,p[8]=l):l=p[8];let U=eJ(l);if(p[9]!==k||p[10]!==E||p[11]!==y||p[12]!==b){let e;s=(0,$.P)(k,E),p[16]!==y||p[17]!==b?(e=(0,$.v)(y,b),p[16]=y,p[17]=b,p[18]=e):e=p[18],c=e,o=(0,$.w)(y,b,s),p[9]=k,p[10]=E,p[11]=y,p[12]=b,p[13]=o,p[14]=s,p[15]=c}else o=p[13],s=p[14],c=p[15];let T=o;p[19]!==k.slugField||p[20]!==s?(d={field:k.slugField,value:s},p[19]=k.slugField,p[20]=s,p[21]=d):d=p[21],p[22]!==E||p[23]!==j||p[24]!==y||p[25]!==k.schema||p[26]!==T||p[27]!==c||p[28]!==v||p[29]!==d?(u={state:E,initialFiles:j,config:y,schema:k.schema,basePath:T,format:c,currentLocalTreeKey:v,slug:d},p[22]=E,p[23]=j,p[24]=y,p[25]=k.schema,p[26]=T,p[27]=c,p[28]=v,p[29]=d,p[30]=u):u=p[30];let[A,D,L]=eq(u);p[31]!==b||p[32]!==e.itemSlug||p[33]!==U||p[34]!==T||p[35]!==y||p[36]!==k.schema||p[37]!==k.slugField||p[38]!==s||p[39]!==E||p[40]!==v?(h=()=>{let t=["collection",b,e.itemSlug];if(U){let e=new Map(eW({basePath:T,format:(0,$.v)(y,b),schema:k.schema,slug:{field:k.slugField,value:s},state:E}).map(e=>[e.path,e.contents])),n={beforeTreeKey:v,slug:s,files:e,savedAt:new Date,version:1};(0,$.$)(t,n)}else(0,$.a0)(t)},p[31]=b,p[32]=e.itemSlug,p[33]=U,p[34]=T,p[35]=y,p[36]=k.schema,p[37]=k.slugField,p[38]=s,p[39]=E,p[40]=v,p[41]=h):h=p[41],p[42]!==b||p[43]!==k||p[44]!==y||p[45]!==T||p[46]!==v||p[47]!==e.itemSlug||p[48]!==s||p[49]!==E||p[50]!==U?(m=[b,k,y,T,v,e.itemSlug,s,E,U],p[42]=b,p[43]=k,p[44]=y,p[45]=T,p[46]=v,p[47]=e.itemSlug,p[48]=s,p[49]=E,p[50]=U,p[51]=m):m=p[51],(0,i.useEffect)(h,m);let O=(0,$.W)(D);p[52]!==x||p[53]!==v?(f=()=>{I({state:x,localTreeKey:v})},p[52]=x,p[53]=v,p[54]=f):f=p[54];let K=f;return p[55]!==e||p[56]!==O||p[57]!==K||p[58]!==A||p[59]!==L||p[60]!==R||p[61]!==E||p[62]!==U?(g=(0,_.jsx)(e8,{...e,onUpdate:O,onReset:K,updateResult:A,onResetUpdateItem:L,previewProps:R,state:E,hasChanged:U}),p[55]=e,p[56]=O,p[57]=K,p[58]=A,p[59]=L,p[60]=R,p[61]=E,p[62]=U,p[63]=g):g=p[63],g}function te(e){let t,n,i,r,l,o,s=(0,a.c)(33),{collection:c,config:d,initialFiles:u,initialState:h,localTreeKey:m}=e,{collectionConfig:f,schema:g}=e0(c),p=eQ(g,e.map),b=eX(g,e.map,p),y=(0,$.P)(f,p);s[0]!==e.config||s[1]!==e.collection?(t=(0,$.v)(e.config,e.collection),s[0]=e.config,s[1]=e.collection,s[2]=t):t=s[2];let j=t;s[3]!==h||s[4]!==g||s[5]!==p||s[6]!==f.slugField?(n={initialState:h,schema:g,state:p,slugField:f.slugField},s[3]=h,s[4]=g,s[5]=p,s[6]=f.slugField,s[7]=n):n=s[7];let x=eJ(n),v=(0,$.w)(d,c,y);s[8]!==f.slugField||s[9]!==y?(i={field:f.slugField,value:y},s[8]=f.slugField,s[9]=y,s[10]=i):i=s[10],s[11]!==p||s[12]!==u||s[13]!==d||s[14]!==f.schema||s[15]!==v||s[16]!==j||s[17]!==m||s[18]!==i?(r={state:p,initialFiles:u,config:d,schema:f.schema,basePath:v,format:j,currentLocalTreeKey:m,slug:i},s[11]=p,s[12]=u,s[13]=d,s[14]=f.schema,s[15]=v,s[16]=j,s[17]=m,s[18]=i,s[19]=r):r=s[19];let[w,k,S]=eq(r),C=(0,$.W)(k);s[20]!==e.map||s[21]!==e.initialState||s[22]!==f.schema?(l=()=>{var t;null==(t=e.map.doc)||t.transact(()=>{for(let[t,n]of Object.entries(f.schema)){let a=eR(n,e.initialState[t]);e.map.set(t,a)}})},s[20]=e.map,s[21]=e.initialState,s[22]=f.schema,s[23]=l):l=s[23];let P=l;return s[24]!==e||s[25]!==C||s[26]!==P||s[27]!==w||s[28]!==S||s[29]!==b||s[30]!==p||s[31]!==x?(o=(0,_.jsx)(e8,{...e,onUpdate:C,onReset:P,updateResult:w,onResetUpdateItem:S,previewProps:b,state:p,hasChanged:x}),s[24]=e,s[25]=C,s[26]=P,s[27]=w,s[28]=S,s[29]=b,s[30]=p,s[31]=x,s[32]=o):o=s[32],o}function tt(e){let t,n,o,h,m,f,g,p,b,y,j,x,w,S,$,P,E,R,U,T,A,D,L,K=(0,a.c)(55),{formID:z,hasChanged:q,isLoading:G,onDelete:V,onDuplicate:J,onReset:Q,onCopy:Z,onPaste:X,previewHref:ee,viewHref:et}=e,en=(0,k.Ub)(k.C3.below.desktop),ea=(0,u.o)(C.s),[ei,er]=(0,i.useState)(!1),[el,eo]=(0,i.useState)(!1);if(K[0]===Symbol.for("react.memo_cache_sentinel")?(n={key:"reset",label:"Reset changes",icon:O.o},K[0]=n):n=K[0],K[1]===Symbol.for("react.memo_cache_sentinel")?(o={key:"delete",label:"Delete entry",icon:F.U},K[1]=o):o=K[1],K[2]===Symbol.for("react.memo_cache_sentinel")?(h={key:"copy",label:"Copy entry",icon:N.p},K[2]=h):h=K[2],K[3]===Symbol.for("react.memo_cache_sentinel")?(m={key:"paste",label:"Paste entry",icon:M.V},K[3]=m):m=K[3],K[4]===Symbol.for("react.memo_cache_sentinel")?(f={key:"duplicate",label:"Duplicate entry",icon:Y.x},K[4]=f):f=K[4],K[5]!==ee||K[6]!==et){if(g=[n,o,h,m,f],ee){let e;K[8]!==ee?(e={key:"preview",label:"Preview",icon:W.X,href:ee,target:"_blank",rel:"noopener noreferrer"},K[8]=ee,K[9]=e):e=K[9],g.push(e)}if(et){let e;K[10]!==et?(e={key:"view",label:"View on GitHub",icon:s.F,href:et,target:"_blank",rel:"noopener noreferrer"},K[10]=et,K[11]=e):e=K[11],g.push(e)}K[5]=ee,K[6]=et,K[7]=g}else g=K[7];t=g;e:{if(G){let e;K[12]===Symbol.for("react.memo_cache_sentinel")?(e=(0,_.jsx)(v.a3,{"aria-label":"Saving changes",isIndeterminate:!0,size:"small",alignSelf:"center"}),K[12]=e):e=K[12],p=e;break e}if(q){let e;K[13]!==en?(e=en?(0,_.jsx)(c.az,{backgroundColor:"pendingEmphasis",height:"scale.75",width:"scale.75",borderRadius:"full",children:(0,_.jsx)(d.EY,{visuallyHidden:!0,children:"Unsaved"})}):(0,_.jsx)(H.E,{tone:"pending",children:"Unsaved"}),K[13]=en,K[14]=e):e=K[14],p=e;break e}p=null}let es=p;K[15]===Symbol.for("react.memo_cache_sentinel")?(b={mobile:"small",tablet:"regular"},K[15]=b):b=K[15],K[16]===Symbol.for("react.memo_cache_sentinel")?(y=(0,_.jsx)(eB,{}),K[16]=y):y=K[16];let ec=en?"element.regular":void 0;return K[17]!==q?(j=q?[]:["reset"],K[17]=q,K[18]=j):j=K[18],K[19]!==Q||K[20]!==Z||K[21]!==X||K[22]!==q||K[23]!==J?(x=e=>{switch(e){case"reset":Q();break;case"delete":er(!0);break;case"copy":Z();break;case"paste":X();break;case"duplicate":q?eo(!0):J()}},K[19]=Q,K[20]=Z,K[21]=X,K[22]=q,K[23]=J,K[24]=x):x=K[24],K[25]===Symbol.for("react.memo_cache_sentinel")?(w=e=>(0,_.jsxs)(B.q,{textValue:e.label,href:e.href,target:e.target,rel:e.rel,children:[(0,_.jsx)(l.I,{src:e.icon}),(0,_.jsx)(d.EY,{children:e.label})]},e.key),K[25]=w):w=K[25],K[26]!==ec||K[27]!==t||K[28]!==j||K[29]!==x?(S=(0,_.jsx)(B.K,{buttonLabelBehavior:"hide",overflowMode:"collapse",prominence:"low",density:"compact",maxWidth:ec,items:t,disabledKeys:j,onAction:x,children:w}),K[26]=ec,K[27]=t,K[28]=j,K[29]=x,K[30]=S):S=K[30],K[31]!==ea?($=ea.format("save"),K[31]=ea,K[32]=$):$=K[32],K[33]!==z||K[34]!==G||K[35]!==$?(P=(0,_.jsx)(r.$n,{form:z,isDisabled:G,prominence:"high",type:"submit",children:$}),K[33]=z,K[34]=G,K[35]=$,K[36]=P):P=K[36],K[37]===Symbol.for("react.memo_cache_sentinel")?(E=()=>er(!1),K[37]=E):E=K[37],K[38]!==ei||K[39]!==V?(R=ei&&(0,_.jsx)(I.Lt,{title:"Delete entry",tone:"critical",cancelLabel:"Cancel",primaryActionLabel:"Yes, delete",autoFocusButton:"cancel",onPrimaryAction:V,children:"Are you sure? This action cannot be undone."}),K[38]=ei,K[39]=V,K[40]=R):R=K[40],K[41]!==R?(U=(0,_.jsx)(I.Uz,{onDismiss:E,children:R}),K[41]=R,K[42]=U):U=K[42],K[43]===Symbol.for("react.memo_cache_sentinel")?(T=()=>eo(!1),K[43]=T):T=K[43],K[44]!==el||K[45]!==J?(A=el&&(0,_.jsx)(I.Lt,{title:"Save and duplicate entry",tone:"neutral",cancelLabel:"Cancel",primaryActionLabel:"Save and duplicate",autoFocusButton:"primary",onPrimaryAction:J,children:"You have unsaved changes. Save this entry to duplicate it."}),K[44]=el,K[45]=J,K[46]=A):A=K[46],K[47]!==A?(D=(0,_.jsx)(I.Uz,{onDismiss:T,children:A}),K[47]=A,K[48]=D):D=K[48],K[49]!==es||K[50]!==S||K[51]!==P||K[52]!==U||K[53]!==D?(L=(0,_.jsxs)(c.so,{alignItems:"center",gap:b,children:[y,es,S,P,U,D]}),K[49]=es,K[50]=S,K[51]=P,K[52]=U,K[53]=D,K[54]=L):L=K[54],L}function tn(e){var t;let n,l,o,s,h,m,f,g,p,b,y,j,x,w,S=(0,a.c)(41),P=(0,u.o)(C.s),F=(0,$.c)(),[R,U]=(0,i.useState)(""),[A,D]=(0,C.k)(),{error:L,fetching:O,data:K}=A,z=O||!!(null!=K&&null!=(t=K.createRef)&&t.__typename),B=(0,$.z)();S[0]!==B?(n=(0,$.X)(B),S[0]=B,S[1]=n):n=S[1];let H=n;S[2]!==H?(l=H?{UNSAFE_className:(0,k.AH)({"& input":{paddingInlineStart:k.Bk.size.space.xsmall}}),startElement:(0,_.jsx)(c.so,{alignItems:"center",paddingStart:"regular",justifyContent:"center",pointerEvents:"none",children:(0,_.jsx)(d.EY,{color:"neutralSecondary",children:H})})}:{},S[2]=H,S[3]=l):l=S[3];let Y=l;return S[4]===Symbol.for("react.memo_cache_sentinel")?(o={display:"contents"},S[4]=o):o=S[4],S[5]!==H||S[6]!==R||S[7]!==D||S[8]!==e||S[9]!==F?(s=async t=>{var n;if(t.target!==t.currentTarget)return;t.preventDefault();let a=(null!=H?H:"")+R,i=`refs/heads/${a}`;null!=(n=(await D({input:{name:i,oid:e.branchOid,repositoryId:F.id}})).data)&&null!=(n=n.createRef)&&n.__typename&&e.onCreate(a)},S[5]=H,S[6]=R,S[7]=D,S[8]=e,S[9]=F,S[10]=s):s=S[10],S[11]!==P?(h=P.format("newBranch"),S[11]=P,S[12]=h):h=S[12],S[13]!==h?(m=(0,_.jsx)(d.DZ,{children:h}),S[13]=h,S[14]=m):m=S[14],S[15]!==L?(f=(0,C.l)(L),S[15]=L,S[16]=f):f=S[16],S[17]!==R||S[18]!==e.reason||S[19]!==f||S[20]!==Y?(g=(0,_.jsx)(E.UC,{children:(0,_.jsx)(c.so,{gap:"large",direction:"column",children:(0,_.jsx)(T.A_,{value:R,onChange:U,label:"Branch name",description:e.reason,autoFocus:!0,errorMessage:f,...Y})})}),S[17]=R,S[18]=e.reason,S[19]=f,S[20]=Y,S[21]=g):g=S[21],S[22]!==z?(p=z&&(0,_.jsx)(v.a3,{isIndeterminate:!0,size:"small","aria-label":"Creating Branch"}),S[22]=z,S[23]=p):p=S[23],S[24]!==P?(b=P.format("cancel"),S[24]=P,S[25]=b):b=S[25],S[26]!==z||S[27]!==e.onDismiss||S[28]!==b?(y=(0,_.jsx)(r.$n,{isDisabled:z,onPress:e.onDismiss,children:b}),S[26]=z,S[27]=e.onDismiss,S[28]=b,S[29]=y):y=S[29],S[30]!==z?(j=(0,_.jsx)(r.$n,{isDisabled:z,prominence:"high",type:"submit",children:"Create branch and save"}),S[30]=z,S[31]=j):j=S[31],S[32]!==p||S[33]!==y||S[34]!==j?(x=(0,_.jsxs)(r.e2,{children:[p,y,j]}),S[32]=p,S[33]=y,S[34]=j,S[35]=x):x=S[35],S[36]!==s||S[37]!==m||S[38]!==g||S[39]!==x?(w=(0,_.jsx)(I.lG,{children:(0,_.jsxs)("form",{style:o,onSubmit:s,children:[m,g,x]})}),S[36]=s,S[37]=m,S[38]=g,S[39]=x,S[40]=w):w=S[40],w}function ta(e){var t;let n=null==(t=e.config.collections)?void 0:t[e.collection];n||ep();let a=(0,i.useMemo)(()=>(0,$.v)(e.config,e.collection),[e.config,e.collection]),r=(0,i.useMemo)(()=>({slug:e.itemSlug,field:n.slugField}),[n.slugField,e.itemSlug]),l=(0,$.f)((0,i.useCallback)(async()=>{try{let t=await (0,$.R)(["collection",e.collection,e.itemSlug]);if(!t)throw Error("No draft found");let a=e7.create(t);return{state:ex({dirpath:(0,$.w)(e.config,e.collection,a.slug),format:(0,$.v)(e.config,e.collection),schema:n.schema,slug:{field:n.slugField,slug:a.slug}},a.files).initialState,savedAt:a.savedAt,treeKey:a.beforeTreeKey}}catch{}},[n,e.collection,e.config,e.itemSlug])),o=ev({config:e.config,dirpath:(0,$.w)(e.config,e.collection,e.itemSlug),schema:n.schema,format:a,slug:r}),s=(0,$.q)(),d=`${s}/${e.collection}/item/${e.itemSlug}`,u=(0,$.S)(),h="loaded"!==o.kind,m=!h&&"not-found"===o.data,f=(0,$.f)((0,i.useCallback)(()=>u?"loading"===u||h?$.L:m?void 0:(async()=>{await u.doc.whenSynced;let e=u.data.get(d);if(e instanceof D.JA){let t=e.whenLoaded;e.load(),await t}else e=new D.JA,u.data.set(d,e);return e.getMap("data")})():void 0,[h,m,d,u]));return(0,_.jsx)(ey,{fallback:(0,_.jsx)(tr,{...e,children:(0,_.jsx)(C.i,{children:(0,_.jsx)(K.$,{tone:"caution",children:"Entry not found."})})}),children:(0,_.jsx)(e2,{fallback:t=>(0,_.jsx)(tr,{...e,children:(0,_.jsx)(C.i,{children:(0,_.jsx)(K.$,{tone:"critical",children:t})})}),children:(0,_.jsx)(i.Suspense,{fallback:(0,_.jsx)(tr,{...e,children:(0,_.jsx)(c.so,{alignItems:"center",justifyContent:"center",minHeight:"scale.3000",children:(0,_.jsx)(v.a3,{"aria-label":"Loading Item",isIndeterminate:!0,size:"large"})})}),children:(0,_.jsx)(ti,{mapData:f,draftData:l,itemData:o,...e})})})})}function ti(e){let t=(0,$.T)(e.config,e.collection),n=(0,i.useDeferredValue)(e.draftData),a=(0,$.U)(e.itemData);"not-found"===a&&ep();let r=(0,$.U)(e.mapData);(0,i.useMemo)(()=>{var e;if(!r||r.size)return;let{initialState:n}=a;null==(e=r.doc)||e.transact(()=>{for(let[e,a]of Object.entries(t.schema)){let t=eR(a,n[e]);r.set(e,t)}})},[t.schema,a,r]);let l=(0,$.U)(n);return r?(0,_.jsx)(te,{collection:e.collection,basePath:e.basePath,config:e.config,itemSlug:e.itemSlug,initialState:a.initialState,initialFiles:a.initialFiles,localTreeKey:a.localTreeKey,map:r}):(0,_.jsx)(e9,{collection:e.collection,basePath:e.basePath,config:e.config,itemSlug:e.itemSlug,initialState:a.initialState,initialFiles:a.initialFiles,draft:l,localTreeKey:a.localTreeKey})}function tr(e){let t,n,i,r,l,o,s=(0,a.c)(17);if(s[0]!==e.config||s[1]!==e.collection||s[2]!==e.basePath||s[3]!==e.itemSlug){let a=(0,$.T)(e.config,e.collection),r=`${e.basePath}/collection/${e.collection}`;t=[{key:"collection",label:a.label,href:r},{key:"item",label:e.itemSlug}],n=C.P,i=(0,C.j)(a),s[0]=e.config,s[1]=e.collection,s[2]=e.basePath,s[3]=e.itemSlug,s[4]=t,s[5]=n,s[6]=i}else t=s[4],n=s[5],i=s[6];return s[7]!==t?(r=(0,_.jsx)(eK,{items:t}),s[7]=t,s[8]=r):r=s[8],s[9]!==r||s[10]!==e.headerActions?(l=(0,_.jsxs)(C.a,{children:[r,e.headerActions]}),s[9]=r,s[10]=e.headerActions,s[11]=l):l=s[11],s[12]!==n||s[13]!==i||s[14]!==l||s[15]!==e.children?(o=(0,_.jsxs)(n,{containerWidth:i,children:[l,e.children]}),s[12]=n,s[13]=i,s[14]=l,s[15]=e.children,s[16]=o):o=s[16],o}function tl(e){var t;let n,r,l,o,s,d,u,h,m,f,g=(0,a.c)(53),p=(0,$.u)();g[0]!==p.href?(r=new URL(p.href,"http://localhost").searchParams.get("duplicate"),g[0]=p.href,g[1]=r):r=g[1],n=r;let b=null==(t=e.config.collections)?void 0:t[e.collection];b||ep(),g[2]!==e.config||g[3]!==e.collection?(o=(0,$.v)(e.config,e.collection),g[2]=e.config,g[3]=e.collection,g[4]=o):o=g[4],l=o,g[5]!==e.collection||g[6]!==e.config||g[7]!==n||g[8]!==l||g[9]!==b.schema||g[10]!==b.slugField?(s=async()=>{let t=await (0,$.R)(["collection-create",e.collection,...n?[n]:[]]);if(!t)throw Error("No draft found");let a=to.create(t);return{state:ex({dirpath:(0,$.w)(e.config,e.collection,a.slug),format:l,schema:b.schema,slug:{field:b.slugField,slug:a.slug}},a.files).initialState,savedAt:a.savedAt}},g[5]=e.collection,g[6]=e.config,g[7]=n,g[8]=l,g[9]=b.schema,g[10]=b.slugField,g[11]=s):s=g[11];let y=(0,$.f)(s);e:{if(n){let e;g[12]!==b.slugField||g[13]!==n?(e={field:b.slugField,slug:n},g[12]=b.slugField,g[13]=n,g[14]=e):e=g[14],d=e;break e}if(b.template){let e;g[15]!==b.slugField?(e={field:b.slugField,slug:""},g[15]=b.slugField,g[16]=e):e=g[16],d=e;break e}d=void 0}let j=d,x=!!n||!!b.template;g[17]!==b.template||g[18]!==n||g[19]!==e?(u=b.template&&!n?b.template:(0,$.w)(e.config,e.collection,null!=n?n:""),g[17]=b.template,g[18]=n,g[19]=e,g[20]=u):u=g[20],g[21]!==e.config||g[22]!==u||g[23]!==b.schema||g[24]!==l||g[25]!==j?(h={config:e.config,dirpath:u,schema:b.schema,format:l,slug:j},g[21]=e.config,g[22]=u,g[23]=b.schema,g[24]=l,g[25]=j,g[26]=h):h=g[26];let w=ev(h),k=x&&"loaded"===w.kind&&"not-found"!==w.data?w.data.initialState:void 0,S=(0,i.useMemo)(()=>{if(k){let{slugField:e}=b,t=k[b.slugField],n=b.schema[b.slugField];if("form"===n.kind&&"slug"===n.formKind)try{let a=n.serializeWithSlug(t),i=n.parse(a.value,{slug:a.slug?`${a.slug}-copy`:""});return{...k,[e]:i}}catch{}return{...k,[e]:t}}},[b,k]),P=(0,$.q)(),I=(0,$.S)(),E=`${P}/${e.collection}/create${null!=n&&n.length?`?duplicate=${n}`:""}`;g[27]!==I||g[28]!==x||g[29]!==k||g[30]!==E||g[31]!==b.schema?(m=async()=>{if(!I)return;if("loading"===I||(await I.doc.whenSynced,x&&!k))return $.L;let e=I.data.get(E);if(e instanceof D.JA){let t=e.whenLoaded;e.load(),await t}else e=new D.JA,I.data.set(E,e);let t=e.getMap("data");return t.size||e.transact(()=>{for(let[n,a]of Object.entries(b.schema)){var e;let i=eR(a,null!=(e=null==k?void 0:k[n])?e:(0,C.o)(a));t.set(n,i)}}),t},g[27]=I,g[28]=x,g[29]=k,g[30]=E,g[31]=b.schema,g[32]=m):m=g[32];let F=(0,$.f)(m);if(x&&"error"===w.kind){let e;return g[33]!==w.error.message?(e=(0,_.jsx)(C.i,{children:(0,_.jsx)(K.$,{tone:"critical",children:w.error.message})}),g[33]=w.error.message,g[34]=e):e=g[34],e}if("error"===F.kind){let e;return console.log(F.error),g[35]!==F.error.message?(e=(0,_.jsx)(C.i,{children:(0,_.jsx)(K.$,{tone:"critical",children:F.error.message})}),g[35]=F.error.message,g[36]=e):e=g[36],e}if(x&&"loading"===w.kind||"loading"===y.kind||"loading"===F.kind){let e;return g[37]===Symbol.for("react.memo_cache_sentinel")?(e=(0,_.jsx)(c.so,{alignItems:"center",justifyContent:"center",minHeight:"scale.3000",children:(0,_.jsx)(v.a3,{"aria-label":"Loading Item",isIndeterminate:!0,size:"large"})}),g[37]=e):e=g[37],e}if(x&&"loaded"===w.kind&&"not-found"===w.data){let e;return g[38]===Symbol.for("react.memo_cache_sentinel")?(e=(0,_.jsx)(C.i,{children:(0,_.jsx)(K.$,{tone:"caution",children:"Entry not found."})}),g[38]=e):e=g[38],e}if(!F.data){let t,a="loaded"===y.kind?y.data:void 0;return g[39]!==e.collection||g[40]!==e.config||g[41]!==e.basePath||g[42]!==a||g[43]!==n||g[44]!==S?(t=(0,_.jsx)(ts,{collection:e.collection,config:e.config,basePath:e.basePath,draft:a,duplicateSlug:n,initialState:S}),g[39]=e.collection,g[40]=e.config,g[41]=e.basePath,g[42]=a,g[43]=n,g[44]=S,g[45]=t):t=g[45],t}return g[46]!==e.collection||g[47]!==e.config||g[48]!==e.basePath||g[49]!==n||g[50]!==S||g[51]!==F.data?(f=(0,_.jsx)(tc,{collection:e.collection,config:e.config,basePath:e.basePath,duplicateSlug:n,initialState:S,map:F.data}),g[46]=e.collection,g[47]=e.config,g[48]=e.basePath,g[49]=n,g[50]=S,g[51]=F.data,g[52]=f):f=g[52],f}let to=L.NW({version:L.eu(1),savedAt:L.p6(),slug:L.Yj(),files:L.Tj(L.Yj(),L.KJ(Uint8Array))});function ts(e){var t,n,r;let l,o,s,c,d,u,h,m,f,g,p,b,y=(0,a.c)(61),{collectionConfig:j,schema:x}=e0(e.collection);y[0]!==e.initialState||y[1]!==x?(o=null!=(r=e.initialState)?r:(0,C.o)(x),y[0]=e.initialState,y[1]=x,y[2]=o):o=y[2],l=o;let[v,w]=(0,i.useState)(null!=(t=null==(n=e.draft)?void 0:n.state)?t:l),k=eZ(x,w,v);if((0,$.V)(e.draft,v,void 0),y[3]!==j||y[4]!==v||y[5]!==e.config||y[6]!==e.collection){let t;c=(0,$.P)(j,v),y[10]!==e.config||y[11]!==e.collection?(t=(0,$.v)(e.config,e.collection),y[10]=e.config,y[11]=e.collection,y[12]=t):t=y[12],d=t,s=(0,$.w)(e.config,e.collection,c),y[3]=j,y[4]=v,y[5]=e.config,y[6]=e.collection,y[7]=s,y[8]=c,y[9]=d}else s=y[7],c=y[8],d=y[9];let S=s;y[13]!==j.slugField||y[14]!==c?(u={field:j.slugField,value:c},y[13]=j.slugField,y[14]=c,y[15]=u):u=y[15],y[16]!==v||y[17]!==S||y[18]!==e.config||y[19]!==j.schema||y[20]!==d||y[21]!==u?(h={state:v,basePath:S,initialFiles:void 0,config:e.config,schema:j.schema,format:d,currentLocalTreeKey:void 0,slug:u},y[16]=v,y[17]=S,y[18]=e.config,y[19]=j.schema,y[20]=d,y[21]=u,y[22]=h):h=y[22];let[P,I,E]=eq(h),F=(0,$.W)(I);y[23]!==l||y[24]!==x||y[25]!==v||y[26]!==j.slugField?(m={initialState:l,schema:x,state:v,slugField:j.slugField},y[23]=l,y[24]=x,y[25]=v,y[26]=j.slugField,y[27]=m):m=y[27];let R=eJ(m),U="updated"===P.kind||"loading"===P.kind;return y[28]!==e.collection||y[29]!==e.duplicateSlug||y[30]!==R||y[31]!==U||y[32]!==S||y[33]!==d||y[34]!==j.schema||y[35]!==j.slugField||y[36]!==c||y[37]!==v?(f=()=>{let t=["collection-create",e.collection,...e.duplicateSlug?[e.duplicateSlug]:[]];if(R&&!U){let e=new Map(eW({basePath:S,format:d,schema:j.schema,slug:{field:j.slugField,value:c},state:v}).map(e=>[e.path,e.contents])),n={slug:c,files:e,savedAt:new Date,version:1};(0,$.$)(t,n)}else(0,$.a0)(t)},y[28]=e.collection,y[29]=e.duplicateSlug,y[30]=R,y[31]=U,y[32]=S,y[33]=d,y[34]=j.schema,y[35]=j.slugField,y[36]=c,y[37]=v,y[38]=f):f=y[38],y[39]!==j||y[40]!==c||y[41]!==v||y[42]!==R||y[43]!==e.duplicateSlug||y[44]!==e.collection||y[45]!==S||y[46]!==d||y[47]!==U?(g=[j,c,v,R,e.duplicateSlug,e.collection,S,d,U],y[39]=j,y[40]=c,y[41]=v,y[42]=R,y[43]=e.duplicateSlug,y[44]=e.collection,y[45]=S,y[46]=d,y[47]=U,y[48]=g):g=y[48],(0,i.useEffect)(f,g),y[49]!==l?(p=()=>{w(l)},y[49]=l,y[50]=p):p=y[50],y[51]!==e.basePath||y[52]!==e.collection||y[53]!==P||y[54]!==F||y[55]!==E||y[56]!==v||y[57]!==c||y[58]!==k||y[59]!==p?(b=(0,_.jsx)(td,{basePath:e.basePath,collection:e.collection,createResult:P,createItem:F,resetCreateItemState:E,state:v,slug:c,previewProps:k,onReset:p}),y[51]=e.basePath,y[52]=e.collection,y[53]=P,y[54]=F,y[55]=E,y[56]=v,y[57]=c,y[58]=k,y[59]=p,y[60]=b):b=y[60],b}function tc(e){let t,n,i,r,l,o,s,c=(0,a.c)(34),{collectionConfig:d,schema:u}=e0(e.collection),h=eQ(u,e.map),m=eX(u,e.map,h);if(c[0]!==d||c[1]!==h||c[2]!==e.config||c[3]!==e.collection){let a;n=(0,$.P)(d,h),c[7]!==e.config||c[8]!==e.collection?(a=(0,$.v)(e.config,e.collection),c[7]=e.config,c[8]=e.collection,c[9]=a):a=c[9],i=a,t=(0,$.w)(e.config,e.collection,n),c[0]=d,c[1]=h,c[2]=e.config,c[3]=e.collection,c[4]=t,c[5]=n,c[6]=i}else t=c[4],n=c[5],i=c[6];let f=t;c[10]!==d.slugField||c[11]!==n?(r={field:d.slugField,value:n},c[10]=d.slugField,c[11]=n,c[12]=r):r=c[12],c[13]!==h||c[14]!==f||c[15]!==e.config||c[16]!==d.schema||c[17]!==i||c[18]!==r?(l={state:h,basePath:f,initialFiles:void 0,config:e.config,schema:d.schema,format:i,currentLocalTreeKey:void 0,slug:r},c[13]=h,c[14]=f,c[15]=e.config,c[16]=d.schema,c[17]=i,c[18]=r,c[19]=l):l=c[19];let[g,p,b]=eq(l),y=(0,$.W)(p);return c[20]!==e.map||c[21]!==e.initialState||c[22]!==d.schema?(o=()=>{var t;null==(t=e.map.doc)||t.transact(()=>{for(let[a,i]of Object.entries(d.schema)){var t,n;let r=eR(i,null!=(t=null==(n=e.initialState)?void 0:n[a])?t:(0,C.o)(i));e.map.set(a,r)}})},c[20]=e.map,c[21]=e.initialState,c[22]=d.schema,c[23]=o):o=c[23],c[24]!==e.basePath||c[25]!==e.collection||c[26]!==g||c[27]!==y||c[28]!==b||c[29]!==h||c[30]!==n||c[31]!==m||c[32]!==o?(s=(0,_.jsx)(td,{basePath:e.basePath,collection:e.collection,createResult:g,createItem:y,resetCreateItemState:b,state:h,slug:n,previewProps:m,onReset:o}),c[24]=e.basePath,c[25]=e.collection,c[26]=g,c[27]=y,c[28]=b,c[29]=h,c[30]=n,c[31]=m,c[32]=o,c[33]=s):s=c[33],s}function td(e){let t,n,o,s,h,m,f,g,p,b,y,j,x,w,S,P,E,F,R,U,T,A,D,L,O,H,Y,N,M,W=(0,a.c)(96),{onReset:q}=e,G=(0,u.o)(C.s),V=(0,$.u)(),J=(0,$.z)(),{collectionConfig:Q,schema:Z}=e0(e.collection),[X,ee]=(0,i.useState)(!1);W[0]!==J||W[1]!==e.collection?(t=(0,$.v)(J,e.collection),W[0]=J,W[1]=e.collection,W[2]=t):t=W[2];let et=t,en=(0,$.b)(),ea=`${e.basePath}/collection/${encodeURIComponent(e.collection)}`,{createResult:ei}=e,er="updated"===ei.kind||"loading"===ei.kind?e.slug:void 0,el=ez(e.collection,er);W[3]!==ei.kind||W[4]!==Z||W[5]!==e||W[6]!==el||W[7]!==Q||W[8]!==V||W[9]!==ea?(n=async()=>{if("loading"!==ei.kind){if(!(0,C.m)(Z,e.state,el))return void ee(!0);if(await e.createItem()){let t=(0,$.P)(Q,e.state);V.push(`${ea}/item/${encodeURIComponent(t)}`),z.n.positive("Entry created",{timeout:5e3})}}},W[3]=ei.kind,W[4]=Z,W[5]=e,W[6]=el,W[7]=Q,W[8]=V,W[9]=ea,W[10]=n):n=W[10];let eo=n;W[11]!==e.state||W[12]!==et||W[13]!==Q?(o=()=>{e6(e.state,et,Q.schema,{field:Q.slugField,value:(0,$.P)(Q,e.state)})},W[11]=e.state,W[12]=et,W[13]=Q,W[14]=o):o=W[14];let es=o;W[15]!==et||W[16]!==Q||W[17]!==e.state||W[18]!==e.previewProps?(s=async()=>{let t=await e5(et,Q.schema,{field:Q.slugField,slug:(0,$.P)(Q,e.state)});t&&((0,C.n)(t,e.previewProps),z.n.positive("Entry pasted",{shouldCloseOnAction:!0,actionLabel:"Undo",onAction:()=>{(0,C.n)(e.state,e.previewProps)}}))},W[15]=et,W[16]=Q,W[17]=e.state,W[18]=e.previewProps,W[19]=s):s=W[19];let ec=s,ed="loading"===ei.kind||"updated"===ei.kind;W[20]!==Q.label||W[21]!==ea?(m={key:"collection",label:Q.label,href:ea},W[20]=Q.label,W[21]=ea,W[22]=m):m=W[22],W[23]!==G?(f=G.format("add"),W[23]=G,W[24]=f):f=W[24],W[25]!==f?(g={key:"current",label:f},W[25]=f,W[26]=g):g=W[26],W[27]!==m||W[28]!==g?(p=[m,g],W[27]=m,W[28]=g,W[29]=p):p=W[29],h=p;let eu=(0,k.Ub)(k.C3.below.desktop);W[30]!==Q?(b=(0,C.j)(Q),W[30]=Q,W[31]=b):b=W[31],W[32]!==h?(y=(0,_.jsx)(eK,{items:h}),W[32]=h,W[33]=y):y=W[33],W[34]===Symbol.for("react.memo_cache_sentinel")?(j=(0,_.jsx)(eB,{}),W[34]=j):j=W[34],W[35]!==ed?(x=ed&&(0,_.jsx)(v.a3,{"aria-label":"Creating entry",isIndeterminate:!0,size:"small"}),W[35]=ed,W[36]=x):x=W[36];let eh=eu?"element.regular":void 0;return W[37]!==q||W[38]!==es||W[39]!==ec?(w=e=>{switch(e){case"reset":q(),ee(!1);break;case"copy":es();break;case"paste":ec()}},W[37]=q,W[38]=es,W[39]=ec,W[40]=w):w=W[40],W[41]===Symbol.for("react.memo_cache_sentinel")?(S=e=>(0,_.jsxs)(B.q,{textValue:e.label,children:[(0,_.jsx)(l.I,{src:e.icon}),(0,_.jsx)(d.EY,{children:e.label})]},e.key),W[41]=S):S=W[41],W[42]!==eh||W[43]!==w?(P=(0,_.jsx)(B.K,{buttonLabelBehavior:"hide",overflowMode:"collapse",prominence:"low",density:"compact",maxWidth:eh,items:tu,onAction:w,children:S}),W[42]=eh,W[43]=w,W[44]=P):P=W[44],W[45]!==G?(E=G.format("create"),W[45]=G,W[46]=E):E=W[46],W[47]!==ed||W[48]!==E?(F=(0,_.jsx)(r.$n,{isDisabled:ed,prominence:"high",type:"submit",form:"item-create-form",marginStart:"auto",children:E}),W[47]=ed,W[48]=E,W[49]=F):F=W[49],W[50]!==y||W[51]!==x||W[52]!==P||W[53]!==F?(R=(0,_.jsxs)(C.a,{children:[y,j,x,P,F]}),W[50]=y,W[51]=x,W[52]=P,W[53]=F,W[54]=R):R=W[54],W[55]!==eo?(U=e=>{e.target===e.currentTarget&&(e.preventDefault(),eo())},W[55]=eo,W[56]=U):U=W[56],W[57]!==ei?(T="error"===ei.kind&&(0,_.jsx)(K.$,{tone:"critical",children:ei.error.message}),W[57]=ei,W[58]=T):T=W[58],W[59]!==e.previewProps||W[60]!==X||W[61]!==Q.entryLayout||W[62]!==et||W[63]!==el?(A=(0,_.jsx)(C.F,{previewProps:e.previewProps,forceValidation:X,entryLayout:Q.entryLayout,formatInfo:et,slugField:el}),W[59]=e.previewProps,W[60]=X,W[61]=Q.entryLayout,W[62]=et,W[63]=el,W[64]=A):A=W[64],W[65]!==U||W[66]!==T||W[67]!==A?(D=(0,_.jsxs)(c.so,{id:"item-create-form",elementType:"form",onSubmit:U,direction:"column",gap:"xxlarge",height:"100%",minHeight:0,minWidth:0,children:[T,A]}),W[65]=U,W[66]=T,W[67]=A,W[68]=D):D=W[68],W[69]!==b||W[70]!==R||W[71]!==D?(L=(0,_.jsxs)(C.P,{containerWidth:b,children:[R,D]}),W[69]=b,W[70]=R,W[71]=D,W[72]=L):L=W[72],W[73]!==ei||W[74]!==V||W[75]!==e||W[76]!==en||W[77]!==Q?(O="needs-new-branch"===ei.kind&&(0,_.jsx)(tn,{branchOid:en,onCreate:async t=>{if(V.push(`/keystatic/branch/${encodeURIComponent(t)}/collection/${encodeURIComponent(e.collection)}/create`),await e.createItem({branch:t,sha:en})){let n=(0,$.P)(Q,e.state);V.push(`/keystatic/branch/${encodeURIComponent(t)}/collection/${encodeURIComponent(e.collection)}/item/${encodeURIComponent(n)}`)}},reason:ei.reason,onDismiss:e.resetCreateItemState}),W[73]=ei,W[74]=V,W[75]=e,W[76]=en,W[77]=Q,W[78]=O):O=W[78],W[79]!==e.resetCreateItemState||W[80]!==O?(H=(0,_.jsx)(I.Uz,{onDismiss:e.resetCreateItemState,children:O}),W[79]=e.resetCreateItemState,W[80]=O,W[81]=H):H=W[81],W[82]!==ei.kind||W[83]!==J||W[84]!==e||W[85]!==Q||W[86]!==V||W[87]!==ea?(Y="needs-fork"===ei.kind&&(0,$._)(J)&&(0,_.jsx)(eO,{onCreate:async()=>{if(await e.createItem()){let t=(0,$.P)(Q,e.state);V.push(`${ea}/item/${encodeURIComponent(t)}`)}},onDismiss:e.resetCreateItemState,config:J}),W[82]=ei.kind,W[83]=J,W[84]=e,W[85]=Q,W[86]=V,W[87]=ea,W[88]=Y):Y=W[88],W[89]!==e.resetCreateItemState||W[90]!==Y?(N=(0,_.jsx)(I.Uz,{onDismiss:e.resetCreateItemState,children:Y}),W[89]=e.resetCreateItemState,W[90]=Y,W[91]=N):N=W[91],W[92]!==L||W[93]!==H||W[94]!==N?(M=(0,_.jsxs)(_.Fragment,{children:[L,H,N]}),W[92]=L,W[93]=H,W[94]=N,W[95]=M):M=W[95],M}let tu=[{key:"reset",label:"Reset",icon:O.o},{key:"copy",label:"Copy entry",icon:N.p},{key:"paste",label:"Paste entry",icon:M.V}],th=e=>{let t,n,i=(0,a.c)(5),{children:r,title:l}=e;return i[0]!==l?(t=(0,_.jsx)(d.EY,{casing:"uppercase",color:"neutralTertiary",size:"small",weight:"bold",elementType:"h2",children:l}),i[0]=l,i[1]=t):t=i[1],i[2]!==t||i[3]!==r?(n=(0,_.jsxs)(c.so,{elementType:"section",direction:"column",gap:"medium",children:[t,r]}),i[2]=t,i[3]=r,i[4]=n):n=i[4],n},tm="fill",tf=e=>(0,_.jsx)("div",{className:(0,k.AH)({display:"grid",gap:k.Bk.size.space.large,gridAutoRows:k.Bk.size.element.xlarge,gridTemplateColumns:`[${tm}-start] 1fr [${tm}-end]`,[k.sr.above.mobile]:{gridTemplateColumns:`[${tm}-start] 1fr 1fr [${tm}-end]`},[k.sr.above.tablet]:{gridTemplateColumns:`[${tm}-start] 1fr 1fr 1fr [${tm}-end]`}}),...e}),tg=e=>{let t,n,r,l,o=(0,a.c)(12),s=(0,i.useRef)(null),{linkProps:u}=(0,x.i)(e,s);return o[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,k.xW)((0,k.AH)({color:k.Bk.color.foreground.neutral,outline:"none","&:hover":{color:k.Bk.color.foreground.neutralEmphasis,"::before":{backgroundColor:k.Bk.color.alias.backgroundIdle,borderColor:k.Bk.color.border.neutral}},"&:active":{"::before":{backgroundColor:k.Bk.color.alias.backgroundHovered,borderColor:k.Bk.color.alias.borderHovered}},"&:focus-visible::before":{outline:`${k.Bk.size.alias.focusRing} solid ${k.Bk.color.alias.focusRing}`,outlineOffset:k.Bk.size.alias.focusRingGap},"::before":{border:`${k.Bk.size.border.regular} solid ${k.Bk.color.border.muted}`,borderRadius:k.Bk.size.radius.medium,content:'""',position:"absolute",inset:0,transition:(0,k.kY)(["background-color","border-color"])}})),o[0]=t):t=o[0],o[1]!==s||o[2]!==e.href||o[3]!==e.label||o[4]!==u?(n=(0,_.jsx)(d.DZ,{elementType:"h3",size:"small",truncate:!0,children:(0,_.jsx)("a",{ref:s,href:e.href,...u,className:t,children:e.label})}),o[1]=s,o[2]=e.href,o[3]=e.label,o[4]=u,o[5]=n):n=o[5],o[6]!==n||o[7]!==e.children?(r=(0,_.jsxs)(c.so,{direction:"column",gap:"medium",flex:!0,children:[n,e.children]}),o[6]=n,o[7]=e.children,o[8]=r):r=o[8],o[9]!==r||o[10]!==e.endElement?(l=(0,_.jsxs)(c.so,{alignItems:"center",backgroundColor:"canvas",padding:"large",position:"relative",children:[r,e.endElement]}),o[9]=r,o[10]=e.endElement,o[11]=l):l=o[11],l};function tp(){let e,t,n,i,o,s,h,m,f,g,p,b,y=(0,a.c)(30),j=(0,$.c)(),x=(0,$.q)(),v=(0,$.u)(),w=(0,u.o)(C.s),k=(0,C.q)();y[0]!==j?(e=j&&(0,$.Y)(j),y[0]=j,y[1]=e):e=y[1];let S=e,P=x===(null==j?void 0:j.defaultBranch);return y[2]!==w?(t=w.format("currentBranch"),y[2]=w,y[3]=t):t=y[3],y[4]===Symbol.for("react.memo_cache_sentinel")?(n=(0,_.jsx)(l.I,{src:es.k,color:"neutralTertiary"}),y[4]=n):n=y[4],y[5]!==x?(i=(0,_.jsxs)(c.so,{alignItems:"center",gap:"regular",border:"muted",borderRadius:"medium",backgroundColor:"canvas",padding:"large",children:[n,(0,_.jsx)(d.EY,{size:"medium",weight:"semibold",children:x})]}),y[5]=x,y[6]=i):i=y[6],y[7]===Symbol.for("react.memo_cache_sentinel")?(o=(0,_.jsx)(l.I,{src:ec.I}),y[7]=o):o=y[7],y[8]!==w?(s=w.format("newBranch"),y[8]=w,y[9]=s):s=y[9],y[10]!==s?(h=(0,_.jsxs)(r.rA,{children:[o,(0,_.jsx)(d.EY,{children:s})]}),y[10]=s,y[11]=h):h=y[11],y[12]!==v?(m=e=>(0,_.jsx)(C.C,{onDismiss:e,onCreate:t=>{e(),v.push(v.href.replace(/\/branch\/[^/]+/,"/branch/"+encodeURIComponent(t)))}}),y[12]=v,y[13]=m):m=y[13],y[14]!==h||y[15]!==m?(f=(0,_.jsxs)(I.zM,{children:[h,m]}),y[14]=h,y[15]=m,y[16]=f):f=y[16],y[17]!==P||y[18]!==k||y[19]!==S||y[20]!==x||y[21]!==w?(g=!P&&void 0!==k&&(!1===k?(0,_.jsxs)(r.rA,{href:`${S}/pull/new/${x}`,target:"_blank",children:[(0,_.jsx)(l.I,{src:ed.S}),(0,_.jsx)(d.EY,{children:w.format("createPullRequest")})]}):(0,_.jsxs)(r.rA,{href:`${S}/pull/${k}`,target:"_blank",children:[(0,_.jsx)(l.I,{src:ed.S}),(0,_.jsxs)(d.EY,{children:["Pull request #",k]})]})),y[17]=P,y[18]=k,y[19]=S,y[20]=x,y[21]=w,y[22]=g):g=y[22],y[23]!==f||y[24]!==g?(p=(0,_.jsxs)(c.so,{gap:"regular",wrap:!0,children:[f,g]}),y[23]=f,y[24]=g,y[25]=p):p=y[25],y[26]!==t||y[27]!==i||y[28]!==p?(b=(0,_.jsxs)(th,{title:t,children:[i,p]}),y[26]=t,y[27]=i,y[28]=p,y[29]=b):b=y[29],b}function tb(){let e,t,n,i=(0,a.c)(9),o=(0,C.r)();if(i[0]!==o){let t;i[2]===Symbol.for("react.memo_cache_sentinel")?(t=e=>"children"in e,i[2]=t):t=i[2],e=o.some(t),i[0]=o,i[1]=e}else e=i[1];let s=e;if(i[3]!==o){let e;i[5]===Symbol.for("react.memo_cache_sentinel")?(e=e=>(function e(t){if(t.isDivider)return(0,_.jsx)(c.so,{gridColumn:tm,children:(0,_.jsx)(c.cG,{alignSelf:"center",size:"medium",width:"alias.singleLineWidth"})},ty++);if(t.children)return(0,_.jsx)(th,{title:t.title,children:(0,_.jsx)(tf,{children:t.children.map(t=>e(t))})},t.title);let n=(()=>{if(t.changed)return"number"==typeof t.changed?(0,_.jsx)(H.E,{tone:"accent",marginStart:"auto",children:(0,C.v)(t.changed,{singular:"change",plural:"changes"})}):(0,_.jsx)(H.E,{tone:"accent",children:"Changed"})})(),a="number"!=typeof t.entryCount?n:(0,_.jsxs)(c.so,{gap:"medium",alignItems:"center",children:[n,(0,_.jsx)(r.rA,{"aria-label":"Add",href:`${t.href}/create`,children:(0,_.jsx)(l.I,{src:eu.W})})]});return(0,_.jsx)(tg,{label:t.label,href:t.href,endElement:a,children:"number"==typeof t.entryCount?(0,_.jsx)(d.EY,{color:"neutralSecondary",children:(0,C.v)(t.entryCount,{singular:"entry",plural:"entries"})}):null},t.key)})(e),i[5]=e):e=i[5],t=o.map(e),i[3]=o,i[4]=t}else t=i[4];let u=t;return i[6]!==s||i[7]!==u?(n=s?(0,_.jsx)(_.Fragment,{children:u}):(0,_.jsx)(th,{title:"Content",children:(0,_.jsx)(tf,{children:u})}),i[6]=s,i[7]=u,i[8]=n):n=i[8],n}let ty=0;function tj(e){let t,n,i,r,l,o,s,h,m=(0,a.c)(19),f=(0,u.o)(C.s),g=(0,$.a1)(),p=(0,$.A)();if(m[0]!==g||m[1]!==p){var b;t=g?{name:null!=(b=g.name)?b:g.login,avatarUrl:g.avatarUrl}:null==p?void 0:p.user,m[0]=g,m[1]=p,m[2]=t}else t=m[2];let y=t;return m[3]!==f?(n=f.format("dashboard"),m[3]=f,m[4]=n):n=m[4],m[5]!==n?(i=(0,_.jsx)(C.a,{children:(0,_.jsx)(d.DZ,{elementType:"h1",id:"page-title",size:"small",children:n})}),m[5]=n,m[6]=i):i=m[6],m[7]!==y||m[8]!==p?(r=y&&(0,_.jsx)(tx,{user:y,manageAccount:!!p}),m[7]=y,m[8]=p,m[9]=r):r=m[9],m[10]!==e.config?(l=!(0,$.r)(e.config)&&(0,_.jsx)(tp,{}),m[10]=e.config,m[11]=l):l=m[11],m[12]===Symbol.for("react.memo_cache_sentinel")?(o=(0,_.jsx)(tb,{}),m[12]=o):o=m[12],m[13]!==r||m[14]!==l?(s=(0,_.jsx)(C.i,{isScrollable:!0,children:(0,_.jsxs)(c.so,{direction:"column",gap:"xxlarge",children:[r,l,o]})}),m[13]=r,m[14]=l,m[15]=s):s=m[15],m[16]!==i||m[17]!==s?(h=(0,_.jsxs)(C.P,{containerWidth:"large",children:[i,s]}),m[16]=i,m[17]=s,m[18]=h):h=m[18],h}function tx(e){let t,n,i,r,l,o,s,u=(0,a.c)(15),{user:h,manageAccount:m}=e;return u[0]===Symbol.for("react.memo_cache_sentinel")?(t={below:"tablet"},u[0]=t):t=u[0],u[1]!==h.avatarUrl||u[2]!==h.name?(n=(0,_.jsx)(Z.e,{src:h.avatarUrl,name:h.name,size:"large"}),u[1]=h.avatarUrl,u[2]=h.name,u[3]=n):n=u[3],u[4]===Symbol.for("react.memo_cache_sentinel")?(i={fontWeight:k.Bk.typography.fontWeight.bold},u[4]=i):i=u[4],u[5]!==h.name?(r=(0,_.jsxs)(d.DZ,{size:"medium",elementType:"p",UNSAFE_style:i,children:["Hello, ",h.name,"!"]}),u[5]=h.name,u[6]=r):r=u[6],u[7]!==m?(l=m&&(0,_.jsx)(x.Y,{href:"https://keystatic.cloud/account",children:"Manage Account"}),u[7]=m,u[8]=l):l=u[8],u[9]!==r||u[10]!==l?(o=(0,_.jsxs)(c.Tk,{gap:"medium",children:[r,l]}),u[9]=r,u[10]=l,u[11]=o):o=u[11],u[12]!==n||u[13]!==o?(s=(0,_.jsxs)(c.so,{alignItems:"center",gap:"medium",isHidden:t,children:[n,o]}),u[12]=n,u[13]=o,u[14]=s):s=u[14],s}let tv=e=>{let t,n,r,l,o=(0,a.c)(13),s=(0,k.Ub)(k.C3.below.desktop),c=(0,C.w)(),d=(0,i.useRef)(null),u=(0,$.a2)(d),h=s||!c.isOpen;return o[0]!==s?(t=s?(0,_.jsx)(C.S,{}):(0,_.jsx)(U.f5,{children:(0,_.jsx)(C.x,{})}),o[0]=s,o[1]=t):t=o[1],o[2]!==d||o[3]!==e.children?(n=(0,_.jsx)(U.xQ,{ref:d,children:e.children}),o[2]=d,o[3]=e.children,o[4]=n):n=o[4],o[5]!==h||o[6]!==c.toggle||o[7]!==t||o[8]!==n?(r=(0,_.jsxs)(U.U_,{autoSaveId:"keystatic-app-split-view",isCollapsed:h,onCollapseChange:c.toggle,defaultSize:260,minSize:180,maxSize:400,height:"100vh",children:[t,n]}),o[5]=h,o[6]=c.toggle,o[7]=t,o[8]=n,o[9]=r):r=o[9],o[10]!==u||o[11]!==r?(l=(0,_.jsx)($.a3,{value:u,children:r}),o[10]=u,o[11]=r,o[12]=l):l=o[12],l};function tw(e){var t;let n=(0,a.c)(2),r=(0,$.a9)(),l=(0,$.q)(),o=(0,i.useContext)($.aa);if((null==o||null==(t=o.data)||null==(t=t.repository)||null==(t=t.refs)?void 0:t.pageInfo.hasNextPage)===!1&&!r.has(l)){let e,t=`The branch ${l} does not exist in this repository.`;return n[0]!==t?(e=(0,_.jsx)(em,{icon:m.a,title:"Branch not found",message:t}),n[0]=t,n[1]=e):e=n[1],e}return e.children}let tk=e=>{let t,n,i,r,l,o=(0,a.c)(19);o[0]!==e.children?(t=(0,_.jsx)($.a4.Consumer,{children:t=>t&&!(null!=t&&t.graphQLErrors.some(e=>{var t;return(null==e||null==(t=e.originalError)?void 0:t.type)==="NOT_FOUND"}))?(0,_.jsx)(em,{icon:m.a,title:"Failed to load shell",message:t.message}):e.children}),o[0]=e.children,o[1]=t):t=o[1];let s=t;o[2]!==e.basePath?(n={basePath:e.basePath},o[2]=e.basePath,o[3]=n):n=o[3],o[4]!==s?(i=(0,_.jsx)(C.y,{children:(0,_.jsx)(tv,{children:(0,_.jsx)(tw,{children:s})})}),o[4]=s,o[5]=i):i=o[5],o[6]!==n||o[7]!==i?(r=(0,_.jsx)($.a5.Provider,{value:n,children:i}),o[6]=n,o[7]=i,o[8]=r):r=o[8],o[9]!==e.config||o[10]!==r?(l=(0,_.jsx)($.a6.Provider,{value:e.config,children:r}),o[9]=e.config,o[10]=r,o[11]=l):l=o[11];let c=l;if((0,$._)(e.config)||"cloud"===e.config.storage.kind){let t;return o[12]!==e.currentBranch||o[13]!==e.config||o[14]!==c?(t=(0,_.jsx)($.a7,{currentBranch:e.currentBranch,config:e.config,children:c}),o[12]=e.currentBranch,o[13]=e.config,o[14]=c,o[15]=t):t=o[15],t}if((0,$.r)(e.config)){let t;return o[16]!==e.config||o[17]!==c?(t=(0,_.jsx)($.a8,{config:e.config,children:c}),o[16]=e.config,o[17]=c,o[18]=t):t=o[18],t}return null};function tS(e){let t,n,o,u,h,m,f,g,p,b,y,j,x,w,S,P,E,F,R,U,T,A,D,L,Y,q,G,V,J,Q,Z,X,ee=(0,a.c)(96),et=(0,k.Ub)(k.C3.below.desktop),en=(0,$.c)(),ea=(0,$.q)(),[ei,er]=(0,i.useState)(!1),{schema:el,singletonConfig:eo}=e1(e.singleton),es=(0,$.u)();e:{let e;if(!eo.previewUrl){t=void 0;break e}ee[0]!==eo.previewUrl||ee[1]!==ea?(e=eo.previewUrl.replace("{branch}",ea),ee[0]=eo.previewUrl,ee[1]=ea,ee[2]=e):e=ee[2],t=e}let ec=t;ee[3]!==e.config?(n=(0,$._)(e.config)||(0,$.ad)(e.config),ee[3]=e.config,ee[4]=n):n=ee[4];let ed=n;if(ee[5]!==e.config||ee[6]!==e.singleton||ee[7]!==e.initialState||ee[8]!==ed||ee[9]!==en||ee[10]!==ea){var eu,eh;u=(0,$.ab)(e.config,e.singleton);let t=!!e.initialState,n=(0,$.ac)(e.config,e.singleton);o=ed&&t&&en?`${(0,$.Y)(en)}${"index"===u.dataLocation?`/tree/${ea}/${null!=(eu=(0,$.l)(e.config.storage))?eu:""}${n}`:`/blob/${null!=(eh=(0,$.l)(e.config.storage))?eh:""}${ea}/${n}${(0,$.Z)(u)}`}`:void 0,ee[5]=e.config,ee[6]=e.singleton,ee[7]=e.initialState,ee[8]=ed,ee[9]=en,ee[10]=ea,ee[11]=o,ee[12]=u}else o=ee[11],u=ee[12];let em=o;if(ee[13]===Symbol.for("react.memo_cache_sentinel")?(m={key:"reset",label:"Reset",icon:O.o},ee[13]=m):m=ee[13],ee[14]===Symbol.for("react.memo_cache_sentinel")?(f={key:"copy",label:"Copy entry",icon:N.p},ee[14]=f):f=ee[14],ee[15]===Symbol.for("react.memo_cache_sentinel")?(g={key:"paste",label:"Paste entry",icon:M.V},ee[15]=g):g=ee[15],ee[16]!==ec||ee[17]!==em){if(p=[m,f,g],ec){let e;ee[19]!==ec?(e={key:"preview",label:"Preview",icon:W.X,href:ec,target:"_blank",rel:"noopener noreferrer"},ee[19]=ec,ee[20]=e):e=ee[20],p.push(e)}if(em){let e;ee[21]!==em?(e={key:"view",label:"View on GitHub",icon:s.F,href:em,target:"_blank",rel:"noopener noreferrer"},ee[21]=em,ee[22]=e):e=ee[22],p.push(e)}ee[16]=ec,ee[17]=em,ee[18]=p}else p=ee[18];h=p;let ef=(0,$.b)(),eg=null===e.initialState;ee[23]!==e||ee[24]!==el?(b=async()=>{if("loading"!==e.updateResult.kind&&e.hasChanged){if(!(0,C.m)(el,e.state,void 0))return void er(!0);await e.onUpdate()}},ee[23]=e,ee[24]=el,ee[25]=b):b=ee[25];let ep=b;ee[26]!==e.state||ee[27]!==u||ee[28]!==eo.schema?(y=()=>{e6(e.state,u,eo.schema,void 0)},ee[26]=e.state,ee[27]=u,ee[28]=eo.schema,ee[29]=y):y=ee[29];let eb=y;ee[30]!==u||ee[31]!==eo.schema||ee[32]!==e.previewProps||ee[33]!==e.state?(j=async()=>{let t=await e5(u,eo.schema,void 0);t&&((0,C.n)(t,e.previewProps),z.n.positive("Entry pasted",{shouldCloseOnAction:!0,actionLabel:"Undo",onAction:()=>{(0,C.n)(e.state,e.previewProps)}}))},ee[30]=u,ee[31]=eo.schema,ee[32]=e.previewProps,ee[33]=e.state,ee[34]=j):j=ee[34];let ey=j;ee[35]!==eo?(x=(0,C.j)(eo),ee[35]=eo,ee[36]=x):x=ee[36],ee[37]!==eo.label?(w=(0,_.jsx)(d.DZ,{elementType:"h1",id:"page-title",size:"small",children:eo.label}),ee[37]=eo.label,ee[38]=w):w=ee[38],ee[39]!==e||ee[40]!==eo?(S="loading"===e.updateResult.kind?(0,_.jsx)(v.a3,{"aria-label":`Updating ${eo.label}`,isIndeterminate:!0,size:"small",alignSelf:"center"}):e.hasChanged&&(0,_.jsx)(H.E,{tone:"pending",children:"Unsaved"}),ee[39]=e,ee[40]=eo,ee[41]=S):S=ee[41],ee[42]!==w||ee[43]!==S?(P=(0,_.jsxs)(c.so,{flex:!0,alignItems:"center",gap:"regular",children:[w,S]}),ee[42]=w,ee[43]=S,ee[44]=P):P=ee[44],ee[45]===Symbol.for("react.memo_cache_sentinel")?(E=(0,_.jsx)(eB,{}),ee[45]=E):E=ee[45];let ej=et?"element.regular":void 0;ee[46]!==e.hasChanged?(F=e.hasChanged?[]:["reset"],ee[46]=e.hasChanged,ee[47]=F):F=ee[47],ee[48]!==e||ee[49]!==eb||ee[50]!==ey?(R=t=>{switch(t){case"reset":e.onReset();break;case"copy":eb();break;case"paste":ey()}},ee[48]=e,ee[49]=eb,ee[50]=ey,ee[51]=R):R=ee[51],ee[52]===Symbol.for("react.memo_cache_sentinel")?(U=e=>(0,_.jsxs)(B.q,{textValue:e.label,href:e.href,target:e.target,rel:e.rel,children:[(0,_.jsx)(l.I,{src:e.icon}),(0,_.jsx)(d.EY,{children:e.label})]},e.key),ee[52]=U):U=ee[52],ee[53]!==ej||ee[54]!==h||ee[55]!==F||ee[56]!==R?(T=(0,_.jsx)(B.K,{buttonLabelBehavior:"hide",overflowMode:"collapse",prominence:"low",density:"compact",maxWidth:ej,items:h,disabledKeys:F,onAction:R,children:U}),ee[53]=ej,ee[54]=h,ee[55]=F,ee[56]=R,ee[57]=T):T=ee[57];let ex="loading"===e.updateResult.kind,ev=eg?"Create":"Save";ee[58]!==ex||ee[59]!==ev?(A=(0,_.jsx)(r.$n,{form:"singleton-form",isDisabled:ex,prominence:"high",type:"submit",children:ev}),ee[58]=ex,ee[59]=ev,ee[60]=A):A=ee[60],ee[61]!==P||ee[62]!==T||ee[63]!==A?(D=(0,_.jsxs)(C.a,{children:[P,E,T,A]}),ee[61]=P,ee[62]=T,ee[63]=A,ee[64]=D):D=ee[64],ee[65]!==ep?(L=e=>{e.target===e.currentTarget&&(e.preventDefault(),ep())},ee[65]=ep,ee[66]=L):L=ee[66],ee[67]!==e.updateResult?(Y="error"===e.updateResult.kind&&(0,_.jsx)(K.$,{tone:"critical",children:e.updateResult.error.message}),ee[67]=e.updateResult,ee[68]=Y):Y=ee[68];let ew=e.previewProps;return ee[69]!==ew||ee[70]!==ei||ee[71]!==eo.entryLayout||ee[72]!==u?(q=(0,_.jsx)(C.F,{previewProps:ew,forceValidation:ei,entryLayout:eo.entryLayout,formatInfo:u,slugField:void 0}),ee[69]=ew,ee[70]=ei,ee[71]=eo.entryLayout,ee[72]=u,ee[73]=q):q=ee[73],ee[74]!==e||ee[75]!==es||ee[76]!==ef?(G="needs-new-branch"===e.updateResult.kind&&(0,_.jsx)(tn,{branchOid:ef,onCreate:async t=>{es.push(`/keystatic/branch/${encodeURIComponent(t)}/singleton/${encodeURIComponent(e.singleton)}`),e.onUpdate({branch:t,sha:ef})},reason:e.updateResult.reason,onDismiss:e.onResetUpdateItem}),ee[74]=e,ee[75]=es,ee[76]=ef,ee[77]=G):G=ee[77],ee[78]!==e.onResetUpdateItem||ee[79]!==G?(V=(0,_.jsx)(I.Uz,{onDismiss:e.onResetUpdateItem,children:G}),ee[78]=e.onResetUpdateItem,ee[79]=G,ee[80]=V):V=ee[80],ee[81]!==e?(J="needs-fork"===e.updateResult.kind&&(0,$._)(e.config)&&(0,_.jsx)(eO,{onCreate:async()=>{e.onUpdate()},onDismiss:e.onResetUpdateItem,config:e.config}),ee[81]=e,ee[82]=J):J=ee[82],ee[83]!==e.onResetUpdateItem||ee[84]!==J?(Q=(0,_.jsx)(I.Uz,{onDismiss:e.onResetUpdateItem,children:J}),ee[83]=e.onResetUpdateItem,ee[84]=J,ee[85]=Q):Q=ee[85],ee[86]!==L||ee[87]!==Y||ee[88]!==q||ee[89]!==V||ee[90]!==Q?(Z=(0,_.jsxs)(c.so,{elementType:"form",id:"singleton-form",onSubmit:L,direction:"column",gap:"xxlarge",height:"100%",minHeight:0,minWidth:0,children:[Y,q,V,Q]}),ee[86]=L,ee[87]=Y,ee[88]=q,ee[89]=V,ee[90]=Q,ee[91]=Z):Z=ee[91],ee[92]!==x||ee[93]!==D||ee[94]!==Z?(X=(0,_.jsxs)(C.P,{containerWidth:x,children:[D,Z]}),ee[92]=x,ee[93]=D,ee[94]=Z,ee[95]=X):X=ee[95],X}function tC(e){let t,n,r,l,o,s,c,d,u,h=(0,a.c)(49),{singleton:m,initialFiles:f,initialState:g,localTreeKey:p,config:b,draft:y}=e,{schema:j,singletonConfig:x}=e1(e.singleton);h[0]!==b||h[1]!==m?(t=(0,$.ac)(b,m),h[0]=b,h[1]=m,h[2]=t):t=h[2];let v=t;h[3]!==p||h[4]!==y||h[5]!==g||h[6]!==j?(n=()=>{var e;return{localTreeKey:p,state:null!=(e=null==y?void 0:y.state)?e:null===g?(0,C.o)(j):g}},h[3]=p,h[4]=y,h[5]=g,h[6]=j,h[7]=n):n=h[7];let[w,k]=(0,i.useState)(n),{state:S,localTreeKey:P}=w;(0,$.V)(y,S,p),P!==p&&k({localTreeKey:p,state:null===g?(0,C.o)(j):g});let I=null===g,E=eJ({initialState:g,state:S,schema:j,slugField:void 0})||I;h[8]!==m||h[9]!==E||h[10]!==v||h[11]!==b||h[12]!==x.schema||h[13]!==S||h[14]!==p?(r=()=>{let e=["singleton",m];if(E){let t={beforeTreeKey:p,files:new Map(eW({basePath:v,format:(0,$.ab)(b,m),schema:x.schema,slug:void 0,state:S}).map(e=>[e.path,e.contents])),savedAt:new Date,version:1};(0,$.$)(e,t)}else(0,$.a0)(e)},h[8]=m,h[9]=E,h[10]=v,h[11]=b,h[12]=x.schema,h[13]=S,h[14]=p,h[15]=r):r=h[15],h[16]!==b||h[17]!==p||h[18]!==S||h[19]!==E||h[20]!==m||h[21]!==v||h[22]!==x?(l=[b,p,S,E,m,v,x],h[16]=b,h[17]=p,h[18]=S,h[19]=E,h[20]=m,h[21]=v,h[22]=x,h[23]=l):l=h[23],(0,i.useEffect)(r,l),h[24]===Symbol.for("react.memo_cache_sentinel")?(o=e=>{k(t=>({localTreeKey:t.localTreeKey,state:e(t.state)}))},h[24]=o):o=h[24];let F=eZ(j,o,S);h[25]!==b||h[26]!==m?(s=(0,$.ab)(b,m),h[25]=b,h[26]=m,h[27]=s):s=h[27];let R=s;h[28]!==S||h[29]!==f||h[30]!==b||h[31]!==x.schema||h[32]!==v||h[33]!==R||h[34]!==p?(c={state:S,initialFiles:f,config:b,schema:x.schema,basePath:v,format:R,currentLocalTreeKey:p,slug:void 0},h[28]=S,h[29]=f,h[30]=b,h[31]=x.schema,h[32]=v,h[33]=R,h[34]=p,h[35]=c):c=h[35];let[U,T,A]=eq(c),D=(0,$.W)(T);h[36]!==p||h[37]!==g||h[38]!==j?(d=()=>k({localTreeKey:p,state:null===g?(0,C.o)(j):g}),h[36]=p,h[37]=g,h[38]=j,h[39]=d):d=h[39];let L=d;return h[40]!==e||h[41]!==E||h[42]!==L||h[43]!==D||h[44]!==A||h[45]!==U||h[46]!==S||h[47]!==F?(u=(0,_.jsx)(tS,{...e,hasChanged:E,onReset:L,onUpdate:D,onResetUpdateItem:A,updateResult:U,state:S,previewProps:F}),h[40]=e,h[41]=E,h[42]=L,h[43]=D,h[44]=A,h[45]=U,h[46]=S,h[47]=F,h[48]=u):u=h[48],u}function t$(e){let t,n,i,r,l,o=(0,a.c)(27),{singleton:s,initialFiles:c,initialState:d,localTreeKey:u,config:h}=e,{schema:m,singletonConfig:f}=e1(e.singleton);o[0]!==h||o[1]!==s?(t=(0,$.ac)(h,s),o[0]=h,o[1]=s,o[2]=t):t=o[2];let g=t,p=eQ(m,e.map),b=eX(m,e.map,p),y=null===d,j=eJ({initialState:d,state:p,schema:m,slugField:void 0})||y;o[3]!==h||o[4]!==s?(n=(0,$.ab)(h,s),o[3]=h,o[4]=s,o[5]=n):n=o[5];let x=n;o[6]!==p||o[7]!==c||o[8]!==h||o[9]!==f.schema||o[10]!==g||o[11]!==x||o[12]!==u?(i={state:p,initialFiles:c,config:h,schema:f.schema,basePath:g,format:x,currentLocalTreeKey:u,slug:void 0},o[6]=p,o[7]=c,o[8]=h,o[9]=f.schema,o[10]=g,o[11]=x,o[12]=u,o[13]=i):i=o[13];let[v,w,k]=eq(i),S=(0,$.W)(w);o[14]!==e.map||o[15]!==e.initialState||o[16]!==f.schema?(r=()=>{e.map.doc.transact(()=>{for(let[a,i]of Object.entries(f.schema)){var t,n;let r=eR(i,null!=(t=null==(n=e.initialState)?void 0:n[a])?t:(0,C.o)(i));e.map.set(a,r)}})},o[14]=e.map,o[15]=e.initialState,o[16]=f.schema,o[17]=r):r=o[17];let P=r;return o[18]!==e||o[19]!==j||o[20]!==P||o[21]!==S||o[22]!==k||o[23]!==v||o[24]!==p||o[25]!==b?(l=(0,_.jsx)(tS,{...e,hasChanged:j,onReset:P,onUpdate:S,onResetUpdateItem:k,updateResult:v,state:p,previewProps:b}),o[18]=e,o[19]=j,o[20]=P,o[21]=S,o[22]=k,o[23]=v,o[24]=p,o[25]=b,o[26]=l):l=o[26],l}let t_=L.NW({version:L.eu(1),savedAt:L.p6(),beforeTreeKey:L.lq(L.Yj()),files:L.Tj(L.Yj(),L.KJ(Uint8Array))});function tP(e){var t;let n,i,r,l,o,s,u,h,m,f=(0,a.c)(55),g=null==(t=e.config.singletons)?void 0:t[e.singleton];g||ep(),f[0]!==g.label?(n=(0,_.jsx)(C.a,{children:(0,_.jsx)(d.DZ,{elementType:"h1",id:"page-title",size:"small",children:g.label})}),f[0]=g.label,f[1]=n):n=f[1];let p=n;f[2]!==e.config||f[3]!==e.singleton?(r=(0,$.ab)(e.config,e.singleton),f[2]=e.config,f[3]=e.singleton,f[4]=r):r=f[4],i=r,f[5]!==e.config||f[6]!==e.singleton?(l=(0,$.ac)(e.config,e.singleton),f[5]=e.config,f[6]=e.singleton,f[7]=l):l=f[7];let b=l;f[8]!==e.singleton||f[9]!==b||f[10]!==i||f[11]!==g.schema?(o=async()=>{let t=await (0,$.R)(["singleton",e.singleton]);if(!t)throw Error("No draft found");let n=t_.create(t);return{state:ex({dirpath:b,format:i,schema:g.schema,slug:void 0},n.files).initialState,savedAt:n.savedAt,treeKey:n.beforeTreeKey}},f[8]=e.singleton,f[9]=b,f[10]=i,f[11]=g.schema,f[12]=o):o=f[12];let y=(0,$.f)(o);f[13]!==e.config||f[14]!==b||f[15]!==g.schema||f[16]!==i?(s={config:e.config,dirpath:b,schema:g.schema,format:i,slug:void 0},f[13]=e.config,f[14]=b,f[15]=g.schema,f[16]=i,f[17]=s):s=f[17];let j=ev(s),x=(0,$.q)(),w=`${x}/${e.singleton}`,k=(0,$.S)(),S="loading"===j.kind;f[18]!==k||f[19]!==S||f[20]!==w?(u=async()=>{if(!k)return;if("loading"===k||(await k.doc.whenSynced,S))return $.L;let e=k.data.get(w);if(e instanceof D.JA){let t=e.whenLoaded;e.load(),await t}else e=new D.JA,k.data.set(w,e);return e.getMap("data")},f[18]=k,f[19]=S,f[20]=w,f[21]=u):u=f[21];let P=(0,$.f)(u);if("loaded"===P.kind&&"loaded"===j.kind&&P.data&&!P.data.size){let e=P.data;e.doc.transact(()=>{for(let[t,n]of Object.entries(g.schema)){let a=eR(n,"not-found"===j.data?(0,C.o)(n):j.data.initialState[t]);e.set(t,a)}})}if("error"===j.kind){let e,t;return f[22]!==j.error.message?(e=(0,_.jsx)(C.i,{children:(0,_.jsx)(K.$,{margin:"xxlarge",tone:"critical",children:j.error.message})}),f[22]=j.error.message,f[23]=e):e=f[23],f[24]!==p||f[25]!==e?(t=(0,_.jsxs)(C.P,{children:[p,e]}),f[24]=p,f[25]=e,f[26]=t):t=f[26],t}if("error"===P.kind){let e,t;return f[27]!==P.error.message?(e=(0,_.jsx)(C.i,{children:(0,_.jsx)(K.$,{margin:"xxlarge",tone:"critical",children:P.error.message})}),f[27]=P.error.message,f[28]=e):e=f[28],f[29]!==p||f[30]!==e?(t=(0,_.jsxs)(C.P,{children:[p,e]}),f[29]=p,f[30]=e,f[31]=t):t=f[31],t}if("loading"===j.kind||"loading"===y.kind||"loading"===P.kind){let e,t,n=`Loading ${g.label}`;return f[32]!==n?(e=(0,_.jsx)(C.i,{children:(0,_.jsx)(c.so,{alignItems:"center",justifyContent:"center",minHeight:"scale.3000",children:(0,_.jsx)(v.a3,{"aria-label":n,isIndeterminate:!0,size:"large"})})}),f[32]=n,f[33]=e):e=f[33],f[34]!==p||f[35]!==e?(t=(0,_.jsxs)(C.P,{children:[p,e]}),f[34]=p,f[35]=e,f[36]=t):t=f[36],t}if(P.data){let t,n,a="not-found"===j.data?null:j.data.initialState;f[37]!==j.data?(t="not-found"===j.data?[]:j.data.initialFiles,f[37]=j.data,f[38]=t):t=f[38];let i="not-found"===j.data?void 0:j.data.localTreeKey;return f[39]!==e.singleton||f[40]!==e.config||f[41]!==a||f[42]!==t||f[43]!==i||f[44]!==P.data?(n=(0,_.jsx)(t$,{singleton:e.singleton,config:e.config,initialState:a,initialFiles:t,localTreeKey:i,map:P.data}),f[39]=e.singleton,f[40]=e.config,f[41]=a,f[42]=t,f[43]=i,f[44]=P.data,f[45]=n):n=f[45],n}let I="not-found"===j.data?null:j.data.initialState;f[46]!==j.data?(h="not-found"===j.data?[]:j.data.initialFiles,f[46]=j.data,f[47]=h):h=f[47];let E="not-found"===j.data?void 0:j.data.localTreeKey,F="loaded"===y.kind?y.data:void 0;return f[48]!==e.singleton||f[49]!==e.config||f[50]!==I||f[51]!==h||f[52]!==E||f[53]!==F?(m=(0,_.jsx)(tC,{singleton:e.singleton,config:e.config,initialState:I,initialFiles:h,localTreeKey:E,draft:F}),f[48]=e.singleton,f[49]=e.config,f[50]=I,f[51]=h,f[52]=E,f[53]=F,f[54]=m):m=f[54],m}function tI(e){let t,n,i,r,l,o,s=(0,a.c)(11);return s[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,_.jsx)(d.DZ,{children:"You've installed Keystatic! \uD83C\uDF89"}),s[0]=t):t=s[0],s[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,_.jsx)(d.EY,{children:"To start using Keystatic, you need to install the GitHub app you've created."}),s[1]=n):n=s[1],s[2]!==e.config.storage.repo?(i=(0,$.k)(e.config.storage.repo),s[2]=e.config.storage.repo,s[3]=i):i=s[3],s[4]!==i?(r=(0,_.jsxs)(d.EY,{children:["Make sure to add the App to the"," ",(0,_.jsx)("code",{children:i})," ","repository."]}),s[4]=i,s[5]=r):r=s[5],s[6]!==e.config?(l=(0,_.jsx)(eL,{config:e.config}),s[6]=e.config,s[7]=l):l=s[7],s[8]!==r||s[9]!==l?(o=(0,_.jsx)(c.so,{alignItems:"center",justifyContent:"center",margin:"xxlarge",children:(0,_.jsxs)(c.so,{backgroundColor:"surface",padding:"large",border:"color.alias.borderIdle",borderRadius:"medium",direction:"column",justifyContent:"center",gap:"xlarge",maxWidth:"scale.4600",children:[t,n,r,l]})}),s[8]=r,s[9]=l,s[10]=o):o=s[10],o}function tE(e){let t,n,l,o,s,u,h,m,f,g,p,b,y,j=(0,a.c)(22),[x,v]=(0,i.useState)(""),[w,S]=(0,i.useState)(""),C=`https://github.com${w?`/organizations/${w}`:""}/settings/apps/new`;return j[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,_.jsx)(c.so,{justifyContent:"center",children:(0,_.jsx)(d.DZ,{children:"Keystatic Setup"})}),j[0]=t):t=j[0],j[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,_.jsx)(d.EY,{children:"Keystatic doesn't have the required config."}),j[1]=n):n=j[1],j[2]===Symbol.for("react.memo_cache_sentinel")?(l=(0,_.jsx)(d.EY,{children:"If you've already created your GitHub app, make sure to add the following environment variables:"}),j[2]=l):l=j[2],j[3]===Symbol.for("react.memo_cache_sentinel")?(o=(0,_.jsxs)(c.az,{elementType:"ul",children:[(0,_.jsx)("li",{children:(0,_.jsx)("code",{children:"KEYSTATIC_GITHUB_CLIENT_ID"})}),(0,_.jsx)("li",{children:(0,_.jsx)("code",{children:"KEYSTATIC_GITHUB_CLIENT_SECRET"})}),(0,_.jsx)("li",{children:(0,_.jsx)("code",{children:"KEYSTATIC_SECRET"})})]}),j[3]=o):o=j[3],j[4]===Symbol.for("react.memo_cache_sentinel")?(s=(0,_.jsx)(d.EY,{children:"If you haven't created your GitHub app for Keystatic, you can create one below."}),j[4]=s):s=j[4],j[5]!==x?(u=(0,_.jsx)(T.A_,{label:"Deployed App URL",description:"This should the root of your domain. If you're not sure where Keystatic will be deployed, leave this blank and you can update the GitHub app later.",value:x,onChange:v}),j[5]=x,j[6]=u):u=j[6],j[7]!==w?(h=(0,_.jsx)(T.A_,{label:"GitHub organization (if any)",description:"You must be an owner or GitHub App manager in the organization to create the GitHub App. Leave this blank to create the app in your personal account.",value:w,onChange:S}),j[7]=w,j[8]=h):h=j[8],j[9]===Symbol.for("react.memo_cache_sentinel")?(m=(0,_.jsxs)(d.EY,{children:["After visiting GitHub to create the GitHub app, you'll be redirected back here and secrets generated from GitHub will be written to your"," ",(0,_.jsx)("code",{children:".env"})," file."]}),j[9]=m):m=j[9],j[10]===Symbol.for("react.memo_cache_sentinel")?(f=(0,k.AH)({display:"none"}),j[10]=f):f=j[10],j[11]!==e.config.storage.repo||j[12]!==x?(g=JSON.stringify({name:`${(0,$.y)(e.config.storage.repo).owner} Keystatic`,url:x?new URL("/keystatic",x).toString():`${window.location.origin}/keystatic`,public:!0,redirect_url:`${window.location.origin}/api/keystatic/github/created-app`,callback_urls:[`${window.location.origin}/api/keystatic/github/oauth/callback`,"http://127.0.0.1/api/keystatic/github/oauth/callback",...x?[new URL("/api/keystatic/github/oauth/callback",x).toString()]:[]],request_oauth_on_install:!0,default_permissions:{contents:"write",metadata:"read",pull_requests:"read"}}),j[11]=e.config.storage.repo,j[12]=x,j[13]=g):g=j[13],j[14]!==g?(p=(0,_.jsx)("input",{type:"text",name:"manifest",className:f,value:g}),j[14]=g,j[15]=p):p=j[15],j[16]===Symbol.for("react.memo_cache_sentinel")?(b=(0,_.jsx)(r.$n,{prominence:"high",type:"submit",children:"Create GitHub App"}),j[16]=b):b=j[16],j[17]!==C||j[18]!==u||j[19]!==h||j[20]!==p?(y=(0,_.jsx)(c.so,{alignItems:"center",justifyContent:"center",margin:"xxlarge",children:(0,_.jsxs)(c.so,{backgroundColor:"surface",padding:"large",border:"color.alias.borderIdle",borderRadius:"medium",direction:"column",justifyContent:"center",gap:"xlarge",maxWidth:"scale.4600",elementType:"form",action:C,method:"post",children:[t,n,l,o,s,u,h,m,p,b]})}),j[17]=C,j[18]=u,j[19]=h,j[20]=p,j[21]=y):y=j[21],y}function tF(e){let t,n,i,r,l,o=(0,a.c)(11);o[0]!==e.config.storage.repo?(t=(0,$.k)(e.config.storage.repo),o[0]=e.config.storage.repo,o[1]=t):t=o[1];let s=t;o[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,_.jsx)(c.so,{justifyContent:"center",children:(0,_.jsx)(d.DZ,{children:"Repo not found"})}),o[2]=n):n=o[2];let u=`https://github.com/${s}`;return o[3]!==u||o[4]!==s?(i=(0,_.jsxs)(d.EY,{children:["Keystatic is configured for the"," ",(0,_.jsx)("a",{href:u,children:s})," GitHub repo but Keystatic isn't able to access this repo. This is either because you don't have access to this repo or you haven't added the GitHub app to it."]}),o[3]=u,o[4]=s,o[5]=i):i=o[5],o[6]!==e.config?(r=(0,_.jsx)(eL,{config:e.config}),o[6]=e.config,o[7]=r):r=o[7],o[8]!==i||o[9]!==r?(l=(0,_.jsx)(c.so,{alignItems:"center",justifyContent:"center",margin:"xxlarge",children:(0,_.jsxs)(c.so,{backgroundColor:"surface",padding:"large",border:"color.alias.borderIdle",borderRadius:"medium",direction:"column",justifyContent:"center",gap:"xlarge",maxWidth:"scale.4600",children:[n,i,r]})}),o[8]=i,o[9]=r,o[10]=l):l=o[10],l}let tR=L.Ik({state:L.Yj(),from:L.Yj(),code_verifier:L.Yj()}),tU=L.NW({access_token:L.Yj(),token_type:L.Yj(),expires_in:L.ai()});function tT({config:e}){var t;let n=(0,$.u)(),a=new URL(window.location.href),r=a.searchParams.get("code"),l=a.searchParams.get("state"),o=(0,i.useMemo)(()=>{let e=localStorage.getItem("keystatic-cloud-state");try{return tR.create(JSON.parse(e||""))}catch{return null}},[]),[s,u]=(0,i.useState)(null);return((0,i.useEffect)(()=>{var t;if(r&&l&&o&&null!=(t=e.cloud)&&t.project){let{project:t}=e.cloud;(async()=>{let e=await fetch(`${$.K}/oauth/token`,{method:"POST",body:new URLSearchParams({code:r,client_id:t,redirect_uri:`${window.location.origin}/keystatic/cloud/oauth/callback`,code_verifier:o.code_verifier,grant_type:"authorization_code"}).toString(),headers:{"Content-Type":"application/x-www-form-urlencoded",...$.n}});if(!e.ok)throw Error(`Bad response: ${e.status} ${e.statusText}

${await e.text()}`);let a=await e.json(),i=tU.create(a);localStorage.setItem("keystatic-cloud-access-token",JSON.stringify({token:i.access_token,project:t,validUntil:Date.now()+1e3*i.expires_in})),n.push(`/keystatic/${o.from}`)})().catch(e=>{u(e)})}},[r,l,n,o,e]),null!=(t=e.cloud)&&t.project)?r&&l?o&&l===o.state?s?(0,_.jsx)(d.EY,{children:s.message}):(0,_.jsx)(c.so,{justifyContent:"center",alignItems:"center",height:"100vh",children:(0,_.jsx)(v.a3,{size:"large",isIndeterminate:!0,"aria-label":"Authenticating"})}):(0,_.jsx)(d.EY,{children:"Invalid state"}):(0,_.jsx)(d.EY,{children:"Missing code or state"}):(0,_.jsx)(d.EY,{children:"Missing Keystatic Cloud config"})}function tA(e){if(0===e.length)return{};if(2===e.length&&"singleton"===e[0])return{singleton:e[1]};if(e.length<2||"collection"!==e[0])return null;let t=e[1];return 2===e.length?{collection:t}:3===e.length&&"create"===e[2]?{collection:t,kind:"create"}:4===e.length&&"item"===e[2]?{collection:t,kind:"edit",slug:e[3]}:null}function tD(e){let t,n,r=(0,a.c)(6),{push:l}=(0,$.u)(),{data:o,error:s}=(0,i.useContext)($.aa);return r[0]!==s||r[1]!==e.config||r[2]!==o||r[3]!==l?(t=()=>{var t,n,a,i,r;(null==s||null==(t=s.response)?void 0:t.status)===401&&("github"===e.config.storage.kind?window.location.href="/api/keystatic/github/login":(0,$.D)("",e.config)),null!=o&&null!=(n=o.repository)&&n.defaultBranchRef&&l(`/keystatic/branch/${encodeURIComponent(o.repository.defaultBranchRef.name)}`),("github"!==e.config.storage.kind||null!=o&&null!=(a=o.repository)&&a.id||(null==s||null==(i=s.graphQLErrors)||null==(i=i[0])||null==(i=i.originalError)?void 0:i.type)!=="NOT_FOUND")&&(null==s||null==(r=s.graphQLErrors)||null==(r=r[0])||null==(r=r.originalError)?void 0:r.type)!=="FORBIDDEN"||(window.location.href="/api/keystatic/github/repo-not-found")},n=[o,s,l,e.config],r[0]=s,r[1]=e.config,r[2]=o,r[3]=l,r[4]=t,r[5]=n):(t=r[4],n=r[5]),(0,i.useEffect)(t,n),null}function tL(e){var t;let n,i,r,l,s,c,u,h=(0,a.c)(37),{config:m}=e,{params:f}=(0,$.u)(),g=null;if("cloud/oauth/callback"===f.join("/")){let e;return h[0]!==m?(e=(0,_.jsx)(tT,{config:m}),h[0]=m,h[1]=e):e=h[1],e}h[2]===Symbol.for("react.memo_cache_sentinel")?(r=e=>e,h[2]=r):r=h[2];let p=r;if((0,$.ad)(m)||(0,$.r)(m)&&null!=(t=m.cloud)&&t.project){let e;h[3]!==m?(e=e=>(0,_.jsx)($.ag,{config:m,children:e}),h[3]=m,h[4]=e):e=h[4],p=e}if((0,$._)(m)||(0,$.ad)(m)){let e,t,a=p;if(h[5]!==m||h[6]!==a?(e=e=>(0,_.jsx)(tK,{config:m,children:(0,_.jsx)($.ah,{config:m,children:a(e)})}),h[5]=m,h[6]=a,h[7]=e):e=h[7],p=e,0===f.length){let e,t;return h[8]!==m?(e=(0,_.jsx)(tD,{config:m}),h[8]=m,h[9]=e):e=h[9],h[10]!==p||h[11]!==e?(t=p(e),h[10]=p,h[11]=e,h[12]=t):t=h[12],t}if(1===f.length&&(0,$._)(m)){if("setup"===f[0]){let e;return h[13]!==m?(e=(0,_.jsx)(tE,{config:m}),h[13]=m,h[14]=e):e=h[14],e}if("repo-not-found"===f[0]){let e;return h[15]!==m?(e=(0,_.jsx)(tF,{config:m}),h[15]=m,h[16]=e):e=h[16],e}if("created-github-app"===f[0]){let e;return h[17]!==m?(e=(0,_.jsx)(tI,{config:m}),h[17]=m,h[18]=e):e=h[18],e}}if("branch"!==f[0]||f.length<2){let e;return h[19]===Symbol.for("react.memo_cache_sentinel")?(e=(0,_.jsx)(d.EY,{children:"Not found"}),h[19]=e):e=h[19],e}g=f[1],i=`/keystatic/branch/${encodeURIComponent(g)}`,h[20]!==f?(t=tA(f.slice(2)),h[20]=f,h[21]=t):t=h[21],n=t}else{let e;h[22]!==f?(e=tA(f),h[22]=f,h[23]=e):e=h[23],n=e,i="/keystatic"}let b=g||"";return h[24]===Symbol.for("react.memo_cache_sentinel")?(l=(0,_.jsx)(C.P,{children:(0,_.jsx)(C.i,{children:(0,_.jsx)(em,{icon:o.u,title:"Not found",message:"This page could not be found."})})}),h[24]=l):l=h[24],h[25]!==n||h[26]!==m||h[27]!==i?(s=(0,_.jsx)(ey,{fallback:l,children:null===n?(0,_.jsx)(tO,{}):n.collection?"create"===n.kind?(0,_.jsx)(tl,{collection:n.collection,config:m,basePath:i},n.collection):"edit"===n.kind?(0,_.jsx)(ta,{collection:n.collection,basePath:i,config:m,itemSlug:n.slug},n.collection):(0,_.jsx)(e$,{basePath:i,collection:n.collection,config:m},n.collection):n.singleton?(0,_.jsx)(tP,{config:m,singleton:n.singleton},n.singleton):(0,_.jsx)(tj,{config:m,basePath:i})}),h[25]=n,h[26]=m,h[27]=i,h[28]=s):s=h[28],h[29]!==m||h[30]!==b||h[31]!==i||h[32]!==s?(c=(0,_.jsx)(tk,{config:m,currentBranch:b,basePath:i,children:s}),h[29]=m,h[30]=b,h[31]=i,h[32]=s,h[33]=c):c=h[33],h[34]!==p||h[35]!==c?(u=p(c),h[34]=p,h[35]=c,h[36]=u):u=h[36],u}function tO(){ep()}function tK(e){let t,n,o=(0,a.c)(13),[u,h]=(0,i.useState)("unknown"),m=(0,$.u)();if(o[0]!==e.config?(t=()=>{(0,$.m)(e.config).then(e=>{e?h("valid"):h("explicit-auth")})},n=[e.config],o[0]=e.config,o[1]=t,o[2]=n):(t=o[1],n=o[2]),(0,i.useEffect)(t,n),"valid"===u)return e.children;if("explicit-auth"===u){if("github"===e.config.storage.kind){let e,t,n,a=`/api/keystatic/github/login${m.params.length?`?${new URLSearchParams({from:m.params.map(encodeURIComponent).join("/")})}`:""}`;return o[3]===Symbol.for("react.memo_cache_sentinel")?(e=(0,_.jsx)(l.I,{src:s.F}),o[3]=e):e=o[3],o[4]===Symbol.for("react.memo_cache_sentinel")?(t=(0,_.jsx)(d.EY,{children:"Log in with GitHub"}),o[4]=t):t=o[4],o[5]!==a?(n=(0,_.jsx)(c.so,{justifyContent:"center",alignItems:"center",height:"100vh",children:(0,_.jsxs)(r.$n,{href:a,target:"_top",children:[e,t]})}),o[5]=a,o[6]=n):n=o[6],n}if("cloud"===e.config.storage.kind){let t,n,a;return o[7]!==m.params||o[8]!==e.config?(t=()=>{(0,$.D)(m.params.map(encodeURIComponent).join("/"),e.config)},o[7]=m.params,o[8]=e.config,o[9]=t):t=o[9],o[10]===Symbol.for("react.memo_cache_sentinel")?(n=(0,_.jsx)(d.EY,{children:"Log in with Keystatic Cloud"}),o[10]=n):n=o[10],o[11]!==t?(a=(0,_.jsx)(c.so,{justifyContent:"center",alignItems:"center",height:"100vh",children:(0,_.jsx)(r.$n,{onPress:t,children:n})}),o[11]=t,o[12]=a):a=o[12],a}}return null}function tz(e){let t,n,r=(0,a.c)(2);return(r[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{"localhost"===window.location.hostname&&(window.location.href=window.location.href.replace("localhost","127.0.0.1"))},n=[],r[0]=t,r[1]=n):(t=r[0],n=r[1]),(0,i.useEffect)(t,n),"localhost"===window.location.hostname)?null:e.children}function tB(e){let t,n,i,r=(0,a.c)(8);return"github"===e.config.storage.kind&&(0,$.ae)(e.config.storage.repo),r[0]!==e.config?(t=(0,_.jsx)(tL,{config:e.config}),r[0]=e.config,r[1]=t):t=r[1],r[2]!==e.config||r[3]!==t?(n=(0,_.jsx)($.af,{children:(0,_.jsx)(eY,{config:e.config,children:t})}),r[2]=e.config,r[3]=t,r[4]=n):n=r[4],r[5]!==e.appSlug||r[6]!==n?(i=(0,_.jsx)(tH,{children:(0,_.jsx)(tz,{children:(0,_.jsx)(eD,{value:e.appSlug,children:n})})}),r[5]=e.appSlug,r[6]=n,r[7]=i):i=r[7],i}function tH(e){let t,n,r=(0,a.c)(2),[l,o]=(0,i.useState)(!1);return(r[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{o(!0)},n=[],r[0]=t,r[1]=n):(t=r[0],n=r[1]),(0,i.useEffect)(t,n),l)?e.children:null}}}]);